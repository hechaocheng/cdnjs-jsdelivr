!function(e){"object"==typeof exports?module.exports=e():"function"==typeof define&&define.amd?define([],e):e()}(function(){return angular.module("ngMap",[]),function(){"use strict";function e(f,v,y,h,e,t,b,M,O){C=t;var w=this,L=e.startSymbol(),k=e.endSymbol();w.mapOptions,w.mapEvents,w.eventListeners,w.addObject=function(e,t){var n;w.map&&(w.map[e]=w.map[e]||{},n=Object.keys(w.map[e]).length,w.map[e][t.id||n]=t,w.map instanceof google.maps.Map&&("infoWindows"!=e&&t.setMap&&t.setMap&&t.setMap(w.map),t.centered&&t.position&&w.map.setCenter(t.position),"markers"==e&&w.objectChanged("markers"),"customMarkers"==e&&w.objectChanged("customMarkers")))},w.deleteObject=function(e,t){if(t.map){var n=t.map[e];for(var o in n)n[o]===t&&(google.maps.event.clearInstanceListeners(t),delete n[o]);t.map&&t.setMap&&t.setMap(null),"markers"==e&&w.objectChanged("markers"),"customMarkers"==e&&w.objectChanged("customMarkers")}},w.observeAttrSetObj=function(e,t,n){if(t.noWatcher)return!1;for(var o=C.getAttrsToObserve(e),r=0;r<o.length;r++){var a=o[r];t.$observe(a,b.observeAndSet(a,n))}},w.zoomToIncludeMarkers=function(){if(null!=w.map.markers&&0<Object.keys(w.map.markers).length||null!=w.map.customMarkers&&0<Object.keys(w.map.customMarkers).length){var e=new google.maps.LatLngBounds;for(var t in w.map.markers)e.extend(w.map.markers[t].getPosition());for(var n in w.map.customMarkers)e.extend(w.map.customMarkers[n].getPosition());w.mapOptions.maximumZoom&&(w.enableMaximumZoomCheck=!0),w.map.fitBounds(e)}},w.objectChanged=function(e){!w.map||"markers"!=e&&"customMarkers"!=e||"auto"!=w.map.zoomToIncludeMarkers||w.zoomToIncludeMarkers()},w.initializeMap=function(){var n=w.mapOptions,e=w.mapEvents,t=w.map;if(w.map=M.getMapInstance(v[0]),b.setStyle(v[0]),t){var o=C.filter(y),r=C.getOptions(o),a=C.getControlOptions(o),n=angular.extend(r,a);for(var i in t){var s=t[i];if("object"==typeof s)for(var p in s)w.addObject(i,s[p])}w.map.showInfoWindow=w.showInfoWindow,w.map.hideInfoWindow=w.hideInfoWindow}n.zoom=n.zoom||15;var c,u=n.center,l=new RegExp(O(L)+".*"+O(k));for(var g in!n.center||"string"==typeof u&&u.match(l)?n.center=new google.maps.LatLng(0,0):"string"==typeof u&&u.match(/[0-9.-]*,[0-9.-]*/)?n.center=new google.maps.LatLng(u):u instanceof google.maps.LatLng||(c=n.center,delete n.center,b.getGeoLocation(c,n.geoLocationOptions).then(function(e){w.map.setCenter(e);var t=n.geoCallback;t&&h(t)(f)},function(){n.geoFallbackCenter&&w.map.setCenter(n.geoFallbackCenter)})),w.map.setOptions(n),e){var d=e[g],m=google.maps.event.addListener(w.map,g,d);w.eventListeners[g]=m}w.observeAttrSetObj($,y,w.map),w.singleInfoWindow=n.singleInfoWindow,google.maps.event.trigger(w.map,"resize"),google.maps.event.addListenerOnce(w.map,"idle",function(){b.addMap(w),n.zoomToIncludeMarkers&&w.zoomToIncludeMarkers(),f.map=w.map,f.$emit("mapInitialized",w.map),y.mapInitialized&&h(y.mapInitialized)(f,{map:w.map})}),n.zoomToIncludeMarkers&&n.maximumZoom&&google.maps.event.addListener(w.map,"zoom_changed",function(){1==w.enableMaximumZoomCheck&&(w.enableMaximumZoomCheck=!1,google.maps.event.addListenerOnce(w.map,"bounds_changed",function(){w.map.setZoom(Math.min(n.maximumZoom,w.map.getZoom()))}))})},f.google=google;var n,o,$=C.orgAttributes(v),r=C.filter(y),a=C.getOptions(r,{scope:f}),i=C.getControlOptions(r),s=angular.extend(a,i),p=C.getEvents(f,r);Object.keys(p).length,w.mapOptions=s,w.mapEvents=p,w.eventListeners={},a.lazyInit?(o=y.id&&0===y.id.indexOf(L,0)&&-1!==y.id.indexOf(k,y.id.length-k.length)?(n=y.id.slice(2,-2),h(n)(f)):y.id,w.map={id:o},b.addMap(w)):w.initializeMap(),a.triggerResize&&google.maps.event.trigger(w.map,"resize"),v.bind("$destroy",function(){M.returnMapInstance(w.map),b.deleteMap(w)})}var C;e.$inject=["$scope","$element","$attrs","$parse","$interpolate","Attr2MapOptions","NgMap","NgMapPool","escapeRegexpFilter"],angular.module("ngMap").controller("__MapController",e)}(),function(){"use strict";function t(e,t,n,o){o=o[0]||o[1];var r=c.orgAttributes(t),a=c.filter(n),i=c.getOptions(a,{scope:e}),s=c.getEvents(e,a),p=u(i,s);o.addObject("bicyclingLayers",p),o.observeAttrSetObj(r,n,p),t.bind("$destroy",function(){o.deleteObject("bicyclingLayers",p)})}function e(e){return c=e,{restrict:"E",require:["?^map","?^ngMap"],link:t}}var c,u=function(e,t){var n=new google.maps.BicyclingLayer(e);for(var o in t)google.maps.event.addListener(n,o,t[o]);return n};e.$inject=["Attr2MapOptions"],angular.module("ngMap").directive("bicyclingLayer",e)}(),function(){"use strict";function o(e,t,n,o){o=o[0]||o[1];var r=u.filter(n),a=u.getOptions(r,{scope:e}),i=u.getEvents(e,r),s=t[0].parentElement.removeChild(t[0]);for(var p in l(s.innerHTML.trim())(e),i)google.maps.event.addDomListener(s,p,i[p]);o.addObject("customControls",s);var c=a.position;o.map.controls[google.maps.ControlPosition[c]].push(s),t.bind("$destroy",function(){o.deleteObject("customControls",s)})}function e(e,t,n){return u=e,l=t,{restrict:"E",require:["?^map","?^ngMap"],link:o}}var u,l;e.$inject=["Attr2MapOptions","$compile","NgMap"],angular.module("ngMap").directive("customControl",e)}(),function(){"use strict";function g(e){for(var t in e=e||{},this.el=document.createElement("div"),this.el.style.display="inline-block",this.el.style.visibility="hidden",this.visible=!0,e)this[t]=e[t]}function e(e,t,n,o,r,a){d=o,m=e,c=t,f=r;var i=n.startSymbol(),s=n.endSymbol(),p=new RegExp(a(i)+"([^"+s.substring(0,1)+"]+)"+a(s),"g");return{restrict:"E",require:["?^map","?^ngMap"],compile:function(e){(g.prototype=new google.maps.OverlayView).setContent=function(e,t){this.el.innerHTML=e,this.el.style.position="absolute",t&&c(angular.element(this.el).contents())(t)},g.prototype.getDraggable=function(){return this.draggable},g.prototype.setDraggable=function(e){this.draggable=e},g.prototype.getPosition=function(){return this.position},g.prototype.setPosition=function(e){e&&(this.position=e);var t,o=this;this.getProjection()&&"function"==typeof this.position.lng&&(t=function(){var e,t,n;o.getProjection()&&(e=o.getProjection().fromLatLngToDivPixel(o.position),t=Math.round(e.x-o.el.offsetWidth/2),n=Math.round(e.y-o.el.offsetHeight-10),o.el.style.left=t+"px",o.el.style.top=n+"px",o.el.style.visibility="visible")},o.el.offsetWidth&&o.el.offsetHeight?t():m(t,300))},g.prototype.setZIndex=function(e){e&&(this.zIndex=e),this.el.style.zIndex=this.zIndex},g.prototype.getVisible=function(){return this.visible},g.prototype.setVisible=function(e){this.el.style.display=e?"inline-block":"none",this.visible=e},g.prototype.addClass=function(e){var t=this.el.className.trim().split(" ");-1==t.indexOf(e)&&t.push(e),this.el.className=t.join(" ")},g.prototype.removeClass=function(e){var t=this.el.className.split(" "),n=t.indexOf(e);-1<n&&t.splice(n,1),this.el.className=t.join(" ")},g.prototype.onAdd=function(){this.getPanes().overlayMouseTarget.appendChild(this.el)},g.prototype.draw=function(){this.setPosition(),this.setZIndex(this.zIndex),this.setVisible(this.visible)},g.prototype.onRemove=function(){this.el.parentNode.removeChild(this.el)},e[0].style.display="none";var u,l,t=e.html(),n=t.match(p),o=[];return(n||[]).forEach(function(e){var t=e.replace(i,"").replace(s,"");-1==e.indexOf("::")&&-1==e.indexOf("this.")&&-1==o.indexOf(t)&&o.push(e.replace(i,"").replace(s,""))}),u=t,l=o,function(t,n,e,o){o=o[0]||o[1];var r=d.orgAttributes(n),a=d.filter(e),i=d.getOptions(a,{scope:t}),s=d.getEvents(t,a);n[0].style.display="none";var p=new g(i);for(var c in m(function(){t.$watch("["+l.join(",")+"]",function(){p.setContent(u,t)},!0),p.setContent(n[0].innerHTML,t);var e=n[0].firstElementChild.className;p.addClass("custom-marker"),p.addClass(e),i.position instanceof google.maps.LatLng||f.getGeoLocation(i.position).then(function(e){p.setPosition(e)})}),s)google.maps.event.addDomListener(p.el,c,s[c]);o.addObject("customMarkers",p),o.observeAttrSetObj(r,e,p),n.bind("$destroy",function(){o.deleteObject("customMarkers",p)})}}}}var d,m,c,f;e.$inject=["$timeout","$compile","$interpolate","Attr2MapOptions","NgMap","escapeRegexpFilter"],angular.module("ngMap").directive("customMarker",e)}(),function(){"use strict";function l(n,e){var t=new google.maps.DirectionsService,o=e;o.travelMode=o.travelMode||"DRIVING";var r=["origin","destination","travelMode","transitOptions","unitSystem","durationInTraffic","waypoints","optimizeWaypoints","provideRouteAlternatives","avoidHighways","avoidTolls","region"];for(var a in o)-1===r.indexOf(a)&&delete o[a];function i(e){t.route(e,function(e,t){t==google.maps.DirectionsStatus.OK&&d(function(){n.setDirections(e)})})}o.waypoints&&("[]"!=o.waypoints&&""!==o.waypoints||delete o.waypoints),o.origin&&o.destination&&("current-location"==o.origin?s.getCurrentPosition().then(function(e){o.origin=new google.maps.LatLng(e.coords.latitude,e.coords.longitude),i(o)}):"current-location"==o.destination?s.getCurrentPosition().then(function(e){o.destination=new google.maps.LatLng(e.coords.latitude,e.coords.longitude),i(o)}):i(o))}function e(e,t,n,o){var u=e;return g=o,d=t,s=n,{restrict:"E",require:["?^map","?^ngMap"],link:function(e,t,o,n){n=n[0]||n[1];var r=u.orgAttributes(t),a=u.filter(o),i=u.getOptions(a,{scope:e}),s=u.getEvents(e,a),p=u.getAttrsToObserve(r),c=function(e,t){e.panel&&(e.panel=document.getElementById(e.panel)||document.querySelector(e.panel));var n=new google.maps.DirectionsRenderer(e);for(var o in t)google.maps.event.addListener(n,o,t[o]);return n}(i,s);n.addObject("directionsRenderers",c),p.forEach(function(e){var n;n=e,o.$observe(n,function(t){var e;"panel"==n?d(function(){var e=document.getElementById(t)||document.querySelector(t);e&&c.setPanel(e)}):i[n]!==t&&(e=u.toOptionValue(t,{key:n}),i[n]=e,l(c,i))})}),g.getMap().then(function(){l(c,i)}),t.bind("$destroy",function(){n.deleteObject("directionsRenderers",c)})}}}var g,d,s;e.$inject=["Attr2MapOptions","$timeout","NavigatorGeolocation","NgMap"],angular.module("ngMap").directive("directions",e)}(),function(){"use strict";angular.module("ngMap").directive("drawingManager",["Attr2MapOptions",function(e){var u=e;return{restrict:"E",require:["?^map","?^ngMap"],link:function(e,t,n,o){o=o[0]||o[1];var r=u.filter(n),a=u.getOptions(r,{scope:e}),i=u.getControlOptions(r),s=u.getEvents(e,r),p=new google.maps.drawing.DrawingManager({drawingMode:a.drawingmode,drawingControl:a.drawingcontrol,drawingControlOptions:i.drawingControlOptions,circleOptions:a.circleoptions,markerOptions:a.markeroptions,polygonOptions:a.polygonoptions,polylineOptions:a.polylineoptions,rectangleOptions:a.rectangleoptions});for(var c in n.$observe("drawingControlOptions",function(e){p.drawingControlOptions=u.getControlOptions({drawingControlOptions:e}).drawingControlOptions,p.setDrawingMode(null),p.setMap(o.map)}),s)google.maps.event.addListener(p,c,s[c]);o.addObject("mapDrawingManager",p),t.bind("$destroy",function(){o.deleteObject("mapDrawingManager",p)})}}}])}(),function(){"use strict";angular.module("ngMap").directive("dynamicMapsEngineLayer",["Attr2MapOptions",function(e){var p=e;return{restrict:"E",require:["?^map","?^ngMap"],link:function(e,t,n,o){o=o[0]||o[1];var r=p.filter(n),a=p.getOptions(r,{scope:e}),i=p.getEvents(e,r,i),s=function(e,t){var n=new google.maps.visualization.DynamicMapsEngineLayer(e);for(var o in t)google.maps.event.addListener(n,o,t[o]);return n}(a,i);o.addObject("mapsEngineLayers",s)}}}])}(),function(){"use strict";angular.module("ngMap").directive("fusionTablesLayer",["Attr2MapOptions",function(e){var p=e;return{restrict:"E",require:["?^map","?^ngMap"],link:function(e,t,n,o){o=o[0]||o[1];var r=p.filter(n),a=p.getOptions(r,{scope:e}),i=p.getEvents(e,r,i),s=function(e,t){var n=new google.maps.FusionTablesLayer(e);for(var o in t)google.maps.event.addListener(n,o,t[o]);return n}(a,i);o.addObject("fusionTablesLayers",s),t.bind("$destroy",function(){o.deleteObject("fusionTablesLayers",s)})}}}])}(),function(){"use strict";angular.module("ngMap").directive("heatmapLayer",["Attr2MapOptions","$window",function(e,s){var p=e;return{restrict:"E",require:["?^map","?^ngMap"],link:function(e,t,n,o){o=o[0]||o[1];var r=p.filter(n),a=p.getOptions(r,{scope:e});if(a.data=s[n.data]||e[n.data],!(a.data instanceof Array))throw"invalid heatmap data";a.data=new google.maps.MVCArray(a.data);var i=new google.maps.visualization.HeatmapLayer(a);p.getEvents(e,r);o.addObject("heatmapLayers",i)}}}])}(),function(){"use strict";function e(e,u,l,g,d,m,f){var v=e;return{restrict:"E",require:["?^map","?^ngMap"],link:function(s,e,n,p){p=p[0]||p[1],e.css("display","none");var t,o=v.orgAttributes(e),r=v.filter(n),a=v.getOptions(r,{scope:s}),i=function(e,t,n){var r;for(var o in!e.position||e.position instanceof google.maps.LatLng||delete e.position,r=new google.maps.InfoWindow(e),t)o&&google.maps.event.addListener(r,o,t[o]);var a=l(function(t){angular.isString(n)?g(n).then(function(e){t(angular.element(e).wrap("<div>").parent())},function(e){throw"info-window template request failed: "+e}):t(n)}).then(function(e){var t=e.html().trim();if(1!=angular.element(t).length)throw"info-window working as a template must have a container";r.__template=t.replace(/\s?ng-non-bindable[='"]+/,"")});return r.__open=function(t,n,o){a.then(function(){d(function(){o&&(n.anchor=o);var e=u(r.__template)(n);r.setContent(e[0]),n.$apply(),o&&o.getPosition?r.open(t,o):o&&o instanceof google.maps.LatLng?(r.open(t),r.setPosition(o)):r.open(t),r.content.parentElement.parentElement.parentElement.className="ng-map-info-window"})})},r}(a,v.getEvents(s,r),a.template||e);!a.position||a.position instanceof google.maps.LatLng||(t=a.position),t&&f.getGeoLocation(t).then(function(e){i.setPosition(e),i.__open(p.map,s,e);var t=n.geoCallback;t&&m(t)(s)}),p.addObject("infoWindows",i),p.observeAttrSetObj(o,n,i),p.showInfoWindow=p.map.showInfoWindow=p.showInfoWindow||function(e,t,n){var o="string"==typeof e?e:t,r="string"==typeof e?t:n;if("string"==typeof r)if(void 0!==p.map.markers&&void 0!==p.map.markers[r])r=p.map.markers[r];else{if(p.map.customMarkers,void 0===p.map.customMarkers[r])throw new Error("Cant open info window for id "+r+". Marker or CustomMarker is not defined");r=p.map.customMarkers[r]}var a=p.map.infoWindows[o],i=r||(this.getPosition?this:null);a.__open(p.map,s,i),p.singleInfoWindow&&(p.lastInfoWindow&&s.hideInfoWindow(p.lastInfoWindow),p.lastInfoWindow=o)},p.hideInfoWindow=p.map.hideInfoWindow=p.hideInfoWindow||function(e,t){var n="string"==typeof e?e:t;p.map.infoWindows[n].close()},s.showInfoWindow=p.map.showInfoWindow,s.hideInfoWindow=p.map.hideInfoWindow;var c=i.mapId?{id:i.mapId}:0;f.getMap(c).then(function(e){var t;i.visible&&i.__open(e,s),i.visibleOnMarker&&(t=i.visibleOnMarker,i.__open(e,s,e.markers[t]))})}}}e.$inject=["Attr2MapOptions","$compile","$q","$templateRequest","$timeout","$parse","NgMap"],angular.module("ngMap").directive("infoWindow",e)}(),function(){"use strict";angular.module("ngMap").directive("kmlLayer",["Attr2MapOptions",function(e){var s=e;return{restrict:"E",require:["?^map","?^ngMap"],link:function(e,t,n,o){o=o[0]||o[1];var r=s.orgAttributes(t),a=s.filter(n),i=function(e,t){var n=new google.maps.KmlLayer(e);for(var o in t)google.maps.event.addListener(n,o,t[o]);return n}(s.getOptions(a,{scope:e}),s.getEvents(e,a));o.addObject("kmlLayers",i),o.observeAttrSetObj(r,n,i),t.bind("$destroy",function(){o.deleteObject("kmlLayers",i)})}}}])}(),function(){"use strict";angular.module("ngMap").directive("mapData",["Attr2MapOptions","NgMap",function(e,o){var s=e;return{restrict:"E",require:["?^map","?^ngMap"],link:function(r,e,t){var n=s.filter(t),a=s.getOptions(n,{scope:r}),i=s.getEvents(r,n,i);o.getMap().then(function(e){for(var t in a){var n=a[t];"function"==typeof r[n]?e.data[t](r[n]):e.data[t](n)}for(var o in i)e.data.addListener(o,i[o])})}}}])}(),function(){"use strict";function n(e,t,n){var o,r=n.mapLazyLoadParams||n.mapLazyLoad;void 0===window.google||void 0===window.google.maps?(p.push({scope:e,element:t,savedHtml:s[p.length]}),window.lazyLoadCallback=function(){a(function(){p.forEach(function(e){e.element.html(e.savedHtml),i(e.element.contents())(e.scope)})},100)},(o=document.createElement("script")).src=r+(-1<r.indexOf("?")?"&":"?")+"callback=lazyLoadCallback",document.querySelector('script[src="'+o.src+'"]')||document.body.appendChild(o)):(t.html(s),i(t.contents())(e))}function o(e,t){return t.mapLazyLoad,s.push(e.html()),t.mapLazyLoad,(void 0===window.google||void 0===window.google.maps)&&(e.html(""),{pre:n})}function e(e,t){return i=e,a=t,{compile:o}}var a,i,s=[],p=[];e.$inject=["$compile","$timeout"],angular.module("ngMap").directive("mapLazyLoad",e)}(),function(){"use strict";angular.module("ngMap").directive("mapType",["$parse","NgMap",function(i,s){return{restrict:"E",require:["?^map","?^ngMap"],link:function(e,t,n,o){o=o[0]||o[1];var r,a=n.name;if(!a)throw"invalid map-type name";if(!(r=i(n.object)(e)))throw"invalid map-type object";s.getMap().then(function(e){e.mapTypes.set(a,r)}),o.addObject("mapTypes",r)}}}])}(),function(){"use strict";function e(){return{restrict:"AE",controller:"__MapController",controllerAs:"ngmap"}}angular.module("ngMap").directive("map",[e]),angular.module("ngMap").directive("ngMap",[e])}(),function(){"use strict";angular.module("ngMap").directive("mapsEngineLayer",["Attr2MapOptions",function(e){var p=e;return{restrict:"E",require:["?^map","?^ngMap"],link:function(e,t,n,o){o=o[0]||o[1];var r=p.filter(n),a=p.getOptions(r,{scope:e}),i=p.getEvents(e,r,i),s=function(e,t){var n=new google.maps.visualization.MapsEngineLayer(e);for(var o in t)google.maps.event.addListener(n,o,t[o]);return n}(a,i);o.addObject("mapsEngineLayers",s)}}}])}(),function(){"use strict";function o(n,e,o,t){t=t[0]||t[1];var r,a=u.orgAttributes(e),i=u.filter(o),s=u.getOptions(i,n,{scope:n}),p=u.getEvents(n,i);s.position instanceof google.maps.LatLng||(r=s.position);var c=function(e,t){var n;if(g.defaultOptions.marker)for(var o in g.defaultOptions.marker)void 0===e[o]&&(e[o]=g.defaultOptions.marker[o]);for(var r in e.position instanceof google.maps.LatLng||(e.position=new google.maps.LatLng(0,0)),n=new google.maps.Marker(e),Object.keys(t).length,t)r&&google.maps.event.addListener(n,r,t[r]);return n}(s,p);t.addObject("markers",c),r&&g.getGeoLocation(r).then(function(e){c.setPosition(e),s.centered&&c.map.setCenter(e);var t=o.geoCallback;t&&l(t)(n)}),t.observeAttrSetObj(a,o,c),e.bind("$destroy",function(){t.deleteObject("markers",c)})}function e(e,t,n){return u=e,l=t,g=n,{restrict:"E",require:["^?map","?^ngMap"],link:o}}var u,l,g;e.$inject=["Attr2MapOptions","$parse","NgMap"],angular.module("ngMap").directive("marker",e)}(),function(){"use strict";angular.module("ngMap").directive("overlayMapType",["NgMap",function(i){return{restrict:"E",require:["?^map","?^ngMap"],link:function(e,t,n,o){o=o[0]||o[1];var r=n.initMethod||"insertAt",a=e[n.object];i.getMap().then(function(e){var t;"insertAt"==r?(t=parseInt(n.index,10),e.overlayMapTypes.insertAt(t,a)):"push"==r&&e.overlayMapTypes.push(a)}),o.addObject("overlayMapTypes",a)}}}])}(),function(){"use strict";function e(e,u){var l=e;return{restrict:"A",require:"?ngModel",link:function(t,e,n,o){if("false"===n.placesAutoComplete)return!1;var r=l.filter(n),a=l.getOptions(r,{scope:t}),i=l.getEvents(t,r),s=new google.maps.places.Autocomplete(e[0],a);for(var p in i)google.maps.event.addListener(s,p,i[p]);function c(){u(function(){o&&o.$setViewValue(e.val())},100)}google.maps.event.addListener(s,"place_changed",c),e[0].addEventListener("change",c),n.$observe("types",function(e){var t;e&&(t=l.toOptionValue(e,{key:"types"}),s.setTypes(t))}),n.$observe("componentRestrictions",function(e){e&&s.setComponentRestrictions(t.$eval(e))})}}}e.$inject=["Attr2MapOptions","$timeout"],angular.module("ngMap").directive("placesAutoComplete",e)}(),function(){"use strict";function e(e,l,g){var d=e;return{restrict:"E",require:["?^map","?^ngMap"],link:function(n,e,o,t){t=t[0]||t[1];var r,a=d.orgAttributes(e),i=d.filter(o),s=d.getOptions(i,{scope:n}),p=d.getEvents(n,i),c=s.name;s.center instanceof google.maps.LatLng||(r=s.center);var u=function(e,t){var n=e.name;switch(delete e.name,n){case"circle":e.center instanceof google.maps.LatLng||(e.center=new google.maps.LatLng(0,0)),a=new google.maps.Circle(e);break;case"polygon":a=new google.maps.Polygon(e);break;case"polyline":a=new google.maps.Polyline(e);break;case"rectangle":a=new google.maps.Rectangle(e);break;case"groundOverlay":case"image":var o=e.url,r={opacity:e.opacity,clickable:e.clickable,id:e.id},a=new google.maps.GroundOverlay(o,e.bounds,r)}for(var i in t)t[i]&&google.maps.event.addListener(a,i,t[i]);return a}(s,p);t.addObject("shapes",u),r&&"circle"==c&&g.getGeoLocation(r).then(function(e){u.setCenter(e),u.centered&&u.map.setCenter(e);var t=o.geoCallback;t&&l(t)(n)}),t.observeAttrSetObj(a,o,u),e.bind("$destroy",function(){t.deleteObject("shapes",u)})}}}e.$inject=["Attr2MapOptions","$parse","NgMap"],angular.module("ngMap").directive("shape",e)}(),function(){"use strict";function e(e,p){var c=e;return{restrict:"E",require:["?^map","?^ngMap"],link:function(e,t,n){var o=c.filter(n),r=c.getOptions(o,{scope:e}),a=c.getControlOptions(o),i=angular.extend(r,a),s=c.getEvents(e,o);p.getMap().then(function(e){var t=function(e,t,n){var o,r;for(var a in t.container&&(r=(r=document.getElementById(t.container))||document.querySelector(t.container)),r?o=new google.maps.StreetViewPanorama(r,t):(o=e.getStreetView()).setOptions(t),n)a&&google.maps.event.addListener(o,a,n[a]);return o}(e,i,s);e.setStreetView(t),t.getPosition()||t.setPosition(e.getCenter()),google.maps.event.addListener(t,"position_changed",function(){t.getPosition()!==e.getCenter()&&e.setCenter(t.getPosition())});var n=google.maps.event.addListener(e,"center_changed",function(){t.setPosition(e.getCenter()),google.maps.event.removeListener(n)})})}}}e.$inject=["Attr2MapOptions","NgMap"],angular.module("ngMap").directive("streetViewPanorama",e)}(),function(){"use strict";angular.module("ngMap").directive("trafficLayer",["Attr2MapOptions",function(e){var s=e;return{restrict:"E",require:["?^map","?^ngMap"],link:function(e,t,n,o){o=o[0]||o[1];var r=s.orgAttributes(t),a=s.filter(n),i=function(e,t){var n=new google.maps.TrafficLayer(e);for(var o in t)google.maps.event.addListener(n,o,t[o]);return n}(s.getOptions(a,{scope:e}),s.getEvents(e,a));o.addObject("trafficLayers",i),o.observeAttrSetObj(r,n,i),t.bind("$destroy",function(){o.deleteObject("trafficLayers",i)})}}}])}(),function(){"use strict";angular.module("ngMap").directive("transitLayer",["Attr2MapOptions",function(e){var s=e;return{restrict:"E",require:["?^map","?^ngMap"],link:function(e,t,n,o){o=o[0]||o[1];var r=s.orgAttributes(t),a=s.filter(n),i=function(e,t){var n=new google.maps.TransitLayer(e);for(var o in t)google.maps.event.addListener(n,o,t[o]);return n}(s.getOptions(a,{scope:e}),s.getEvents(e,a));o.addObject("transitLayers",i),o.observeAttrSetObj(r,n,i),t.bind("$destroy",function(){o.deleteObject("transitLayers",i)})}}}])}(),function(){"use strict";var t=/([\:\-\_]+(.))/g,n=/^moz([A-Z])/;angular.module("ngMap").filter("camelCase",function(){return function(e){return e.replace(t,function(e,t,n,o){return o?n.toUpperCase():n}).replace(n,"Moz$1")}})}(),function(){"use strict";angular.module("ngMap").filter("escapeRegexp",function(){return function(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}})}(),function(){"use strict";angular.module("ngMap").filter("jsonize",function(){return function(t){try{return JSON.parse(t),t}catch(e){return t.replace(/([\$\w]+)\s*:/g,function(e,t){return'"'+t+'":'}).replace(/'([^']+)'/g,function(e,t){return'"'+t+'"'})}}})}(),function(){"use strict";var isoDateRE=/^(\d{4}\-\d\d\-\d\d([tT][\d:\.]*)?)([zZ]|([+\-])(\d\d):?(\d\d))?$/,Attr2MapOptions=function($parse,$timeout,$log,$interpolate,NavigatorGeolocation,GeoCoder,camelCaseFilter,jsonizeFilter,escapeRegExp){var exprStartSymbol=$interpolate.startSymbol(),exprEndSymbol=$interpolate.endSymbol(),orgAttributes=function(e){0<e.length&&(e=e[0]);for(var t={},n=0;n<e.attributes.length;n++){var o=e.attributes[n];t[o.name]=o.value}return t},getJSON=function(e){return e.match(/^[\+\-]?[0-9\.]+,[ ]*\ ?[\+\-]?[0-9\.]+$/)&&(e="["+e+"]"),JSON.parse(jsonizeFilter(e))},getLatLng=function(e){var t=e;if(e[0].constructor==Array)if(e[0][0].constructor==Array&&2==e[0][0].length||e[0][0].constructor==Object){for(var n,o=[],r=0;r<e.length;r++)n=e[r].map(function(e){return new google.maps.LatLng(e[0],e[1])}),o.push(n);t=o}else t=e.map(function(e){return new google.maps.LatLng(e[0],e[1])});else!isNaN(parseFloat(e[0]))&&isFinite(e[0])&&(t=new google.maps.LatLng(t[0],t[1]));return t},toOptionValue=function(input,options){var output;try{output=getNumber(input)}catch(err){try{var output=getJSON(input),newOptions;output instanceof Array?output=output[0].constructor==Object||output[0]instanceof Array&&output[0][0].constructor==Object?output:getLatLng(output):output===Object(output)&&(newOptions=options,newOptions.doNotConverStringToNumber=!0,output=getOptions(output,newOptions))}catch(err2){if(input.match(/^[A-Z][a-zA-Z0-9]+\(.*\)$/))try{var exp="new google.maps."+input;output=eval(exp)}catch(e){output=input}else if(input.match(/^([A-Z][a-zA-Z0-9]+)\.([A-Z]+)$/))try{var matches=input.match(/^([A-Z][a-zA-Z0-9]+)\.([A-Z]+)$/);output=google.maps[matches[1]][matches[2]]}catch(e){output=input}else if(input.match(/^[A-Z]+$/))try{var capitalizedKey=options.key.charAt(0).toUpperCase()+options.key.slice(1);output=options.key.match(/temperatureUnit|windSpeedUnit|labelColor/)?(capitalizedKey=capitalizedKey.replace(/s$/,""),google.maps.weather[capitalizedKey][input]):google.maps[capitalizedKey][input]}catch(e){output=input}else if(input.match(isoDateRE))try{output=new Date(input)}catch(e){output=input}else if(input.match(new RegExp("^"+escapeRegExp(exprStartSymbol)))&&options.scope)try{var expr=input.replace(new RegExp(escapeRegExp(exprStartSymbol)),"").replace(new RegExp(escapeRegExp(exprEndSymbol),"g"),"");output=options.scope.$eval(expr)}catch(e){output=input}else output=input}}if(("center"==options.key||"position"==options.key)&&output instanceof Array&&(output=new google.maps.LatLng(output[0],output[1])),"bounds"==options.key&&output instanceof Array&&(output=new google.maps.LatLngBounds(output[0],output[1])),"icons"==options.key&&output instanceof Array)for(var i=0;i<output.length;i++){var el=output[i];el.icon.path.match(/^[A-Z_]+$/)&&(el.icon.path=google.maps.SymbolPath[el.icon.path])}if("icon"==options.key&&output instanceof Object)for(var key in(""+output.path).match(/^[A-Z_]+$/)&&(output.path=google.maps.SymbolPath[output.path]),output){var arr=output[key];"anchor"==key||"origin"==key||"labelOrigin"==key?output[key]=new google.maps.Point(arr[0],arr[1]):"size"!=key&&"scaledSize"!=key||(output[key]=new google.maps.Size(arr[0],arr[1]))}return output},getAttrsToObserve=function(e){var t=[],n=new RegExp(escapeRegExp(exprStartSymbol)+".*"+escapeRegExp(exprEndSymbol),"g");if(!e.noWatcher)for(var o in e){var r=e[o];r&&r.match(n)&&t.push(camelCaseFilter(o))}return t},filter=function(e){var t={};for(var n in e)n.match(/^\$/)||n.match(/^ng[A-Z]/)||(t[n]=e[n]);return t},getOptions=function(e,t){t=t||{};var n={};for(var o in e)if(e[o]||0===e[o]){if(o.match(/^on[A-Z]/))continue;if(o.match(/ControlOptions$/))continue;"string"!=typeof e[o]||t.doNotConverStringToNumber&&e[o].match(/^[0-9]+$/)?n[o]=e[o]:n[o]=toOptionValue(e[o],{key:o,scope:t.scope})}return n},getEvents=function(a,e){function t(e){return"_"+e.toLowerCase()}function n(e){var t=e.match(/([^\(]+)\(([^\)]*)\)/),o=t[1],n=t[2].replace(/event[ ,]*/,""),r=$parse("["+n+"]");return function(e){var t=r(a);var n=o.split(".").reduce(function(e,t){return e[t]},a);n&&n.apply(this,[e].concat(t)),$timeout(function(){a.$apply()})}}var o={};for(var r in e)if(e[r]){if(!r.match(/^on[A-Z]/))continue;var i=r.replace(/^on/,"");i=(i=i.charAt(0).toLowerCase()+i.slice(1)).replace(/([A-Z])/g,t);var s=e[r];o[i]=new n(s)}return o},getControlOptions=function(e){var t={};if("object"!=typeof e)return!1;for(var n in e)if(e[n]){if(!n.match(/(.*)ControlOptions$/))continue;var o=(o=e[n].replace(/'/g,'"')).replace(/([^"]+)|("[^"]+")/g,function(e,t,n){return t?t.replace(/([a-zA-Z0-9]+?):/g,'"$1":'):n});try{var r,a,i=JSON.parse(o);for(var s in i){i[s]&&("string"==typeof(r=i[s])?r=r.toUpperCase():"mapTypeIds"===s&&(r=r.map(function(e){return e.match(/^[A-Z]+$/)?google.maps.MapTypeId[e.toUpperCase()]:e})),"style"===s?(a=(n.charAt(0).toUpperCase()+n.slice(1)).replace(/Options$/,"")+"Style",i[s]=google.maps[a][r]):i[s]="position"===s?google.maps.ControlPosition[r]:r)}t[n]=i}catch(e){}}return t};return{filter:filter,getOptions:getOptions,getEvents:getEvents,getControlOptions:getControlOptions,toOptionValue:toOptionValue,getAttrsToObserve:getAttrsToObserve,orgAttributes:orgAttributes}};Attr2MapOptions.$inject=["$parse","$timeout","$log","$interpolate","NavigatorGeolocation","GeoCoder","camelCaseFilter","jsonizeFilter","escapeRegexpFilter"],angular.module("ngMap").service("Attr2MapOptions",Attr2MapOptions)}(),function(){"use strict";function t(e){var n=o.defer();return(new google.maps.Geocoder).geocode(e,function(e,t){t==google.maps.GeocoderStatus.OK?n.resolve(e):n.reject(t)}),n.promise}function e(e){return o=e,{geocode:t}}var o;e.$inject=["$q"],angular.module("ngMap").service("GeoCoder",e)}(),function(){"use strict";function t(e){var t=n.defer();return navigator.geolocation?(void 0===e?e={timeout:5e3}:void 0===e.timeout&&(e.timeout=5e3),navigator.geolocation.getCurrentPosition(function(e){t.resolve(e)},function(e){t.reject(e)},e)):t.reject("Browser Geolocation service failed."),t.promise}function e(e){return n=e,{getCurrentPosition:t}}var n;e.$inject=["$q"],angular.module("ngMap").service("NavigatorGeolocation",e)}(),function(){"use strict";function o(e){var t=function(e,t){for(var n,o=0;o<u.length;o++){var r=u[o];if(r.id==t&&!r.inUse){var a=r.getDiv();e.appendChild(a),n=r;break}}return n}(e,e.id)||function(e){for(var t,n=0;n<u.length;n++){var o=u[n];if(!o.id&&!o.inUse){var r=o.getDiv();e.appendChild(r),t=o;break}}return t}(e);return t?c(function(){google.maps.event.trigger(t,"idle")},100):t=function(e){var t=p.createElement("div");t.style.width="100%",t.style.height="100%",e.appendChild(t);var n=new s.google.maps.Map(t,{});return u.push(n),n}(e),t.inUse=!0,t}function r(e){e.inUse=!1}function a(){for(var e=0;e<u.length;e++)u[e]=null;u=[]}function i(e){for(var t=0;t<u.length;t++)null!==u[t]&&u[t].id==e&&(u[t]=null,u.splice(t,1))}function e(e,t,n){return p=e[0],s=t,c=n,{mapInstances:u,resetMapInstances:a,getMapInstance:o,returnMapInstance:r,deleteMapInstance:i}}var s,p,c,u=[];e.$inject=["$document","$window","$timeout"],angular.module("ngMap").factory("NgMapPool",e)}(),function(){"use strict";function t(e,t){var n;return e.currentStyle?n=e.currentStyle[t]:v.getComputedStyle&&(n=y.defaultView.getComputedStyle(e,null).getPropertyValue(t)),n}function c(e){var t=a[e||0];if(!(t.map instanceof google.maps.Map))return t.initializeMap(),t.map}function u(n){n=(n="object"==typeof n?n.id:n)||0;var o=h.defer(),r=2e3;return function e(t){a[n]?o.resolve(a[n].map):r<t?o.reject("could not find map"):v.setTimeout(function(){e(t+100)},100)}(0),o.promise}function l(e){var t;e.map&&(t=Object.keys(a).length,a[e.map.id||t]=e)}function g(t){var e=Object.keys(a).length-1,n=t.map.id||e;if(t.map){for(var o in t.eventListeners){var r=t.eventListeners[o];google.maps.event.removeListener(r)}t.map.controls&&t.map.controls.forEach(function(e){e.clear()})}t.map.heatmapLayers&&Object.keys(t.map.heatmapLayers).forEach(function(e){t.deleteObject("heatmapLayers",t.map.heatmapLayers[e])}),L.deleteMapInstance(n),delete a[n]}function d(e,t){var r=h.defer();return!e||e.match(/^current/i)?b.getCurrentPosition(t).then(function(e){var t=e.coords.latitude,n=e.coords.longitude,o=new google.maps.LatLng(t,n);r.resolve(o)},function(e){r.reject(e)}):O.geocode({address:e}).then(function(e){r.resolve(e[0].geometry.location)},function(e){r.reject(e)}),r.promise}function m(o,r){return function(e){var t,n;e&&(t=w("set-"+o),n=M.toOptionValue(e,{key:o}),r[t]&&(o.match(/center|position/)&&"string"==typeof n?d(n).then(function(e){r[t](e)}):r[t](n)))}}function f(e){"true"==e.getAttribute("default-style")?(e.style.display="block",e.style.height="300px"):("block"!=t(e,"display")&&(e.style.display="block"),t(e,"height").match(/^(0|auto)/)&&(e.style.height="300px"))}var v,y,h,b,M,O,w,L,a={};angular.module("ngMap").provider("NgMap",function(){var p={};this.setDefaultOptions=function(e){p=e};function e(e,t,n,o,r,a,i,s){return v=e,y=t[0],h=n,b=o,M=r,O=a,w=i,L=s,{defaultOptions:p,addMap:l,deleteMap:g,getMap:u,initMap:c,setStyle:f,getGeoLocation:d,observeAndSet:m}}e.$inject=["$window","$document","$q","NavigatorGeolocation","Attr2MapOptions","GeoCoder","camelCaseFilter","NgMapPool"],this.$get=e})}(),function(){"use strict";function t(e,t){t=t||e.getCenter();var n=o.defer();return(new google.maps.StreetViewService).getPanoramaByLocation(t||e.getCenter,100,function(e,t){t===google.maps.StreetViewStatus.OK?n.resolve(e.location.pano):n.resolve(!1)}),n.promise}function n(e,t){new google.maps.StreetViewPanorama(e.getDiv(),{enableCloseButton:!0}).setPano(t)}function e(e){return o=e,{getPanorama:t,setPanorama:n}}var o;e.$inject=["$q"],angular.module("ngMap").service("StreetView",e)}(),"ngMap"});
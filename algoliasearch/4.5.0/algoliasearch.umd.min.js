!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).algoliasearch=t()}(this,function(){"use strict";function t(t,e){var r,n=Object.keys(t);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(t),e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)),n}function P(a){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?t(Object(o),!0).forEach(function(e){var t,r,n;t=a,n=o[r=e],r in t?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(o)):t(Object(o)).forEach(function(e){Object.defineProperty(a,e,Object.getOwnPropertyDescriptor(o,e))})}return a}function h(e,t){if(null==e)return{};var r,n=function(e,t){if(null==e)return{};for(var r,n={},a=Object.keys(e),o=0;o<a.length;o++)r=a[o],0<=t.indexOf(r)||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols)for(var a=Object.getOwnPropertySymbols(e),o=0;o<a.length;o++)r=a[o],0<=t.indexOf(r)||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r]);return n}function m(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,a=!1,o=void 0;try{for(var u,i=e[Symbol.iterator]();!(n=(u=i.next()).done)&&(r.push(u.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{n||null==i.return||i.return()}finally{if(a)throw o}}return r}}(e,t)||c(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function O(e){return function(e){if(Array.isArray(e))return n(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||c(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(e,t){if(e){if("string"==typeof e)return n(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(e,t):void 0}}function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function y(e){var u=0<arguments.length&&void 0!==e?e:{serializable:!0},i={};return{get:function(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{miss:function(){return Promise.resolve()}},n=JSON.stringify(e);if(n in i)return Promise.resolve(u.serializable?JSON.parse(i[n]):i[n]);var a=t(),o=r&&r.miss||function(){return Promise.resolve()};return a.then(function(e){return o(e)}).then(function(){return a})},set:function(e,t){return i[JSON.stringify(e)]=u.serializable?JSON.stringify(t):t,Promise.resolve(t)},delete:function(e){return delete i[JSON.stringify(e)],Promise.resolve()},clear:function(){return i={},Promise.resolve()}}}function g(e,t,r){var n={"x-algolia-api-key":r,"x-algolia-application-id":t};return{headers:function(){return e===w.WithinHeaders?n:{}},queryParameters:function(){return e===w.WithinQueryParameters?n:{}}}}function f(r){var n=0;return r(function t(){return n++,new Promise(function(e){setTimeout(function(){e(r(t))},Math.min(100*n,1e3))})})}function v(e,t){var r=1<arguments.length&&void 0!==t?t:function(e,t){return Promise.resolve()};return Object.assign(e,{wait:function(t){return v(e.then(function(e){return Promise.all([r(e,t),e])}).then(function(e){return e[1]}))}})}function b(t,r){return Object.keys(void 0!==r?r:{}).forEach(function(e){t[e]=r[e](t)}),t}function I(e){for(var t=arguments.length,r=new Array(1<t?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var a=0;return e.replace(/%s/g,function(){return encodeURIComponent(r[a++])})}var w={WithinQueryParameters:0,WithinHeaders:1};function d(e,t){var r=e||{},n=r.data||{};return Object.keys(r).forEach(function(e){-1===["timeout","headers","queryParameters","data","cacheable"].indexOf(e)&&(n[e]=r[e])}),{data:0<Object.entries(n).length?n:void 0,timeout:r.timeout||t,headers:r.headers||{},queryParameters:r.queryParameters||{},cacheable:r.cacheable}}var j={Read:1,Write:2,Any:3},o=1,x=2,S=3;function q(e,t){var r=1<arguments.length&&void 0!==t?t:o;return P(P({},e),{},{status:r,lastUpdate:Date.now()})}function l(e){return"string"==typeof e?{protocol:"https",url:e,accept:j.Any}:{protocol:e.protocol||"https",url:e.url,accept:e.accept||j.Any}}var u="DELETE",i="GET",D="POST";function s(t,a){return Promise.all(a.map(function(e){return t.get(e,function(){return Promise.resolve(q(e))})})).then(function(e){var t=e.filter(function(e){return(t=e).status===o||12e4<Date.now()-t.lastUpdate;var t}),r=e.filter(function(e){return(t=e).status===S&&Date.now()-t.lastUpdate<=12e4;var t}),n=[].concat(O(t),O(r));return{getTimeout:function(e,t){return(0===r.length&&0===e?1:r.length+3+e)*t},statelessHosts:0<n.length?n.map(l):a}})}function p(f,e,d,l){function p(r,n){var a=r.pop();if(void 0===a)throw{name:"RetryError",message:"Unreachable hosts - your application id may be incorrect. If the error persists, contact support@algolia.com.",transporterStackTrace:N(h)};function o(e){var t={request:s,response:e,host:a,triesLeft:r.length};return h.push(t),t}var e,t,u,i,s={data:m,headers:y,method:g,url:(e=a,t=d.path,u=k(v),i="".concat(e.protocol,"://").concat(e.url,"/").concat("/"===t.charAt(0)?t.substr(1):t),u.length&&(i+="?".concat(u)),i),connectTimeout:n(b,f.timeouts.connect),responseTimeout:n(b,l.timeout)},c={onSucess:function(t){try{return JSON.parse(t.content)}catch(e){throw function(e){return{name:"DeserializationError",message:e,response:t}}(e.message)}},onRetry:function(e){var t=o(e);return e.isTimedOut&&b++,Promise.all([f.logger.info("Retryable failure",R(t)),f.hostsCache.set(a,q(a,e.isTimedOut?S:x))]).then(function(){return p(r,n)})},onFail:function(e){throw o(e),function(e,t){var r=e.content,n=e.status,a=r;try{a=JSON.parse(r).message}catch(e){}return{name:"ApiError",message:a,status:n,transporterStackTrace:t}}(e,N(h))}};return f.requester.send(s).then(function(e){return r=c,u=(n=t=e).status,n.isTimedOut||(a=n.isTimedOut,o=n.status,!a&&0==~~o)||2!=~~(u/100)&&4!=~~(u/100)?r.onRetry(t):2==~~(t.status/100)?r.onSucess(t):r.onFail(t);var t,r,n,a,o,u})}var t,r,n,h=[],m=function(e,t){if(e.method!==i&&(void 0!==e.data||void 0!==t.data)){var r=Array.isArray(e.data)?e.data:P(P({},e.data),t.data);return JSON.stringify(r)}}(d,l),y=(t=l,r=P(P({},f.headers),t.headers),n={},Object.keys(r).forEach(function(e){var t=r[e];n[e.toLowerCase()]=t}),n),g=d.method,a=d.method!==i?{}:P(P({},d.data),l.data),v=P(P(P({"x-algolia-agent":f.userAgent.value},f.queryParameters),a),l.queryParameters),b=0;return s(f.hostsCache,e).then(function(e){return p(O(e.statelessHosts).reverse(),e.getTimeout)})}function T(e){var t=e.hostsCache,r=e.logger,n=e.requester,a=e.requestsCache,o=e.responsesCache,u=e.timeouts,i=e.userAgent,s=e.hosts,c=e.queryParameters,f={hostsCache:t,logger:r,requester:n,requestsCache:a,responsesCache:o,timeouts:u,userAgent:i,headers:e.headers,queryParameters:c,hosts:s.map(l),read:function(e,t){function r(){return p(f,f.hosts.filter(function(e){return 0!=(e.accept&j.Read)}),e,n)}var n=d(t,f.timeouts.read);if(!0!==(void 0!==n.cacheable?n.cacheable:e.cacheable))return r();var a={request:e,mappedRequestOptions:n,transporter:{queryParameters:f.queryParameters,headers:f.headers}};return f.responsesCache.get(a,function(){return f.requestsCache.get(a,function(){return f.requestsCache.set(a,r()).then(function(e){return Promise.all([f.requestsCache.delete(a),e])},function(e){return Promise.all([f.requestsCache.delete(a),Promise.reject(e)])}).then(function(e){var t=m(e,2);return t[0],t[1]})})},{miss:function(e){return f.responsesCache.set(a,e)}})},write:function(e,t){return p(f,f.hosts.filter(function(e){return 0!=(e.accept&j.Write)}),e,d(t,f.timeouts.write))}};return f}function k(r){return Object.keys(r).map(function(e){return I("%s=%s",e,(t=r[e],"[object Object]"===Object.prototype.toString.call(t)||"[object Array]"===Object.prototype.toString.call(t)?JSON.stringify(r[e]):r[e]));var t}).join("&")}function N(e){return e.map(R)}function R(e){var t=e.request.headers["x-algolia-api-key"]?{"x-algolia-api-key":"*****"}:{};return P(P({},e),{},{request:P(P({},e.request),{},{headers:P(P({},e.request.headers),t)})})}function A(r){return function(e,t){return r.transporter.write({method:D,path:"2/abtests",data:e},t)}}function E(r){return function(e,t){return r.transporter.write({method:u,path:I("2/abtests/%s",e)},t)}}function C(r){return function(e,t){return r.transporter.read({method:i,path:I("2/abtests/%s",e)},t)}}function U(t){return function(e){return t.transporter.read({method:i,path:"2/abtests"},e)}}function J(r){return function(e,t){return r.transporter.write({method:D,path:I("2/abtests/%s/stop",e)},t)}}function z(t){return function(e){return t.transporter.read({method:i,path:"1/strategies/personalization"},e)}}function F(r){return function(e,t){return r.transporter.write({method:D,path:"1/strategies/personalization",data:e},t)}}function a(n){return function t(r){return n.request(r).then(function(e){if(void 0!==n.batch&&n.batch(e.hits),!n.shouldStop(e))return e.cursor?t({cursor:e.cursor}):t({page:(r.page||0)+1})})}({})}function M(u){return function(e,t){var r=t||{},n=r.queryParameters,a=h(r,["queryParameters"]),o=P({acl:e},void 0!==n?{queryParameters:n}:{});return v(u.transporter.write({method:D,path:"1/keys",data:o},a),function(e,r){return f(function(t){return Fe(u)(e.key,r).catch(function(e){if(404!==e.status)throw e;return t()})})})}}function H(a){return function(e,t,r){var n=d(r);return n.queryParameters["X-Algolia-User-ID"]=e,a.transporter.write({method:D,path:"1/clusters/mapping",data:{cluster:t}},n)}}function K(n){return function(e,t,r){return n.transporter.write({method:D,path:"1/clusters/mapping/batch",data:{users:e,cluster:t}},r)}}function W(n){return function(r,e,t){return v(n.transporter.write({method:D,path:I("1/indexes/%s/operation",r),data:{operation:"copy",destination:e}},t),function(e,t){return Me(n)(r,{methods:{waitTask:$e}}).waitTask(e.taskID,t)})}}function B(n){return function(e,t,r){return W(n)(e,t,P(P({},r),{},{scope:[Ze.Rules]}))}}function Q(n){return function(e,t,r){return W(n)(e,t,P(P({},r),{},{scope:[Ze.Settings]}))}}function G(n){return function(e,t,r){return W(n)(e,t,P(P({},r),{},{scope:[Ze.Synonyms]}))}}function V(n){return function(r,e){return v(n.transporter.write({method:u,path:I("1/keys/%s",r)},e),function(e,t){return f(function(e){return Fe(n)(r,t).then(e).catch(function(e){if(404!==e.status)throw e})})})}}function L(t){return function(e){return t.transporter.read({method:i,path:"1/logs"},e)}}function _(t){return function(e){return t.transporter.read({method:i,path:"1/clusters/mapping/top"},e)}}function X(r){return function(e,t){return r.transporter.read({method:i,path:I("1/clusters/mapping/%s",e)},t)}}function $(a){return function(e){var t=e||{},r=t.retrieveMappings,n=h(t,["retrieveMappings"]);return!0===r&&(n.getClusters=!0),a.transporter.read({method:i,path:"1/clusters/mapping/pending"},n)}}function Y(t){return function(e){return t.transporter.read({method:i,path:"1/keys"},e)}}function Z(t){return function(e){return t.transporter.read({method:i,path:"1/clusters"},e)}}function ee(t){return function(e){return t.transporter.read({method:i,path:"1/indexes"},e)}}function te(t){return function(e){return t.transporter.read({method:i,path:"1/clusters/mapping"},e)}}function re(n){return function(r,e,t){return v(n.transporter.write({method:D,path:I("1/indexes/%s/operation",r),data:{operation:"move",destination:e}},t),function(e,t){return Me(n)(r,{methods:{waitTask:$e}}).waitTask(e.taskID,t)})}}function ne(n){return function(e,t){return v(n.transporter.write({method:D,path:"1/indexes/*/batch",data:{requests:e}},t),function(t,r){return Promise.all(Object.keys(t.taskID).map(function(e){return Me(n)(e,{methods:{waitTask:$e}}).waitTask(t.taskID[e],r)}))})}}function ae(r){return function(e,t){return r.transporter.read({method:D,path:"1/indexes/*/objects",data:{requests:e}},t)}}function oe(n){return function(e,t){var r=e.map(function(e){return P(P({},e),{},{params:k(e.params||{})})});return n.transporter.read({method:D,path:"1/indexes/*/queries",data:{requests:r},cacheable:!0},t)}}function ue(u){return function(e,o){return Promise.all(e.map(function(e){var t=e.params,r=t.facetName,n=t.facetQuery,a=h(t,["facetName","facetQuery"]);return Me(u)(e.indexName,{methods:{searchForFacetValues:Le}}).searchForFacetValues(r,n,P(P({},o),a))}))}}function ie(n){return function(e,t){var r=d(t);return r.queryParameters["X-Algolia-User-ID"]=e,n.transporter.write({method:u,path:"1/clusters/mapping"},r)}}function se(a){return function(n,e){return v(a.transporter.write({method:D,path:I("1/keys/%s/restore",n)},e),function(e,r){return f(function(t){return Fe(a)(n,r).catch(function(e){if(404!==e.status)throw e;return t()})})})}}function ce(r){return function(e,t){return r.transporter.read({method:D,path:"1/clusters/mapping/search",data:{query:e}},t)}}function fe(s){return function(n,e){var a=Object.assign({},e),t=e||{},r=t.queryParameters,o=h(t,["queryParameters"]),u=r?{queryParameters:r}:{},i=["acl","indexes","referers","restrictSources","queryParameters","description","maxQueriesPerIPPerHour","maxHitsPerQuery"];return v(s.transporter.write({method:"PUT",path:I("1/keys/%s",n),data:u},o),function(e,t){return f(function(r){return Fe(s)(n,t).then(function(e){return t=e,Object.keys(a).filter(function(e){return-1!==i.indexOf(e)}).every(function(e){return t[e]===a[e]})?Promise.resolve():r();var t})})})}}function de(r){return function(e,t){return v(r.transporter.write({method:D,path:I("1/indexes/%s/batch",r.indexName),data:{requests:e}},t),function(e,t){return $e(r)(e.taskID,t)})}}function le(r){return function(t){return a(P(P({shouldStop:function(e){return void 0===e.cursor}},t),{},{request:function(e){return r.transporter.read({method:D,path:I("1/indexes/%s/browse",r.indexName),data:e},t)}}))}}function pe(r){return function(e){var t=P({hitsPerPage:1e3},e);return a(P(P({shouldStop:function(e){return e.hits.length<t.hitsPerPage}},t),{},{request:function(e){return _e(r)("",P(P({},t),e)).then(function(e){return P(P({},e),{},{hits:e.hits.map(function(e){return delete e._highlightResult,e})})})}}))}}function he(r){return function(e){var t=P({hitsPerPage:1e3},e);return a(P(P({shouldStop:function(e){return e.hits.length<t.hitsPerPage}},t),{},{request:function(e){return Xe(r)("",P(P({},t),e)).then(function(e){return P(P({},e),{},{hits:e.hits.map(function(e){return delete e._highlightResult,e})})})}}))}}function me(c){return function(a,o,e){var t=e||{},u=t.batchSize,i=h(t,["batchSize"]),s={taskIDs:[],objectIDs:[]};return v(function t(e){for(var r=[],n=0<arguments.length&&void 0!==e?e:0;n<a.length&&(r.push(a[n]),r.length!==(u||1e3));n++);return 0===r.length?Promise.resolve(s):de(c)(r.map(function(e){return{action:o,body:e}}),i).then(function(e){return s.objectIDs=s.objectIDs.concat(e.objectIDs),s.taskIDs.push(e.taskID),t(++n)})}(),function(e,t){return Promise.all(e.taskIDs.map(function(e){return $e(c)(e,t)}))})}}function ye(r){return function(e){return v(r.transporter.write({method:D,path:I("1/indexes/%s/clear",r.indexName)},e),function(e,t){return $e(r)(e.taskID,t)})}}function ge(a){return function(e){var t=e||{},r=t.forwardToReplicas,n=d(h(t,["forwardToReplicas"]));return r&&(n.queryParameters.forwardToReplicas=1),v(a.transporter.write({method:D,path:I("1/indexes/%s/rules/clear",a.indexName)},n),function(e,t){return $e(a)(e.taskID,t)})}}function ve(a){return function(e){var t=e||{},r=t.forwardToReplicas,n=d(h(t,["forwardToReplicas"]));return r&&(n.queryParameters.forwardToReplicas=1),v(a.transporter.write({method:D,path:I("1/indexes/%s/synonyms/clear",a.indexName)},n),function(e,t){return $e(a)(e.taskID,t)})}}function be(r){return function(e,t){return v(r.transporter.write({method:D,path:I("1/indexes/%s/deleteByQuery",r.indexName),data:e},t),function(e,t){return $e(r)(e.taskID,t)})}}function Pe(r){return function(e){return v(r.transporter.write({method:u,path:I("1/indexes/%s",r.indexName)},e),function(e,t){return $e(r)(e.taskID,t)})}}function Oe(r){return function(e,t){return v(He(r)([e],t).then(function(e){return{taskID:e.taskIDs[0]}}),function(e,t){return $e(r)(e.taskID,t)})}}function Ie(o){return function(e,t){var r=t||{},n=r.forwardToReplicas,a=d(h(r,["forwardToReplicas"]));return n&&(a.queryParameters.forwardToReplicas=1),v(o.transporter.write({method:u,path:I("1/indexes/%s/rules/%s",o.indexName,e)},a),function(e,t){return $e(o)(e.taskID,t)})}}function we(o){return function(e,t){var r=t||{},n=r.forwardToReplicas,a=d(h(r,["forwardToReplicas"]));return n&&(a.queryParameters.forwardToReplicas=1),v(o.transporter.write({method:u,path:I("1/indexes/%s/synonyms/%s",o.indexName,e)},a),function(e,t){return $e(o)(e.taskID,t)})}}function je(t){return function(e){return Ke(t)(e).then(function(){return!0}).catch(function(e){if(404!==e.status)throw e;return!1})}}function xe(a){return function(i,e){var t=e||{},r=t.query,s=t.paginate,n=h(t,["query","paginate"]),c=0;return function u(){return Ve(a)(r||"",P(P({},n),{},{page:c})).then(function(e){for(var t=0,r=Object.entries(e.hits);t<r.length;t++){var n=m(r[t],2),a=n[0],o=n[1];if(i(o))return{object:o,position:parseInt(a,10),page:c}}if(c++,!1===s||c>=e.nbPages)throw{name:"ObjectNotFoundError",message:"Object not found."};return u()})}()}}function Se(r){return function(e,t){return r.transporter.read({method:i,path:I("1/indexes/%s/%s",r.indexName,e)},t)}}function qe(){return function(e,t){for(var r=0,n=Object.entries(e.hits);r<n.length;r++){var a=m(n[r],2),o=a[0];if(a[1].objectID===t)return parseInt(o,10)}return-1}}function De(u){return function(e,t){var r=t||{},n=r.attributesToRetrieve,a=h(r,["attributesToRetrieve"]),o=e.map(function(e){return P({indexName:u.indexName,objectID:e},n?{attributesToRetrieve:n}:{})});return u.transporter.read({method:D,path:"1/indexes/*/objects",data:{requests:o}},a)}}function Te(r){return function(e,t){return r.transporter.read({method:i,path:I("1/indexes/%s/rules/%s",r.indexName,e)},t)}}function ke(r){return function(e,t){return r.transporter.read({method:i,path:I("1/indexes/%s/synonyms/%s",r.indexName,e)},t)}}function Ne(r){return function(e,t){return v(We(r)([e],t).then(function(e){return{objectID:e.objectIDs[0],taskID:e.taskIDs[0]}}),function(e,t){return $e(r)(e.taskID,t)})}}function Re(p){return function(t,e){function r(e,t,r,n){return v(p.transporter.write({method:D,path:I("1/indexes/%s/operation",e),data:{operation:r,destination:t}},n),function(e,t){return $e(p)(e.taskID,t)})}var n=e||{},a=n.safe,o=n.autoGenerateObjectIDIfNotExist,u=n.batchSize,i=h(n,["safe","autoGenerateObjectIDIfNotExist","batchSize"]),s=Math.random().toString(36).substring(7),c="".concat(p.indexName,"_tmp_").concat(s),f=Be({appId:p.appId,transporter:p.transporter,indexName:c}),d=[],l=r(p.indexName,c,"copy",P(P({},i),{},{scope:["settings","synonyms","rules"]}));return d.push(l),v((a?l.wait(i):l).then(function(){var e=f(t,P(P({},i),{},{autoGenerateObjectIDIfNotExist:o,batchSize:u}));return d.push(e),a?e.wait(i):e}).then(function(){var e=r(c,p.indexName,"move",i);return d.push(e),a?e.wait(i):e}).then(function(){return Promise.all(d)}).then(function(e){var t=m(e,3),r=t[0],n=t[1],a=t[2];return{objectIDs:n.objectIDs,taskIDs:[r.taskID].concat(O(n.taskIDs),[a.taskID])}}),function(e,t){return Promise.all(d.map(function(e){return e.wait(t)}))})}}function Ae(r){return function(e,t){return Qe(r)(e,P(P({},t),{},{clearExistingRules:!0}))}}function Ee(r){return function(e,t){return Ge(r)(e,P(P({},t),{},{replaceExistingSynonyms:!0}))}}function Ce(r){return function(e,t){return v(Be(r)([e],t).then(function(e){return{objectID:e.objectIDs[0],taskID:e.taskIDs[0]}}),function(e,t){return $e(r)(e.taskID,t)})}}function Ue(r){return function(e,t){return Qe(r)([e],t)}}function Je(r){return function(e,t){return Ge(r)([e],t)}}function ze(o){return function(e,t){var r=t||{},n=r.forwardToReplicas,a=d(h(r,["forwardToReplicas"]));return n&&(a.queryParameters.forwardToReplicas=1),v(o.transporter.write({method:"PUT",path:I("1/indexes/%s/settings",o.indexName),data:e},a),function(e,t){return $e(o)(e.taskID,t)})}}var Fe=function(r){return function(e,t){return r.transporter.read({method:i,path:I("1/keys/%s",e)},t)}},Me=function(r){return function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return b({transporter:r.transporter,appId:r.appId,indexName:e},t.methods)}},He=function(n){return function(e,t){var r=e.map(function(e){return{objectID:e}});return me(n)(r,Ye.DeleteObject,t)}},Ke=function(t){return function(e){return t.transporter.read({method:i,path:I("1/indexes/%s/settings",t.indexName),data:{getVersion:2}},e)}},We=function(u){return function(e,t){var r=t||{},n=r.createIfNotExists,a=h(r,["createIfNotExists"]),o=n?Ye.PartialUpdateObject:Ye.PartialUpdateObjectNoCreate;return me(u)(e,o,a)}},Be=function(s){return function(e,t){var r=t||{},n=r.autoGenerateObjectIDIfNotExist,a=h(r,["autoGenerateObjectIDIfNotExist"]),o=n?Ye.AddObject:Ye.UpdateObject;if(o===Ye.UpdateObject){var u,i=function(e){var t;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(t=c(e))){t&&(e=t);var r=0,n=function(){};return{s:n,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,u=!1;return{s:function(){t=e[Symbol.iterator]()},n:function(){var e=t.next();return o=e.done,e},e:function(e){u=!0,a=e},f:function(){try{o||null==t.return||t.return()}finally{if(u)throw a}}}}(e);try{for(i.s();!(u=i.n()).done;)if(void 0===u.value.objectID)return v(Promise.reject({name:"MissingObjectIDError",message:"All objects must have an unique objectID (like a primary key) to be valid. Algolia is also able to generate objectIDs automatically but *it's not recommended*. To do it, use the `{'autoGenerateObjectIDIfNotExist': true}` option."}))}catch(e){i.e(e)}finally{i.f()}}return me(s)(e,o,a)}},Qe=function(u){return function(e,t){var r=t||{},n=r.forwardToReplicas,a=r.clearExistingRules,o=d(h(r,["forwardToReplicas","clearExistingRules"]));return n&&(o.queryParameters.forwardToReplicas=1),a&&(o.queryParameters.clearExistingRules=1),v(u.transporter.write({method:D,path:I("1/indexes/%s/rules/batch",u.indexName),data:e},o),function(e,t){return $e(u)(e.taskID,t)})}},Ge=function(u){return function(e,t){var r=t||{},n=r.forwardToReplicas,a=r.replaceExistingSynonyms,o=d(h(r,["forwardToReplicas","replaceExistingSynonyms"]));return n&&(o.queryParameters.forwardToReplicas=1),a&&(o.queryParameters.replaceExistingSynonyms=1),v(u.transporter.write({method:D,path:I("1/indexes/%s/synonyms/batch",u.indexName),data:e},o),function(e,t){return $e(u)(e.taskID,t)})}},Ve=function(r){return function(e,t){return r.transporter.read({method:D,path:I("1/indexes/%s/query",r.indexName),data:{query:e},cacheable:!0},t)}},Le=function(n){return function(e,t,r){return n.transporter.read({method:D,path:I("1/indexes/%s/facets/%s/query",n.indexName,e),data:{facetQuery:t},cacheable:!0},r)}},_e=function(r){return function(e,t){return r.transporter.read({method:D,path:I("1/indexes/%s/rules/search",r.indexName),data:{query:e}},t)}},Xe=function(r){return function(e,t){return r.transporter.read({method:D,path:I("1/indexes/%s/synonyms/search",r.indexName),data:{query:e}},t)}},$e=function(a){return function(e,n){return f(function(t){return r=a,function(e,t){return r.transporter.read({method:i,path:I("1/indexes/%s/task/%s",r.indexName,e.toString())},t)}(e,n).then(function(e){return"published"!==e.status?t():void 0});var r})}},Ye={AddObject:"addObject",UpdateObject:"updateObject",PartialUpdateObject:"partialUpdateObject",PartialUpdateObjectNoCreate:"partialUpdateObjectNoCreate",DeleteObject:"deleteObject",DeleteIndex:"delete",ClearIndex:"clear"},Ze={Settings:"settings",Synonyms:"synonyms",Rules:"rules"};function e(e,t,r){var n,a,o,u,i,s,c,f,d={appId:e,apiKey:t,timeouts:{connect:1,read:2,write:30},requester:{send:function(o){return new Promise(function(r){var n=new XMLHttpRequest;n.open(o.method,o.url,!0),Object.keys(o.headers).forEach(function(e){return n.setRequestHeader(e,o.headers[e])});function e(e,t){return setTimeout(function(){n.abort(),r({status:0,content:t,isTimedOut:!0})},1e3*e)}var t,a=e(o.connectTimeout,"Connection timeout");n.onreadystatechange=function(){n.readyState>n.OPENED&&void 0===t&&(clearTimeout(a),t=e(o.responseTimeout,"Socket timeout"))},n.onerror=function(){0===n.status&&(clearTimeout(a),clearTimeout(t),r({content:n.responseText||"Network request failed",status:n.status,isTimedOut:!1}))},n.onload=function(){clearTimeout(a),clearTimeout(t),r({content:n.responseText,status:n.status,isTimedOut:!1})},n.send(o.data)})}},logger:{debug:function(e,t){return Promise.resolve()},info:function(e,t){return Promise.resolve()},error:function(e,t){return console.error(e,t),Promise.resolve()}},responsesCache:y(),requestsCache:y({serializable:!3}),hostsCache:function n(e){var a=O(e.caches),o=a.shift();return void 0===o?{get:function(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{miss:function(){return Promise.resolve()}};return t().then(function(e){return Promise.all([e,r.miss(e)])}).then(function(e){return m(e,1)[0]})},set:function(e,t){return Promise.resolve(t)},delete:function(e){return Promise.resolve()},clear:function(){return Promise.resolve()}}:{get:function(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{miss:function(){return Promise.resolve()}};return o.get(e,t,r).catch(function(){return n({caches:a}).get(e,t,r)})},set:function(e,t){return o.set(e,t).catch(function(){return n({caches:a}).set(e,t)})},delete:function(e){return o.delete(e).catch(function(){return n({caches:a}).delete(e)})},clear:function(){return o.clear().catch(function(){return n({caches:a}).clear()})}}}({caches:[(a={key:"".concat("4.5.0","-").concat(e)},u="algoliasearch-client-js-".concat(a.key),{get:function(r,n){var a=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{miss:function(){return Promise.resolve()}};return Promise.resolve().then(function(){var e=JSON.stringify(r),t=p()[e];return Promise.all([t||n(),void 0!==t])}).then(function(e){var t=m(e,2),r=t[0],n=t[1];return Promise.all([r,n||a.miss(r)])}).then(function(e){return m(e,1)[0]})},set:function(t,r){return Promise.resolve().then(function(){var e=p();return e[JSON.stringify(t)]=r,l().setItem(u,JSON.stringify(e)),r})},delete:function(t){return Promise.resolve().then(function(){var e=p();delete e[JSON.stringify(t)],l().setItem(u,JSON.stringify(e))})},clear:function(){return Promise.resolve().then(function(){l().removeItem(u)})}}),y()]}),userAgent:(n={value:"Algolia for JavaScript (".concat("4.5.0",")"),add:function(e){var t="; ".concat(e.segment).concat(void 0!==e.version?" (".concat(e.version,")"):"");return-1===n.value.indexOf(t)&&(n.value="".concat(n.value).concat(t)),n}}).add({segment:"Browser"})};function l(){return void 0===o&&(o=a.localStorage||window.localStorage),o}function p(){return JSON.parse(l().getItem(u)||"{}")}return i=P(P(P({},d),r),{},{methods:{search:oe,searchForFacetValues:ue,multipleBatch:ne,multipleGetObjects:ae,multipleQueries:oe,copyIndex:W,copySettings:Q,copySynonyms:G,copyRules:B,moveIndex:re,listIndices:ee,getLogs:L,listClusters:Z,multipleSearchForFacetValues:ue,getApiKey:Fe,addApiKey:M,listApiKeys:Y,updateApiKey:fe,deleteApiKey:V,restoreApiKey:se,assignUserID:H,assignUserIDs:K,getUserID:X,searchUserIDs:ce,listUserIDs:te,getTopUserIDs:_,removeUserID:ie,hasPendingMappings:$,initIndex:function(t){return function(e){return Me(t)(e,{methods:{batch:de,delete:Pe,getObject:Se,getObjects:De,saveObject:Ce,saveObjects:Be,search:Ve,searchForFacetValues:Le,waitTask:$e,setSettings:ze,getSettings:Ke,partialUpdateObject:Ne,partialUpdateObjects:We,deleteObject:Oe,deleteObjects:He,deleteBy:be,clearObjects:ye,browseObjects:le,getObjectPosition:qe,findObject:xe,exists:je,saveSynonym:Je,saveSynonyms:Ge,getSynonym:ke,searchSynonyms:Xe,browseSynonyms:he,deleteSynonym:we,clearSynonyms:ve,replaceAllObjects:Re,replaceAllSynonyms:Ee,searchRules:_e,getRule:Te,deleteRule:Ie,saveRule:Ue,saveRules:Qe,replaceAllRules:Ae,browseRules:pe,clearRules:ge}})}},initAnalytics:function(){return function(e){return t=P(P(P({},d),e),{},{methods:{addABTest:A,getABTest:C,getABTests:U,stopABTest:J,deleteABTest:E}}),r=t.region||"us",n=g(w.WithinHeaders,t.appId,t.apiKey),a=T(P(P({hosts:[{url:"analytics.".concat(r,".algolia.com")}]},t),{},{headers:P(P(P({},n.headers()),{"content-type":"application/json"}),t.headers),queryParameters:P(P({},n.queryParameters()),t.queryParameters)})),b({appId:t.appId,transporter:a},t.methods);var t,r,n,a}},initRecommendation:function(){return function(e){return t=P(P(P({},d),e),{},{methods:{getPersonalizationStrategy:z,setPersonalizationStrategy:F}}),r=t.region||"us",n=g(w.WithinHeaders,t.appId,t.apiKey),a=T(P(P({hosts:[{url:"recommendation.".concat(r,".algolia.com")}]},t),{},{headers:P(P(P({},n.headers()),{"content-type":"application/json"}),t.headers),queryParameters:P(P({},n.queryParameters()),t.queryParameters)})),b({appId:t.appId,transporter:a},t.methods);var t,r,n,a}}}}),s=i.appId,c=g(void 0!==i.authMode?i.authMode:w.WithinHeaders,s,i.apiKey),b({transporter:f=T(P(P({hosts:[{url:"".concat(s,"-dsn.algolia.net"),accept:j.Read},{url:"".concat(s,".algolia.net"),accept:j.Write}].concat(function(e){for(var t=e.length-1;0<t;t--){var r=Math.floor(Math.random()*(t+1)),n=e[t];e[t]=e[r],e[r]=n}return e}([{url:"".concat(s,"-1.algolianet.com")},{url:"".concat(s,"-2.algolianet.com")},{url:"".concat(s,"-3.algolianet.com")}]))},i),{},{headers:P(P(P({},c.headers()),{"content-type":"application/x-www-form-urlencoded"}),i.headers),queryParameters:P(P({},c.queryParameters()),i.queryParameters)})),appId:s,addAlgoliaAgent:function(e,t){f.userAgent.add({segment:e,version:t})},clearCache:function(){return Promise.all([f.requestsCache.clear(),f.responsesCache.clear()]).then(function(){})}},i.methods)}return e.version="4.5.0",e});
!function(){"use strict";var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){var i={},a={editable:function(e,t){return(t=t||{}).srcNode=e,a.implementEventTarget(),new a.Core(t)},getBasePath:function(){var e=window.ALLOYEDITOR_BASEPATH||"";if(!e)for(var t=document.getElementsByTagName("script"),i=0;i<t.length;i++){var n=t[i].src.match(a.regexBasePath);if(n){e=n[1];break}}if(-1===e.indexOf(":/")&&"//"!==e.slice(0,2)&&(e=0===e.indexOf("/")?location.href.match(/^.*?:\/\/[^\/]*/)[0]+e:location.href.match(/^[^\?]*\/(?:)/)[0]+e),!e)throw'The AlloyEditor installation path could not be automatically detected. Please set the global variable "ALLOYEDITOR_BASEPATH" before creating editor instances.';return e},loadLanguageResources:function(e){var t,i,n,o;a.implementEventTarget(),a.Lang.isFunction(e)&&(a.Strings?setTimeout(e,0):a.once("languageResourcesLoaded",function(){setTimeout(e,0)})),a._langResourceRequested||(a._langResourceRequested=!0,t=["af","ar","bg","bn","bs","ca","cs","cy","da","de","el","en-au","en-ca","en-gb","en","eo","es","et","eu","fa","fi","fo","fr-ca","fr","gl","gu","he","hi","hr","hu","id","is","it","ja","ka","km","ko","ku","lt","lv","mk","mn","ms","nb","nl","no","pl","pt-br","pt","ro","ru","si","sk","sl","sq","sr-latn","sr","sv","th","tr","tt","ug","uk","vi","zh-cn","zh"],n=(i=(navigator.language||navigator.userLanguage||"en").toLowerCase().match(/([a-z]+)(?:-([a-z]+))?/))[1],o=i[2],0<=t.indexOf(n+"-"+o)?n=n+"-"+o:-1===t.indexOf(n)&&(n="en"),CKEDITOR.scriptLoader.load(a.getUrl("lang/alloy-editor/"+n+".js"),function(e){e&&a.fire("languageResourcesLoaded")},this))},getUrl:function(e){var t=a.getBasePath();return-1===e.indexOf(":/")&&0!==e.indexOf("/")&&(e=t+e),CKEDITOR.timestamp&&"/"!==e.charAt(e.length-1)&&!/[&?]t=/.test(e)&&(e+=(0<=e.indexOf("?")?"&":"?")+"t="+CKEDITOR.timestamp),e},implementEventTarget:function(){a.fire||a.on||CKEDITOR.event.implementOn(a)},regexBasePath:/(^|.*[\\\/])(?:alloy-editor[^/]+|alloy-editor)\.js(?:\?.*|;.*)?$/i,Buttons:{},Toolbars:{},getButtons:function(e){return function(){return e.reduce(function(e,t){return t=i[t]||[t],e.concat(t)},[])}},registerBridgeButton:function(e,t){i[t]||(i[t]=[]),i[t].push(e)}};"undefined"!=typeof module&&"object"===s(module.exports)&&(module.exports=a),"undefined"!=typeof window?window.AlloyEditor=a:"undefined"!=typeof global?global.AlloyEditor=a:"undefined"!=typeof self?self.AlloyEditor=a:this.AlloyEditor=a}();var d=(0,eval)("this").React;void 0===d&&(d=AlloyEditor.React);var p=(0,eval)("this").ReactDOM;void 0===d&&(p=AlloyEditor.ReactDOM);var l,e,t,i,n,o,a,r,c,u,m,g,h,f,y,E,b,v,C,_,T,A,I,k,w,D,S,O,x,R,N,B,K,L,P,F,M,z,H,$,j,q,U,W,V,G,Y,X,J,Z,Q,ee,te,ie,ne,oe,ae,re,se,le,de,ce,ue,me,pe,ge,he,fe,ye,Ee,be,ve,Ce,_e,Te,Ae,Ie,ke,we,De,Se,Oe,xe,Re,Ne,Be,Ke,Le,Pe,Fe,Me,ze,He,$e,je,qe,Ue,We,Ve,Ge,Ye,Xe,Je,Ze,Qe,et,tt,it,nt,ot,at,rt,st,lt,dt,ct,ut,mt,pt=(0,eval)("this").PropTypes||d.PropTypes,gt=(0,eval)("this").createReactClass||d.createClass;function ht(e){ht.superclass.constructor.call(this,e)}function ft(e,t){var i=p.findDOMNode(e),n=e.props.editor.get("nativeEditor").config.uiNode||document.body,o=getComputedStyle(n),a=parseInt(o.getPropertyValue("margin-left"),10),r=parseInt(o.getPropertyValue("margin-right"),10),s=a+n.clientWidth+r,l=i.offsetWidth/2,d=new CKEDITOR.dom.window(window).getScrollPosition(),c=e.props.gutter||be,u=e.getWidgetXYPoint(t.left+t.width/2-d.x,t.top+d.y,CKEDITOR.SELECTION_BOTTOM_TO_TOP),m=[t.left+t.width/2-l-d.x,t.top-i.offsetHeight+d.y-c.top];m[0]<0?m[0]=0:m[0]>s-i.offsetWidth&&(m[0]=s-i.offsetWidth),e.moveToPoint(u,m)}function yt(e){yt.superclass.constructor.call(this,e),this.init(e)}function Et(e){this.__config__=e||{},this.__ATTRS__={}}function bt(){}function vt(s,e,t){var i=AlloyEditor.Buttons[s];return Se[t.name]=Se[t.name]||{},Se[t.name][s]=Se[t.name][s]||e,i||(i=gt(CKEDITOR.tools.merge(De,{displayName:s,propTypes:{editor:pt.object.isRequired,tabIndex:pt.number},statics:{key:s},render:function(){var e,t,i=this.props.editor.get("nativeEditor"),n=Se[i.name][s].name||Se[i.name][s].command||s,o="ae-icon-"+n,a={},r=CKEDITOR.skin.getIconStyle(n);return r&&(e=r.split(";"),a.backgroundImage=e[0].substring(e[0].indexOf(":")+1),a.backgroundPosition=e[1].substring(e[1].indexOf(":")+1),a.backgroundSize=e[2].substring(e[2].indexOf(":")+1)),this.props.expanded&&(t=this._getMenu()),d.createElement("div",{className:"ae-container ae-has-dropdown"},d.createElement("button",{"aria-expanded":this.props.expanded,"aria-label":Se[i.name][s].label,className:"ae-button ae-button-bridge",onClick:this.props.toggleDropdown,role:"combobox",tabIndex:this.props.tabIndex,title:Se[i.name][s].label},d.createElement("span",{className:o,style:a})),t)},_getMenu:function(){return d.createElement(AlloyEditor.ButtonDropdown,{onDismiss:this.props.toggleDropdown},this._getMenuItems())},_getMenuItems:function(){var r=this.props.editor.get("nativeEditor"),s=e.onMenu();return Object.keys(s).map(function(e){var t=r.getMenuItem(e);if(!t)return null;var i=t.definition||t,n=s[e],o="ae-toolbar-element "+(n===CKEDITOR.TRISTATE_ON?"active":""),a=n===CKEDITOR.TRISTATE_DISABLED;return d.createElement("li",{key:t.name,role:"option"},d.createElement("button",{className:o,disabled:a,onClick:function(){i.command?r.execCommand(i.command):i.onClick&&i.onClick.apply(i)}},i.label))}.bind(this))}})),AlloyEditor.Buttons[s]=i),i}function Ct(l,e,t){var i=AlloyEditor.Buttons[l];return xe[t.name]=xe[t.name]||{},xe[t.name][l]=xe[t.name][l]||e,i||(i=gt(CKEDITOR.tools.merge(Oe,{displayName:l,propTypes:{editor:pt.object.isRequired,tabIndex:pt.number},statics:{key:l},render:function(){var e,t=this.props.editor.get("nativeEditor"),i=xe[t.name][l].name||xe[t.name][l].command||l,n=xe[t.name][l].label,o="button-"+i,a="ae-icon-"+i,r={},s=CKEDITOR.skin.getIconStyle(i);return s&&(e=s.split(";"),r.backgroundImage=e[0].substring(e[0].indexOf(":")+1),r.backgroundPosition=e[1].substring(e[1].indexOf(":")+1),r.backgroundSize=e[2].substring(e[2].indexOf(":")+1)),d.createElement("button",{"aria-label":n,className:"ae-button ae-button-bridge","data-type":o,onClick:this._handleClick,tabIndex:this.props.tabIndex,title:n},d.createElement("span",{className:a,style:r}))},_handleClick:function(){var e=this.props.editor.get("nativeEditor"),t=xe[e.name][l].command,i=xe[e.name][l].onClick;i?i.call(this):e.execCommand(t),e.fire("actionPerformed",this)}})),AlloyEditor.Buttons[l]=i),i}function _t(e){var t=e.getRanges(),i=[],n={};function o(e){0<i.length||e.type==CKEDITOR.NODE_ELEMENT&&Re.test(e.getName())&&!e.getCustomData("selected_cell")&&(CKEDITOR.dom.element.setMarker(n,e,"selected_cell",!0),i.push(e))}for(var a=0;a<t.length;a++){var r=t[a];if(r.collapsed){var s=r.getCommonAncestor(),l=s.getAscendant("td",!0)||s.getAscendant("th",!0);l&&i.push(l)}else{var d,c,u=new CKEDITOR.dom.walker(r);for(u.guard=o;d=u.next();){d.type==CKEDITOR.NODE_ELEMENT&&d.is(CKEDITOR.dtd.table)||(c=d.getAscendant("td",!0)||d.getAscendant("th",!0))&&!c.getCustomData("selected_cell")&&(CKEDITOR.dom.element.setMarker(n,c,"selected_cell",!0),i.push(c))}}}return CKEDITOR.dom.element.clearAllMarkers(n),i}function Tt(e,t){for(var i,n=_t(e),o=n[0],a=o.getAscendant("table"),r=o.getDocument(),s=n[0].getParent(),l=s.$.rowIndex,d=n[n.length-1],c=d.getParent().$.rowIndex+d.$.rowSpan-1,u=new CKEDITOR.dom.element(a.$.rows[c]),m=t?l:c,p=t?s:u,g=CKEDITOR.tools.buildTableMap(a),h=g[m],f=t?g[m-1]:g[m+1],y=g[0].length,E=r.createElement("tr"),b=0;h[b]&&b<y;b++){1<h[b].rowSpan&&f&&h[b]==f[b]?(i=h[b]).rowSpan+=1:((i=new CKEDITOR.dom.element(h[b]).clone()).removeAttribute("rowSpan"),i.appendBogus(),E.append(i),i=i.$),b+=i.colSpan-1}t?E.insertBefore(p):E.insertAfter(p)}function At(e,t){for(var i=e.getParent().$.cells,n=0,o=0;o<i.length;o++){var a=i[o];if(n+=t?1:a.colSpan,a==e.$)break}return n-1}function It(e,t){for(var i=t?1/0:0,n=0;n<e.length;n++){var o=At(e[n],t);(t?o<i:i<o)&&(i=o)}return i}function kt(e,t){for(var i,n=_t(e),o=n[0].getAscendant("table"),a=It(n,1),r=It(n),s=t?a:r,l=CKEDITOR.tools.buildTableMap(o),d=[],c=[],u=l.length,m=0;m<u;m++){d.push(l[m][s]);var p=t?l[m][s-1]:l[m][s+1];c.push(p)}for(m=0;m<u;m++){d[m]&&(1<d[m].colSpan&&c[m]==d[m]?(i=d[m]).colSpan+=1:((i=new CKEDITOR.dom.element(d[m]).clone()).removeAttribute("colSpan"),i.appendBogus(),i[t?"insertBefore":"insertAfter"].call(i,new CKEDITOR.dom.element(d[m])),i=i.$),m+=i.rowSpan-1)}}function wt(e,t){var i,n=e.getStartElement(),o=n.getAscendant("td",1)||n.getAscendant("th",1);o&&((i=o.clone()).appendBogus(),t?i.insertBefore(o):i.insertAfter(o))}function Dt(e){if(e instanceof CKEDITOR.dom.selection){for(var t=_t(e),i=t[0]&&t[0].getAscendant("table"),n=function(e){for(var t,i,n,o=0,a=e.length-1,r={};t=e[o++];)CKEDITOR.dom.element.setMarker(r,t,"delete_cell",!0);for(o=0;t=e[o++];)if((i=t.getPrevious())&&!i.getCustomData("delete_cell")||(i=t.getNext())&&!i.getCustomData("delete_cell"))return CKEDITOR.dom.element.clearAllMarkers(r),i;return CKEDITOR.dom.element.clearAllMarkers(r),(n=(n=e[0].getParent()).getPrevious())?n.getLast():(n=(n=e[a].getParent()).getNext())?n.getChild(0):null}(t),o=t.length-1;0<=o;o--)Dt(t[o]);n?St(n,!0):i&&i.remove()}else{var a;e instanceof CKEDITOR.dom.element&&(1==(a=e.getParent()).getChildCount()?a.remove():e.remove())}}function St(e,t){var i=e.getDocument(),n=CKEDITOR.document;CKEDITOR.env.ie&&10==CKEDITOR.env.version&&(n.focus(),i.focus());var o=new CKEDITOR.dom.range(i);o["moveToElementEdit"+(t?"End":"Start")](e)||(o.selectNodeContents(e),o.collapse(!t)),o.select(!0)}function Ot(e,t,i){var n=e[t];if(void 0===i)return n;for(var o=0;n&&o<n.length;o++){if(i.is&&n[o]==i.$)return o;if(o==i)return new CKEDITOR.dom.element(n[o])}return i.is?-1:null}function xt(e,t,i){var n,o=_t(e);if((t?1!=o.length:o.length<2)||(n=e.getCommonAncestor())&&n.type==CKEDITOR.NODE_ELEMENT&&n.is("table"))return!1;var a,r=o[0],s=r.getAscendant("table"),l=CKEDITOR.tools.buildTableMap(s),d=l.length,c=l[0].length,u=r.getParent().$.rowIndex,m=Ot(l,u,r);if(t){try{var p=parseInt(r.getAttribute("rowspan"),10)||1,g=parseInt(r.getAttribute("colspan"),10)||1,h=l["up"==t?u-p:"down"==t?u+p:u]["left"==t?m-g:"right"==t?m+g:m]}catch(e){return!1}if(!h||r.$==h)return!1;o["up"==t||"left"==t?"unshift":"push"](new CKEDITOR.dom.element(h))}for(var f,y,E=r.getDocument(),b=u,v=0,C=0,_=!i&&new CKEDITOR.dom.documentFragment(E),T=0,A=0;A<o.length;A++){var I,k=(a=o[A]).getParent(),w=a.getFirst(),D=a.$.colSpan,S=a.$.rowSpan,O=k.$.rowIndex,x=Ot(l,O,a);T+=D*S,C=Math.max(C,x-m+D),v=Math.max(v,O-u+S),i||(y=void 0,(y=(f=a).getBogus())&&y.remove(),f.trim(),a.getChildren().count()&&(O==b||!w||w.isBlockBoundary&&w.isBlockBoundary({br:1})||(!(I=_.getLast(CKEDITOR.dom.walker.whitespaces(!0)))||I.is&&I.is("br")||_.append("br")),a.moveChildren(_)),A?a.remove():a.setHtml("")),b=O}if(i)return v*C==T;_.moveChildren(r),r.appendBogus(),c<=C?r.removeAttribute("rowSpan"):r.$.rowSpan=v,d<=v?r.removeAttribute("colSpan"):r.$.colSpan=C;for(var R=new CKEDITOR.dom.nodeList(s.$.rows),N=R.count(),A=N-1;0<=A;A--){var B=R.getItem(A);B.$.cells.length||(B.remove(),N++)}return r}function Rt(e,t){var i=_t(e);if(1<i.length)return!1;if(t)return!0;var n,o,a,r=i[0],s=r.getParent(),l=s.getAscendant("table"),d=CKEDITOR.tools.buildTableMap(l),c=Ot(d,s.$.rowIndex,r),u=r.$.colSpan;if(1<u)o=Math.ceil(u/2),a=Math.floor(u/2);else{a=o=1;for(var m=function(e,t){for(var i=[],n=0;n<e.length;n++){var o=e[n];i.push(o[t]),1<o[t].rowSpan&&(n+=o[t].rowSpan-1)}return i}(d,c),p=0;p<m.length;p++)m[p].colSpan++}return(n=r.clone()).insertAfter(r),n.appendBogus(),r.$.colSpan=o,n.$.colSpan=a,1==o&&r.removeAttribute("colSpan"),1==a&&n.removeAttribute("colSpan"),n}function Nt(e){return CKEDITOR.env.ie?e.$.clientWidth:parseInt(e.getComputedStyle("width"),10)}function Bt(e,t){var i=e.getComputedStyle("border-"+t+"-width"),n={thin:"0px",medium:"1px",thick:"2px"};return i.indexOf("px")<0&&(i=i in n&&"none"!=e.getComputedStyle("border-style")?n[i]:0),parseInt(i,10)}function Kt(e){for(var t=[],i=-1,n="rtl"===e.getComputedStyle("direction"),o=function(e){for(var t,i,n,o=e.$.rows,a=0,r=0,s=o.length;r<s;r++)a<(t=(n=o[r]).cells.length)&&(a=t,i=n);return i}(e),a=new CKEDITOR.dom.element(e.$.tBodies[0]),r=a.getDocumentPosition(),s=0,l=o.cells.length;s<l;s++){var d,c,u,m=new CKEDITOR.dom.element(o.cells[s]),p=o.cells[s+1]&&new CKEDITOR.dom.element(o.cells[s+1]);i+=m.$.colSpan||1;var g=m.getDocumentPosition().x;n?c=g+Bt(m,"left"):d=g+m.$.offsetWidth-Bt(m,"right"),p?(g=p.getDocumentPosition().x,n?d=g+p.$.offsetWidth-Bt(p,"right"):c=g+Bt(p,"left")):(g=e.getDocumentPosition().x,n?d=g:c=g+e.$.offsetWidth),u=Math.max(c-d,4),t.push({table:e,index:i,x:d,y:r.y,width:u,height:a.$.offsetHeight,rtl:n})}return t}function Lt(e){(e.data||e).preventDefault()}function Pt(e,m){var p,g,h,f,y,E,b,v,C;function t(){g.removeListener("mouseup",o),g.removeListener("mousedown",n),g.removeListener("mousemove",_)}function i(){h=0,g.setOpacity(0),y&&function(){for(var r=m.rtl,e=r?b.length:E.length,t=0;t<e;t++){var i=E[t],n=b[t],s=m.table;CKEDITOR.tools.setTimeout(function(e,t,i,n,o,a){e&&e.setStyle("width",Ne(Math.max(t+a,1))),i&&i.setStyle("width",Ne(Math.max(n-a,1))),o&&s.setStyle("width",Ne(o+a*(r?-1:1)))},0,this,[i,i&&Nt(i),n,n&&Nt(n),(!i||!n)&&Nt(s)+Bt(s,"left")+Bt(s,"right"),y])}}();var e=m.table;setTimeout(function(){e.removeCustomData("_cke_table_pillars")},0),p.removeListener("dragstart",Lt)}function n(e){Lt(e),function(){for(var e=m.index,t=CKEDITOR.tools.buildTableMap(m.table),i=[],n=[],o=Number.MAX_VALUE,a=o,r=m.rtl,s=0,l=t.length;s<l;s++){var d=t[s],c=d[e+(r?1:0)],u=d[e+(r?0:1)],c=c&&new CKEDITOR.dom.element(c),u=u&&new CKEDITOR.dom.element(u);c&&u&&c.equals(u)||(c&&(o=Math.min(o,Nt(c))),u&&(a=Math.min(a,Nt(u))),i.push(c),n.push(u))}E=i,b=n,v=m.x-o,C=m.x+a,g.setOpacity(.5),f=parseInt(g.getStyle("left"),10),y=0,h=1,g.on("mousemove",_),p.on("dragstart",Lt)}(),p.on("mouseup",o,this)}function o(e){e.removeListener(),i()}function _(e){a(e.data.getPageOffset().x)}p=e.document,g=CKEDITOR.dom.element.createFromHtml('<div data-cke-temp=1 contenteditable=false unselectable=on style="position:absolute;cursor:col-resize;filter:alpha(opacity=0);opacity:0;padding:0;background-color:#004;background-image:none;border:0px none;z-index:10"></div>',p),e.on("destroy",function(){t(),g.remove()}),p.getDocumentElement().append(g),g.setStyles({width:Ne(m.width),height:Ne(m.height),left:Ne(m.x),top:Ne(m.y)}),g.on("mousedown",n,this),p.getBody().setStyle("cursor","col-resize"),g.show();var a=this.move=function(e){var t=e-Math.round(g.$.offsetWidth/2);if(r){if(t===v||t===C)return;t=Math.max(t,v),t=Math.min(t,C),y=t-f}g.setStyle("left",Ne(t))},r=(this.destroy=function(){t(),p.getBody().setStyle("cursor","auto"),g.remove()},this.isResizing=function(){return h})}function Ft(e){var t=e.data.getTarget();if("mouseout"===e.name){if(!t.is("table"))return;for(var i=new CKEDITOR.dom.element(e.data.$.relatedTarget||e.data.$.toElement);i&&i.$&&!i.equals(t)&&!i.is("body");)i=i.getParent();if(!i||i.equals(t))return}t.getAscendant("table",1).removeCustomData("_cke_table_pillars"),e.removeListener()}function Mt(n){var o=n.config.ae_dragresize_ie11_captionedClass,a=n.config.ae_dragresize_ie11_alignClasses,r={figure:1,a:1,img:1};return function(e){if(!(e.name in{div:1,p:1}))return!1;var t=e.children;if(1!==t.length)return!1;var i=t[0];if(!(i.name in r))return!1;if("p"==e.name){if(!zt(i))return!1}else if("figure"==i.name){if(!i.hasClass(o))return!1}else{if(n.enterMode==CKEDITOR.ENTER_P)return!1;if(!zt(i))return!1}return!(a?!e.hasClass(a[1]):"center"!=CKEDITOR.tools.parseCssText(e.attributes.style||"",!0)["text-align"])}}function zt(e){return"img"==e.name||"a"==e.name&&(1==e.children.length&&e.getFirst("img"))}function Ht(e){var t=e.widgets.focused;return t&&"image"==t.name?t:null}function $t(e){return e.data.hasCaption?e.element:e.parts.image}function jt(e){return"img"==e.name||"a"==e.name&&(1==e.children.length&&e.getFirst("img"))}function qt(e){return e.data.hasCaption?e.element:e.parts.image}function Ut(e,t){this.editor=e,this.window=e.window.$,this.document=e.document.$,this.cfg=t||{},this.init()}function Wt(e,t){this.window=e,this.document=t,this.events={mousemove:Vt(this.mousemove,this),keydown:Vt(this.keydown,this),mouseup:Vt(this.mouseup,this)}}function Vt(e,t){return e.bind?e.bind(t):function(){e.apply(t,arguments)}}function Gt(e,t,i){e.style.left=String(t)+"px",e.style.top=String(i)+"px"}function Yt(e,t){var i=t.getBoundingClientRect();return{left:i.left+e.pageXOffset,top:i.top+e.pageYOffset,width:i.width,height:i.height}}function Xt(e){this._editor=e}function Jt(){}function Zt(e,t){this._editor=e,this.appendProtocol=!t||!1!==t.appendProtocol}"undefined"!=typeof window&&(CKEDITOR.tools.debounce=CKEDITOR.tools.debounce||function(a,r,s,l){function e(){var e=s||this;clearTimeout(d);for(var t=[],i=arguments.length,n=0;n<i;++n)t.push(arguments[n]);var o=t.concat(l||[]);d=setTimeout(function(){a.apply(e,o)},r)}var d;return e.detach=function(){clearTimeout(d)},e},s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ct=/^#.*/i,ut=/^[a-z0-9\u0430-\u044F\._-]+@/i,mt=/^(?:[a-z][a-z0-9+\-.]*)\:|^\//i,Zt.prototype={constructor:Zt,advanceSelection:function(e){e=e||this.getFromSelection();var t,i,n,o=this._editor.getSelection().getRanges()[0];e&&(o.moveToElementEditEnd(e),(t=o.getNextEditableNode())&&!this._editor.element.equals(t.getCommonAncestor(e))&&(n=(i=/\s/.exec(t.getText()))?i.index+1:0,o.setStart(t,n),o.setEnd(t,n))),this._editor.getSelection().selectRanges([o])},create:function(e,t,i){var n,o=this._editor.getSelection().getRanges()[0];o.collapsed&&(n=new CKEDITOR.dom.text(e,this._editor.document),o.insertNode(n),o.selectNodeContents(n)),e=this._getCompleteURI(e);var a=CKEDITOR.tools.merge({"data-cke-saved-href":e,href:e},t),r=new CKEDITOR.style({attributes:a,element:"a"});r.type=CKEDITOR.STYLE_INLINE,r.applyToRange(o,this._editor),i&&i.advance?this.advanceSelection():o.select()},getFromSelection:function(){var e=this._editor.getSelection(),t=e.getSelectedElement();if(t&&t.is("a"))return t;if(t&&CKEDITOR.env.ie)for(var i=t.getChildren(),n=i.count(),o=0;o<n;o++){var a=i.getItem(o);if(a.is("a"))return a}var r=e.getRanges()[0];return r?(r.shrink(CKEDITOR.SHRINK_TEXT),this._editor.elementPath(r.getCommonAncestor()).contains("a",1)):null},remove:function(e,t){var i,n,o=this._editor;e?(t&&t.advance&&this.advanceSelection(),e.remove(o)):(i=new CKEDITOR.style({alwaysRemoveElement:1,element:"a",type:CKEDITOR.STYLE_INLINE}),(n=o.getSelection()).selectElement(n.getStartElement()),o.removeStyle(i))},update:function(i,e,t){var n,o,a,r=this;e=e||this.getFromSelection(),"string"==typeof i?(n=r._getCompleteURI(i),e.setAttributes({"data-cke-saved-href":n,href:n})):"object"===(void 0===i?"undefined":s(i))&&(o=[],a={},Object.keys(i).forEach(function(e){var t;null===i[e]?("href"===e&&o.push("data-cke-saved-href"),o.push(e)):"href"===e?(t=r._getCompleteURI(i[e]),a["data-cke-saved-href"]=t,a[e]=t):a[e]=i[e]}),e.removeAttributes(o),e.setAttributes(a)),t&&t.advance&&this.advanceSelection(e)},_getCompleteURI:function(e){return ct.test(e)||(ut.test(e)?e="mailto:"+e:mt.test(e)||(e=this.appendProtocol?"http://"+e:e)),e}},CKEDITOR.Link=CKEDITOR.Link||Zt,CKEDITOR.plugins.load=CKEDITOR.tools.override(CKEDITOR.plugins.load,function(n){return function(e,t,i){n.call(this,e,function(o){t&&(Object.keys(o).forEach(function(e){var t,n,i=o[e];i.requires&&(i.requires=("string"==typeof(t=i.requires)&&(t=t.split(",")),t.filter(function(e){return"toolbar"!==e}))),n=i,["beforeInit","init","afterInit"].forEach(function(e){n[e]&&(n[e]=CKEDITOR.tools.override(n[e],function(t){var i={phase:e,plugin:n};return function(e){e.__processingPlugin__=i,t.call(this,e),e.__processingPlugin__=null}}))})}),t.call(i,o))})}}),CKEDITOR.plugins.get("ae_selectionregion")||(CKEDITOR.SELECTION_TOP_TO_BOTTOM=0,CKEDITOR.SELECTION_BOTTOM_TO_TOP=1,CKEDITOR.SELECTION_LEFT_TO_RIGHT=2,CKEDITOR.SELECTION_RIGHT_TO_LEFT=3,Jt.prototype={constructor:Jt,createSelectionFromPoint:function(e,t){this.createSelectionFromRange(e,t,e,t)},createSelectionFromRange:function(e,t,i,n){var o,a,r,s,l,d,c,u;"function"==typeof document.caretPositionFromPoint?(l=document.caretPositionFromPoint(e,t),o=document.caretPositionFromPoint(i,n),d=l.offsetNode,a=o.offsetNode,c=l.offset,r=o.offset,s=this.createRange()):"function"==typeof document.caretRangeFromPoint&&(l=document.caretRangeFromPoint(e,t),o=document.caretRangeFromPoint(i,n),d=l.startContainer,a=o.startContainer,c=l.startOffset,r=o.startOffset,s=this.createRange()),s&&document.getSelection?(s.setStart(new CKEDITOR.dom.node(d),c),s.setEnd(new CKEDITOR.dom.node(a),r),this.getSelection().selectRanges([s])):"function"==typeof document.body.createTextRange&&(this.getSelection().unlock(),(s=document.body.createTextRange()).moveToPoint(e,t),(u=s.duplicate()).moveToPoint(i,n),s.setEndPoint("EndToEnd",u),s.select(),this.getSelection().lock())},getCaretRegion:function(){var e={bottom:0,left:0,right:0,top:0},t=this.getSelection().createBookmarks();if(!t.length)return e;var i=t[0].startNode.$;i.style.display="inline-block",e=new CKEDITOR.dom.element(i).getClientRect(),i.parentNode.removeChild(i);var n=new CKEDITOR.dom.window(window).getScrollPosition();return e.bottom=n.y+e.bottom,e.left=n.x+e.left,e.right=n.x+e.right,e.top=n.y+e.top,e},getSelectionData:function(){var e=this.getSelection();if(!e.getNative())return null;var t={element:e.getSelectedElement(),text:e.getSelectedText()};return t.region=this.getSelectionRegion(e),t},getSelectionRegion:function(){var e=this.getClientRectsRegion();return e.direction=this.getSelectionDirection(),e.height=e.bottom-e.top,e.width=e.right-e.left,e},isSelectionEmpty:function(){var e,t=this.getSelection();return t.getType()===CKEDITOR.SELECTION_NONE||(e=t.getRanges())&&1===e.length&&e[0].collapsed},getClientRectsRegion:function(){var e=this.getSelection().getNative(),t={bottom:0,height:0,left:0,right:0,top:0,width:0},i={bottom:0,endRect:t,left:0,right:0,top:0,startRect:t};if(!e)return i;var n=0,o=1/0,a=-1/0,r=1/0,s=e.createRange?e.createRange().getClientRects():(e.rangeCount,0<e.rangeCount?e.getRangeAt(0).getClientRects():[]);if(0===s.length)i=this.getCaretRegion();else{for(var l=0,d=s.length;l<d;l++){var c=s[l];c.left<o&&(o=c.left),c.right>a&&(a=c.right),c.top<r&&(r=c.top),c.bottom>n&&(n=c.bottom)}var u,m,p=new CKEDITOR.dom.window(window).getScrollPosition();i.bottom=p.y+n,i.left=p.x+o,i.right=p.x+a,i.top=p.y+r,s.length&&(u=s[s.length-1],m=s[0],i.endRect={bottom:p.y+u.bottom,height:u.height,left:p.x+u.left,right:p.x+u.right,top:p.y+u.top,width:u.width},i.startRect={bottom:p.y+m.bottom,height:m.height,left:p.x+m.left,right:p.x+m.right,top:p.y+m.top,width:m.width})}return i},getSelectionDirection:function(){var e,t,i=CKEDITOR.SELECTION_TOP_TO_BOTTOM,n=this.getSelection().getNative();return n&&(e=n.anchorNode)&&e.compareDocumentPosition&&((!(t=e.compareDocumentPosition(n.focusNode))&&n.anchorOffset>n.focusOffset||t===Node.DOCUMENT_POSITION_PRECEDING)&&(i=CKEDITOR.SELECTION_BOTTOM_TO_TOP)),i}},CKEDITOR.plugins.add("ae_selectionregion",{init:function(e){var t,i=Object.prototype.hasOwnProperty;for(t in Jt.prototype)i.call(Jt.prototype,t)&&void 0===e[t]&&(e[t]=Jt.prototype[t])}})),dt={table:1,col:1,colgroup:1,tbody:1,td:1,tfoot:1,th:1,thead:1,tr:1},Xt.HEADING_BOTH="Both",Xt.HEADING_COL="Column",Xt.HEADING_NONE="None",Xt.HEADING_ROW="Row",Xt.prototype={constructor:Xt,create:function(e){var t=this._editor,i=this._createElement("table");e=e||{};for(var n=i.append(this._createElement("tbody")),o=e.rows||1,a=e.cols||1,r=0;r<o;r++)for(var s=n.append(this._createElement("tr")),l=0;l<a;l++){s.append(this._createElement("td")).appendBogus()}this.setAttributes(i,e.attrs),this.setHeading(i,e.heading),t.insertElement(i);var d=new CKEDITOR.dom.element(i.$.rows[0].cells[0]),c=t.createRange();return c.moveToPosition(d,CKEDITOR.POSITION_AFTER_START),c.select(),i},getFromSelection:function(){var e,t,i=this._editor.getSelection(),n=i.getSelectedElement();return n&&n.is("table")?e=n:0<(t=i.getRanges()).length&&(CKEDITOR.env.webkit&&t[0].shrink(CKEDITOR.NODE_ELEMENT),e=this._editor.elementPath(t[0].getCommonAncestor(!0)).contains("table",1)),e},isEditable:function(e){return CKEDITOR.env.ie&&e.is(dt)?e.hasAttribute("contenteditable")?"false"!==e.getAttribute("contenteditable"):this.isEditable(e.getParent()):!e.isReadOnly()},getHeading:function(e){if(!(e=e||this.getFromSelection()))return null;for(var t=null!==e.$.tHead,i=!0,n=0;n<e.$.rows.length;n++){var o=e.$.rows[n].cells[0];if(o&&"th"!==o.nodeName.toLowerCase()){i=!1;break}}var a=t?Xt.HEADING_ROW:Xt.HEADING_NONE;return i&&(a=a===Xt.HEADING_ROW?Xt.HEADING_BOTH:Xt.HEADING_COL),a},remove:function(e){var t,i,n,o=this._editor;e?e.remove():(e=o.elementPath().contains("table",1))&&(t=e.getParent(),i=o.editable(),1!==t.getChildCount()||t.is("td","th")||t.equals(i)||(e=t),(n=o.createRange()).moveToPosition(e,CKEDITOR.POSITION_BEFORE_START),e.remove(),n.select())},setAttributes:function(t,i){i&&Object.keys(i).forEach(function(e){t.setAttribute(e,i[e])})},setHeading:function(e,t){var i,n,o=(e=e||this.getFromSelection()).getElementsByTag("tbody").getItem(0),a=this.getHeading(e),r=a===Xt.HEADING_COL||a===Xt.HEADING_BOTH,s=t===Xt.HEADING_COL||t===Xt.HEADING_BOTH,l=t===Xt.HEADING_ROW||t===Xt.HEADING_BOTH;if(!e.$.tHead&&l){for(var d=o.getElementsByTag("tr").getItem(0),c=d.getChildCount(),u=0;u<c;u++){var m=d.getChild(u);m.type!==CKEDITOR.NODE_ELEMENT||m.data("cke-bookmark")||(m.renameNode("th"),m.setAttribute("scope","col"))}(n=this._createElement(e.$.createTHead())).append(d.remove())}if(null!==e.$.tHead&&!l){n=this._createElement(e.$.tHead);for(var p=o.getFirst();0<n.getChildCount();){var g=n.getFirst(),h=g.getChildCount();for(u=0;u<h;u++)(i=g.getChild(u)).type===CKEDITOR.NODE_ELEMENT&&(i.renameNode("td"),i.removeAttribute("scope"));g.insertBefore(p)}n.remove()}if(!((a=this.getHeading(e))===Xt.HEADING_COL||a===Xt.HEADING_BOTH)&&s)for(u=0;u<e.$.rows.length;u++)"th"!==e.$.rows[u].cells[0].nodeName.toLowerCase()&&((i=new CKEDITOR.dom.element(e.$.rows[u].cells[0])).renameNode("th"),i.setAttribute("scope","row"));if(r&&!s)for(u=0;u<e.$.rows.length;u++){var f=new CKEDITOR.dom.element(e.$.rows[u]);"tbody"===f.getParent().getName()&&((i=new CKEDITOR.dom.element(f.$.cells[0])).renameNode("td"),i.removeAttribute("scope"))}},_createElement:function(e){return new CKEDITOR.dom.element(e,this._editor.document)}},CKEDITOR.on("instanceReady",function(t){var e=[Xt.HEADING_NONE,Xt.HEADING_ROW,Xt.HEADING_COL,Xt.HEADING_BOTH],i=new Xt(t.editor);e.forEach(function(e){t.editor.addCommand("tableHeading"+e,{exec:function(){i.setHeading(null,e)}})})}),CKEDITOR.Table=CKEDITOR.Table||Xt,CKEDITOR.tools.jsonp=function(e,t,i,n){var o=CKEDITOR.tools.getNextNumber();(t=t||{}).callback="CKEDITOR._.jsonpCallbacks["+o+"]",CKEDITOR._.jsonpCallbacks||(CKEDITOR._.jsonpCallbacks={}),CKEDITOR._.jsonpCallbacks[o]=function(e){setTimeout(function(){r(),i(e)})};var a=new CKEDITOR.dom.element("script");function r(){a&&(a.remove(),delete CKEDITOR._.jsonpCallbacks[o],a=null)}return a.setAttribute("src",e.output(t)),a.on("error",function(){r(),n&&n()}),CKEDITOR.document.getBody().append(a),{cancel:r,id:o}},CKEDITOR.tools.merge=CKEDITOR.tools.merge||function(){for(var e={},t=0;t<arguments.length;++t){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},CKEDITOR.tools.simulate=function(e,t){var i=document.createEvent("Events");i.initEvent(t,!0,!1),e.dispatchEvent(i)},CKEDITOR.plugins.get("ae_uicore")||CKEDITOR.plugins.add("ae_uicore",{init:function(n){var i=[],t=this._createAriaElement(n.id),e=n.config.uicore?n.config.uicore.timeout:50,o=CKEDITOR.tools.debounce(function(e){var t;i=[],"keyup"===e.name&&27===e.data.$.keyCode&&!n.config.allowEsc||(t=n.getSelectionData())&&n.fire("editorInteraction",{nativeEvent:e.data.$,selectionData:t})},e),a=CKEDITOR.tools.debounce(function(e){t.innerHTML=i.join(". ")},e),r=CKEDITOR.tools.debounce(function(e){for(var t,i=document.querySelectorAll(".ae-ui"),n=0;n<i.length;n++)if(i[n].contains(e.data.$.relatedTarget)){t=!0;break}t||o(e)},e);n.on("ariaUpdate",function(e){i.push(e.data.message),a()}),n.once("contentDom",function(){var t=n.editable(),i=t.attachListener(t,"focus",function(e){i.removeListener(),t.attachListener(t,"keyup",o),t.attachListener(t,"mouseup",o),t.attachListener(t,"mouseleave",r),o(e)})}),n.on("destroy",function(e){t.parentNode.removeChild(t),o.detach()})},_createAriaElement:function(e){var t=document.createElement("div");return t.className="ae-sr-only",t.setAttribute("aria-live","polite"),t.setAttribute("role","status"),t.setAttribute("id",e+"LiveRegion"),document.body.appendChild(t),t}}),lt=CKEDITOR.env.ie,CKEDITOR.plugins.get("ae_addimages")||CKEDITOR.plugins.add("ae_addimages",{init:function(t){t.once("contentDom",function(){var e=t.editable();e.attachListener(e,"dragenter",this._onDragEnter,this,{editor:t}),e.attachListener(e,"dragover",this._onDragOver,this,{editor:t}),e.attachListener(e,"drop",this._onDragDrop,this,{editor:t}),e.attachListener(e,"paste",this._onPaste,this,{editor:t})}.bind(this))},_handleFiles:function(e,t){for(var i,n=[],o=0;o<e.length;o++)0===(i=e[o]).type.indexOf("image")&&n.push(i);if(t.fire("beforeImageAdd",{imageFiles:n}))for(o=0;o<n.length;o++)i=n[o],this._processFile(i,t);return!1},_onDragDrop:function(e){var t,i=e.data.$,n=i.dataTransfer.files;0<n.length&&(new CKEDITOR.dom.event(i).preventDefault(),t=e.listenerData.editor,e.listenerData.editor.createSelectionFromPoint(i.clientX,i.clientY),this._handleFiles(n,t))},_onDragEnter:function(e){lt&&this._preventEvent(e)},_onDragOver:function(e){lt&&this._preventEvent(e)},_onPaste:function(e){var t,i;e.data&&e.data.$&&e.data.$.clipboardData&&e.data.$.clipboardData.items&&0<e.data.$.clipboardData.items.length&&(0===(t=e.data.$.clipboardData.items[0]).type.indexOf("image")&&(i=t.getAsFile(),this._processFile(i,e.listenerData.editor)))},_preventEvent:function(e){(e=new CKEDITOR.dom.event(e.data.$)).preventDefault(),e.stopPropagation()},_processFile:function(n,o){var a=new FileReader;a.addEventListener("loadend",function(){var e=a.result,t=CKEDITOR.dom.element.createFromHtml('<img src="'+e+'">');o.insertElement(t);var i={el:t,file:n};o.fire("imageAdd",i)}),a.readAsDataURL(n)}}),CKEDITOR.plugins.get("ae_autolink")||(/MSIE ([^;]*)|Trident.*; rv:([0-9.]+)/.test(navigator.userAgent)&&document.execCommand("AutoUrlDetect",!1,!1),ot=[188,13,186,32],at=/[^\s]+/gim,rt="((([A - Za - z]{ 3, 9}: (?: \\/\\/)?)(?:[-;:&=\\+\\$,\\w]+@)?[A-Za-z0-9.-]+|(https?\\:\\/\\/|www.|[-;:&=.\\+\\$,\\w]+@)[A-Za-z0-9.-]+)((?:\\/[\\+~%\\/.\\w-_]*)?\\??(?:[-\\+=&;%@.\\w_]*)#?(?:[\\w]*))((.*):(\\d*)\\/?(.*))?)",st=/[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}/i,CKEDITOR.plugins.add("ae_autolink",{init:function(t){t.once("contentDom",function(){var e=t.editable();e.attachListener(e,"keyup",this._onKeyUp,this,{editor:t})}.bind(this)),t.on("paste",function(e){if("paste"===e.data.method){if(-1<e.data.dataValue.indexOf("<")||-1<e.data.dataValue.indexOf("&lt;"))return void(-1<e.data.dataValue.indexOf('<u><font color="')&&(e.data.dataValue=e.data.dataValue.replace(/<u><font color=\"#(.*?)\">|<\/font><\/u>/g,"")));var t=this;e.data.dataValue=e.data.dataValue.replace(RegExp(rt,"gim"),function(e){if(t._isValidURL(e))return t._isValidEmail(e)?'<a href="mailto:'+e+'">'+e+"</a>":'<a href="'+e+'">'+e+"</a>"})}}.bind(this))},_getLastWord:function(e){var t=e.getSelection().getRanges()[0],i=t.startOffset,n="";if(13===this._currentKeyCode){var o,a=t.startContainer.getPrevious();if(a){for(;!a.getLast;)a=a.getPrevious();for(o=a.getLast();o&&!o.getText();)o=o.getPrevious()}o&&o.$.href||(n=(this._startContainer=o)?o.getText():"",this._offset=n.length)}else this._startContainer=t.startContainer,n=this._startContainer.getText().substring(0,i-1),this._offset=i-1;var r="",s=n.match(at);return s&&(r=s.pop()),r},_isValidEmail:function(e){return st.test(e)},_isValidURL:function(e){return RegExp(rt,"i").test(e)},_onKeyDown:function(e){var t=e.data.$,i=e.listenerData.editor;i.editable().removeListener("keydown",this._onKeyDown),8===t.keyCode&&(e.cancel(),e.data.preventDefault(),this._removeLink(i)),this._ckLink=null},_onKeyUp:function(e){var t,i,n=e.data.$;this._currentKeyCode=n.keyCode,-1!==ot.indexOf(this._currentKeyCode)&&(t=e.listenerData.editor,i=this._getLastWord(t),this._isValidURL(i)&&this._replaceContentByLink(t,i))},_replaceContentByLink:function(e,t){var i=e.createRange(),n=CKEDITOR.dom.element.get(this._startContainer),o=this._offset;i.setStart(n,o-t.length),i.setEnd(n,o),i.select();var a=new CKEDITOR.Link(e);a.create(t);var r,s,l=(this._ckLink=a).getFromSelection();e.fire("autolinkAdd",l),this._subscribeToKeyEvent(e),i=e.getSelection().getRanges()[0],13===this._currentKeyCode?(r=i.getNextEditableNode(),i.setStart(r,0),i.setEnd(r,0)):(s=i.getNextNode(),i.setStart(s,1),i.setEnd(s,1)),i.select()},_removeLink:function(e){var t=e.getSelection().getRanges()[0],i=t.startOffset,n=this._startContainer.getNext()||this._startContainer,o=e.createRange();o.setStart(n,0),o.setEndAfter(n),o.select(),this._ckLink.remove(),t.setEnd(t.startContainer,i),t.setStart(t.startContainer,i),t.select()},_subscribeToKeyEvent:function(e){var t=e.editable();t.attachListener(t,"keydown",this._onKeyDown,this,{editor:e},1)}})),CKEDITOR.plugins.get("ae_autolist")||(nt=[{regex:/^\*$/,type:"bulletedlist"},{regex:/^1\.$/,type:"numberedlist"}],CKEDITOR.plugins.add("ae_autolist",{init:function(t){t.once("contentDom",function(){var e=t.editable();e.attachListener(e,"keydown",this._onKeyDown,this,{editor:t})}.bind(this))},_checkForBackspaceAndUndo:function(e){var t=e.listenerData.editor,i=e.data.$;t.editable().removeListener("keydown",this._checkForBackspaceAndUndo),8===i.keyCode&&(t.execCommand("undo"),t.insertHtml(e.listenerData.bullet+"&nbsp;"),e.data.preventDefault())},_getListConfig:function(e){for(var t=e.config.autolist||nt,i=e.getSelection().getRanges()[0],n=i.endContainer.getText(),o=n.substring(0,i.startOffset),a=n.substring(i.startOffset,n.length),r=0,s=t.length,l=null;!l&&r<s;){var d=t[r];if(d.regex.test(o)){l={bullet:o,editor:e,text:a,type:d.type};break}r++}return l},_createList:function(e){var t=e.editor;t.getSelection().getRanges()[0].endContainer.setText(e.text),t.execCommand(e.type);var i=t.editable();i.attachListener(i,"keydown",this._checkForBackspaceAndUndo,this,{editor:t,bullet:e.bullet},1)},_onKeyDown:function(e){var t;32!==e.data.$.keyCode||(t=this._getListConfig(e.listenerData.editor))&&(e.data.preventDefault(),this._createList(t))}})),CKEDITOR.plugins.get("ae_dragresize")||(Qe={both:["tl","tm","tr","lm","rm","bl","bm","br"],height:["tl","tm","tr","bl","bm","br"],scale:["tl","tr","bl","br"],width:["tl","tr","lm","rm","bl","br"]},et={bl:function(e,t,i,n){Gt(e,-3+t,n.height-4+i)},bm:function(e,t,i,n){Gt(e,Math.round(n.width/2)-3+t,n.height-4+i)},br:function(e,t,i,n){Gt(e,n.width-4+t,n.height-4+i)},lm:function(e,t,i,n){Gt(e,-3+t,Math.round(n.height/2)-3+i)},tl:function(e,t,i){Gt(e,t-3,i-3)},tm:function(e,t,i,n){Gt(e,Math.round(n.width/2)-3+t,-3+i)},tr:function(e,t,i,n){Gt(e,n.width-4+t,-3+i)},rm:function(e,t,i,n){Gt(e,n.width-4+t,Math.round(n.height/2)-3+i)}},tt="MozAppearance"in document.documentElement.style,(it="WebkitAppearance"in document.documentElement.style||tt)&&CKEDITOR.addCss("img::selection{color:rgba(0,0,0,0)}img.ckimgrsz{outline:1px dashed #000}#ckimgrsz{position:absolute;width:0;height:0;cursor:default;z-index:10001}#ckimgrsz span{display:none;position:absolute;top:0;left:0;width:0;height:0;background-size:100% 100%;opacity:.65;outline:1px dashed #000}#ckimgrsz i{position:absolute;display:block;width:5px;height:5px;background:#fff;border:1px solid #000}#ckimgrsz i.active,#ckimgrsz i:hover{background:#000}#ckimgrsz i.br,#ckimgrsz i.tl{cursor:nwse-resize}#ckimgrsz i.bm,#ckimgrsz i.tm{cursor:ns-resize}#ckimgrsz i.bl,#ckimgrsz i.tr{cursor:nesw-resize}#ckimgrsz i.lm,#ckimgrsz i.rm{cursor:ew-resize}body.dragging-br,body.dragging-br *,body.dragging-tl,body.dragging-tl *{cursor:nwse-resize!important}body.dragging-bm,body.dragging-bm *,body.dragging-tm,body.dragging-tm *{cursor:ns-resize!important}body.dragging-bl,body.dragging-bl *,body.dragging-tr,body.dragging-tr *{cursor:nesw-resize!important}body.dragging-lm,body.dragging-lm *,body.dragging-rm,body.dragging-rm *{cursor:ew-resize!important}"),CKEDITOR.plugins.add("ae_dragresize",{onLoad:function(){},init:function(t){it&&t.once("contentDom",function(e){!function(t){var i=t.window.$,n=t.document.$;tt&&n.execCommand("enableObjectResizing",!1,!1);t.config.imageScaleResize=t.config.imageScaleResize||"both";function o(e){a.isHandle(e.target)&&a.initDrag(e)}var e,a=new Ut(t,{imageScaleResize:t.config.imageScaleResize,snapToSize:7});function r(){var e=t.getSelection();e&&(e.getType()!==CKEDITOR.SELECTION_NONE&&e.getStartElement().is("img")?i.event&&i.event.button&&0!==i.event.button||a.show(e.getStartElement().$):a.hide())}n.addEventListener("mousedown",o,!1),t.on("selectionChange",r),t.on("getData",function(e){var t=e.data.dataValue||"";t=(t=t.replace(/<div id="ckimgrsz"([\s\S]*?)<\/div>/i,"")).replace(/\b(ckimgrsz)\b/g,""),e.data.dataValue=t}),t.on("beforeUndoImage",function(){a.hide()}),t.on("afterUndoImage",function(){r()}),t.on("blur",function(){a.hide()}),t.on("beforeModeUnload",function e(){t.removeListener("beforeModeUnload",e),a.hide()}),t.on("destroy",function(){var e=n.getElementById("ckimgrsz");e&&e.remove(),tt&&n.execCommand("enableObjectResizing",!1,!0),n.removeEventListener("mousedown",o)}),t.window.on("resize",function(){clearTimeout(e),e=setTimeout(r,50)})}(t)})}}),Ut.prototype={init:function(){var i=this,e=this.container=this.document.createElement("div");e.id="ckimgrsz",this.preview=this.document.createElement("span"),e.appendChild(this.preview);var n=this.handles={};for(var t in Qe[this.cfg.imageScaleResize].forEach(function(e,t){n[e]=i.handles[e]=i.createHandle(e)}),n)e.appendChild(n[t])},createHandle:function(e){var t=this.document.createElement("i");return t.classList.add(e),t},isHandle:function(e){var t=this.handles;for(var i in t)if(t[i]===e)return!0;return!1},show:function(e){var t=this.editor.config.uiNode,i=t?t.scrollTop:0;this.el=e,this.cfg.snapToSize&&(this.otherImages=function(e){for(var t=e.length,i=new Array(t),n=0;n<t;n++)i[n]=e[n];return i}(this.document.getElementsByTagName("img")),this.otherImages.splice(this.otherImages.indexOf(e),1));var n=this.box=Yt(this.window,e);Gt(this.container,n.left,n.top+i),(t=t||document.body).appendChild(this.container),this.el.classList.add("ckimgrsz"),this.showHandles()},hide:function(){for(var e=this.document.getElementsByClassName("ckimgrsz"),t=0;t<e.length;++t)e[t].classList.remove("ckimgrsz");this.hideHandles(),this.container.parentNode&&this.container.parentNode.removeChild(this.container)},initDrag:function(e){var t,i;0===e.button&&((i=new Wt((t=this).window,this.document)).onStart=function(){t.showPreview(),t.isDragging=!0,t.editor.getSelection().lock()},i.onDrag=function(){t.calculateSize(this),t.updatePreview();var e=t.previewBox;t.updateHandles(e,e.left,e.top)},i.onRelease=function(){t.isDragging=!1,t.hidePreview(),t.hide(),t.editor.getSelection().unlock(),t.editor.fire("saveSnapshot")},i.onComplete=function(){t.resizeComplete(),t.editor.fire("saveSnapshot")},i.start(e))},updateHandles:function(e,t,i){t=t||0,i=i||0;var n=this.handles;for(var o in n)et[o](n[o],t,i,e)},showHandles:function(){var e=this.handles;for(var t in this.updateHandles(this.box),e)e[t].style.display="block"},hideHandles:function(){var e=this.handles;for(var t in e)e[t].style.display="none"},showPreview:function(){this.preview.style.backgroundImage='url("'+this.el.src+'")',this.calculateSize(),this.updatePreview(),this.preview.style.display="block"},updatePreview:function(){var e=this.previewBox;Gt(this.preview,e.left,e.top),this.preview.style.width=this.previewBox.width+"px",this.preview.style.height=this.previewBox.height+"px"},hidePreview:function(){var e=Yt(this.window,this.preview);this.result={width:e.width,height:e.height},this.preview.style.display="none"},calculateSize:function(e){var t=this.previewBox={top:0,left:0,width:this.box.width,height:this.box.height};if(e){var i,n=e.target.className;~n.indexOf("r")&&(t.width=Math.max(32,this.box.width+e.delta.x)),~n.indexOf("b")&&(t.height=Math.max(32,this.box.height+e.delta.y)),~n.indexOf("l")&&(t.width=Math.max(32,this.box.width-e.delta.x)),~n.indexOf("t")&&(t.height=Math.max(32,this.box.height-e.delta.y)),n.indexOf("m")<0&&!e.keys.shift&&(i=this.box.width/this.box.height,t.width/t.height>i?t.height=Math.round(t.width/i):t.width=Math.round(t.height*i));var o=this.cfg.snapToSize;if(o)for(var a=this.otherImages,r=0;r<a.length;r++){var s=Yt(this.window,a[r]);if(Math.abs(t.width-s.width)<=o&&Math.abs(t.height-s.height)<=o){t.width=s.width,t.height=s.height;break}}~n.indexOf("l")&&(t.left=this.box.width-t.width),~n.indexOf("t")&&(t.top=this.box.height-t.height)}},resizeComplete:function(){(function(e,t,i){var n=this.editor.config.imageScaleResize;"both"===n?(e.style.width=String(t)+"px",e.style.height=String(i)+"px"):"width"===n||"scale"===n?(e.style.height="auto",e.style.width=String(t)+"px"):"height"===n&&(e.style.height=String(i)+"px",e.style.width="auto")}).call(this,this.el,this.result.width,this.result.height)}},Wt.prototype={start:function(e){e.preventDefault(),e.stopPropagation(),this.target=e.target,this.attr=e.target.className,this.startPos={x:e.clientX,y:e.clientY},this.update(e);var t=this.events;this.document.addEventListener("mousemove",t.mousemove,!1),this.document.addEventListener("keydown",t.keydown,!1),this.document.addEventListener("mouseup",t.mouseup,!1),this.document.body.classList.add("dragging-"+this.attr),this.onStart&&this.onStart()},update:function(e){this.currentPos={x:e.clientX,y:e.clientY},this.delta={x:e.clientX-this.startPos.x,y:e.clientY-this.startPos.y},this.keys={shift:e.shiftKey,ctrl:e.ctrlKey,alt:e.altKey}},mousemove:function(e){this.update(e),this.onDrag&&this.onDrag(),0===e.which&&this.mouseup(e)},keydown:function(e){27===e.keyCode&&this.release()},mouseup:function(e){this.update(e),this.release(),this.onComplete&&this.onComplete()},release:function(){this.document.body.classList.remove("dragging-"+this.attr);var e=this.events;this.document.removeEventListener("mousemove",e.mousemove,!1),this.document.removeEventListener("keydown",e.keydown,!1),this.document.removeEventListener("mouseup",e.mouseup,!1),this.onRelease&&this.onRelease()}}),CKEDITOR.plugins.get("ae_dragresize_ie")||(Xe={center:1,left:0,right:2},Je={both:"nwse-resize",height:"ns-resize",scale:"nwse-resize",width:"ew-resize"},Ze=/^\s*(\d+\%)\s*$/i,CKEDITOR.plugins.add("ae_dragresize_ie",{hidpi:!0,icons:"image",init:function(e){var t=function(a){a.config.imageScaleResize=a.config.imageScaleResize||"both",a.on("imageAdd",function(e){a.widgets.initOn(e.data.el,"image")});var r=a.config.image2_alignClasses,e=a.config.image2_captionedClass;return{init:function(){var e,t=CKEDITOR.plugins.image2,i=this.parts.image,n={alt:i.getAttribute("alt")||"",hasCaption:!!this.parts.caption,height:i.getAttribute("height")||"",lock:!this.ready||t.checkHasNaturalRatio(i),src:i.getAttribute("src"),width:i.getAttribute("width")||""},o=i.getAscendant("a");o&&this.wrapper.contains(o)&&(this.parts.link=o),n.align||(e=n.hasCaption?this.element:i,r?(e.hasClass(r[0])?n.align="left":e.hasClass(r[2])&&(n.align="right"),n.align?e.removeClass(r[Xe[n.align]]):n.align="none"):(n.align=e.getStyle("float")||"none",e.removeStyle("float"))),this.wrapper[(n.hasCaption?"remove":"add")+"Class"]("cke_image_nocaption"),this.setData(n),!0!==a.config.image2_disableResizer&&function(f){var y=f.editor,E=y.editable(),b=y.document,v=f.resizer=b.createElement("span");{var e,t,i;v.addClass("cke_image_resizer"),v.addClass("cke_image_resizer_"+Je[y.config.imageScaleResize]),v.append(new CKEDITOR.dom.text("​",b)),f.inline?f.wrapper.append(v):(e=f.parts.link||f.parts.image,t=e.getParent(),(i=b.createElement("span")).addClass("cke_image_resizer_wrapper"),i.append(e),i.append(v),f.element.append(i,!0),t.is("span")&&t.remove())}v.on("mousedown",function(e){var i,n,o,a,r,s,l=f.parts.image,d="right"==f.data.align?-1:1,c=e.data.$.screenX,u=e.data.$.screenY,m=l.$.clientWidth,p=l.$.clientHeight,t=[],g="cke_image_s"+(~d?"e":"w");function h(e,t,i){var n=CKEDITOR.document,o=[];if(b.equals(n)||o.push(n.on(e,t)),o.push(b.on(e,t)),i)for(var a=o.length;a--;)i.push(o.pop())}y.fire("saveSnapshot"),h("mousemove",function(e){var t=y.config.imageScaleResize;i=e.data.$,r=i.screenX-c,s=u-i.screenY,Math.abs(r/s),"width"!==t&&"both"!==t&&"scale"!==t||(n=m+d*r);"height"!==t&&"both"!==t||(o=p-s);"scale"===t&&(o="auto");o=o||p,a=15<=(n=n||m)&&(15<=o||"auto"===o)&&(l.$.style.width=n+"px",l.$.style.height=o+"px",!0)},t),h("mouseup",function(){var e;for(;e=t.pop();)e.removeListener();E.removeClass(g),v.removeClass("cke_image_resizing"),a&&(f.setData({height:o,width:n}),y.fire("saveSnapshot"));a=!1},t),E.addClass(g),v.addClass("cke_image_resizing")}),f.on("data",function(){v["right"==f.data.align?"addClass":"removeClass"]("cke_image_resizer_left")}),f.parts.image.on("click",function(){var e,t,i,n,o=y.getSelection();o&&(!(e=o.getStartElement())||(t=e.findOne("img"))&&(i=e.getClientRect(),n=new CKEDITOR.dom.window(window).getScrollPosition(),i.left-=n.x,i.top+=n.y,i.direction=CKEDITOR.SELECTION_BOTTOM_TO_TOP,y.fire("editorInteraction",{nativeEvent:event,selectionData:{element:t,region:i}})))})}(this)},addClass:function(e){qt(this).addClass(e)},allowedContent:function(e){return{figcaption:!0,figure:{classes:"!"+e.config.image2_captionedClass},img:{attributes:"!src,alt,width,height"}}}(a),contentTransformations:[["img[width]: sizeToAttribute"]],data:function(){var e=this.features;if(this.data.hasCaption&&!a.filter.checkFeature(e.caption)&&(this.data.hasCaption=!1),"none"==this.data.align||a.filter.checkFeature(e.align)||(this.data.align="none"),this.data.link?this.parts.link||(this.parts.link=this.parts.image.getParent()):this.parts.link&&delete this.parts.link,this.parts.image.setAttributes({alt:this.data.alt,contenteditable:!this.parts.image.getAttribute("contenteditable")||this.parts.image.getAttribute("contenteditable"),"data-cke-saved-src":this.data.src,src:this.data.src}),this.oldData&&!this.oldData.hasCaption&&this.data.hasCaption)for(var t in this.data.classes)this.parts.image.removeClass(t);a.filter.checkFeature(e.dimension)&&function(e){var t=e.data,i={height:t.height,width:t.width},n=e.parts.image;for(var o in i)i[o]?n.setAttribute(o,i[o]):n.removeAttribute(o)}(this),this.oldData=CKEDITOR.tools.extend({},this.data)},downcast:function(e){var r=e.config.image2_alignClasses;return function(e){var t="a"==e.name?e.getFirst():e;delete t.attributes.contenteditable;var i,n,o=t.attributes,a=this.data.align;return this.inline||(i=e.getFirst("span"))&&i.replaceWith(i.getFirst({a:1,img:1})),a&&"none"!=a&&(n=CKEDITOR.tools.parseCssText(o.style||""),"center"==a&&"figure"==e.name?e=e.wrapWith(new CKEDITOR.htmlParser.element("div",r?{class:r[1]}:{style:"text-align:center"})):a in{left:1,right:1}&&(r?t.addClass(r[Xe[a]]):n.float=a),r||CKEDITOR.tools.isEmpty(n)||(o.style=CKEDITOR.tools.writeCssText(n))),e}}(a),draggable:!1,editables:{caption:{selector:"figcaption",allowedContent:"br em strong sub sup u s; a[!href,target]"}},features:function(e){var t=e.config.image2_alignClasses;return{align:{requiredContent:"img"+(t?"("+t[0]+")":"{float}")},caption:{requiredContent:"figcaption"},dimension:{requiredContent:"img[width,height]"}}}(a),getClasses:function(){var i=new RegExp("^("+[].concat(e,r).join("|")+")$");return function(){var e=this.repository.parseElementClasses(qt(this).getAttribute("class"));for(var t in e)i.test(t)&&delete e[t];return e}}(),getLabel:function(){return(this.data.alt||"")+" "+this.pathName},hasClass:function(e){return qt(this).hasClass(e)},parts:{caption:"figcaption",image:"img"},removeClass:function(e){qt(this).removeClass(e)},requiredContent:"img[src,alt]",styleableElements:"img figure",template:'<img alt="" src="" />',upcast:function(e){var s=function(n){var o=n.config.image2_captionedClass,a=n.config.image2_alignClasses,r={a:1,figure:1,img:1};return function(e){if(!(e.name in{div:1,p:1}))return!1;var t=e.children;if(1!==t.length)return!1;var i=t[0];if(!(i.name in r))return!1;if("p"==e.name){if(!jt(i))return!1}else if("figure"==i.name){if(!i.hasClass(o))return!1}else{if(n.enterMode==CKEDITOR.ENTER_P)return!1;if(!jt(i))return!1}return!(a?!e.hasClass(a[1]):"center"!=CKEDITOR.tools.parseCssText(e.attributes.style||"",!0)["text-align"])}}(e),l=e.config.image2_captionedClass;return function(e,t){var i,n,o=e.name;if(!e.attributes["data-cke-realelement"]&&(s(e)?("div"!=o||(n=e.getFirst("figure"))&&(e.replaceWith(n),e=n),t.align="center",i=e.getFirst("img")||e.getFirst("a").getFirst("img")):"figure"==o&&e.hasClass(l)?i=e.getFirst("img")||e.getFirst("a").getFirst("img"):jt(e)&&(i="a"==e.name?e.children[0]:e),i)){for(var a in{height:1,width:1}){var r=i.attributes[a];r&&r.match(Ze)&&delete i.attributes[a]}return e}}}(a)}}(e);e.widgets.add("image",t)},onLoad:function(){CKEDITOR.addCss(".cke_image_resizer_nwse-resize{cursor: nwse-resize;}.cke_image_resizer_ns-resize{cursor: ns-resize;}.cke_image_resizer_nwse-resize{cursor: nwse-resize;}.cke_image_resizer_ew-resize{cursor: ew-resize;}.cke_image_nocaption{line-height:0}.cke_image_resizer{display:none;position:absolute;width:10px;height:10px;bottom:-5px;right:-5px;background:#000;outline:1px solid #fff;line-height:0;cursor:nwse-resize;}.cke_image_resizer_wrapper{position:relative;display:inline-block;line-height:0;}.cke_widget_wrapper:hover .cke_image_resizer,.cke_image_resizer.cke_image_resizing{display:block}")},requires:"widget"}),CKEDITOR.plugins.image2={checkHasNaturalRatio:function(e){var t=e.$,i=this.getNatural(e);return Math.round(t.clientWidth/i.width*i.height)==t.clientHeight||Math.round(t.clientHeight/i.height*i.width)==t.clientWidth},getNatural:function(e){var t,i=e.$.naturalWidth?{height:e.$.naturalHeigh,width:e.$.naturalWidth}:((t=new Image).src=e.getAttribute("src"),{height:t.heigh,width:t.width});return i}}),CKEDITOR.config.image2_captionedClass="image",CKEDITOR.plugins.get("ae_dragresize_ie11")||(Ue='<img alt="" src="" />',We=new CKEDITOR.template('<figure class="{captionedClass}">'+Ue+"<figcaption>{captionPlaceholder}</figcaption></figure>"),Ve={left:0,center:1,right:2},Ge=/^\s*(\d+\%)\s*$/i,CKEDITOR.plugins.add("ae_dragresize_ie11",{requires:"widget",onLoad:function(){CKEDITOR.addCss(".cke_image_nocaption{line-height:0}.cke_editable.cke_image_ne, .cke_editable.cke_image_ne *{cursor:ne-resize !important}.cke_editable.cke_image_nw, .cke_editable.cke_image_nw *{cursor:nw-resize !important}.cke_editable.cke_image_sw, .cke_editable.cke_image_sw *{cursor:sw-resize !important}.cke_editable.cke_image_se, .cke_editable.cke_image_se *{cursor:se-resize !important}.cke_image_resizer{display:none;position:absolute;width:10px;height:10px;background:#000;outline:1px solid #fff;line-height:0;cursor:se-resize;}.cke_image_resizer_wrapper{position:relative;display:inline-block;line-height:0;}.cke_image_resizer.cke_image_resizer_ne{cursor:ne-resize;left:auto;right:-5px;top:-5px;}.cke_image_resizer.cke_image_resizer_nw{cursor:nw-resize;left:-5px;right:auto;top:-5px;}.cke_image_resizer.cke_image_resizer_se{bottom:-5px;cursor:se-resize;left:auto;right:-5px;}.cke_image_resizer.cke_image_resizer_sw{bottom:-5px;cursor:sw-resize;left:-5px;right:auto;}.cke_widget_wrapper:hover .cke_image_resizer,.cke_image_resizing>.cke_image_resizer{display:block}.cke_widget_wrapper>a{display:inline-block}")},init:function(r){r.config;var s,l,e,t=(l=(s=r).config.ae_dragresize_ie11_alignClasses,e=s.config.ae_dragresize_ie11_captionedClass,{allowedContent:function(e){var t=e.config.ae_dragresize_ie11_alignClasses,i={div:{match:Mt(e)},p:{match:Mt(e)},img:{attributes:"!src,alt,width,height"},figure:{classes:"!"+e.config.ae_dragresize_ie11_captionedClass},figcaption:!0};return t?(i.div.classes=t[1],i.p.classes=i.div.classes,i.img.classes=t[0]+","+t[2],i.figure.classes+=","+i.img.classes):(i.div.styles="text-align",i.p.styles="text-align",i.img.styles="float",i.figure.styles="float,display"),i}(s),requiredContent:"img[src,alt]",features:function(e){var t=e.config.ae_dragresize_ie11_alignClasses;return{dimension:{requiredContent:"img[width,height]"},align:{requiredContent:"img"+(t?"("+t[0]+")":"{float}")},caption:{requiredContent:"figcaption"}}}(s),styleableElements:"img figure",contentTransformations:[["img[width]: sizeToAttribute"]],editables:{caption:{selector:"figcaption",allowedContent:"br em strong sub sup u s; a[!href,target]"}},parts:{image:"img",caption:"figcaption"},template:Ue,data:function(){var e=this.features;if(this.data.hasCaption&&!s.filter.checkFeature(e.caption)&&(this.data.hasCaption=!1),"none"==this.data.align||s.filter.checkFeature(e.align)||(this.data.align="none"),this.shiftState({widget:this,element:this.element,oldData:this.oldData,newData:this.data,deflate:i,inflate:n}),this.data.link?this.parts.link||(this.parts.link=this.parts.image.getParent()):this.parts.link&&delete this.parts.link,this.parts.image.setAttributes({src:this.data.src,"data-cke-saved-src":this.data.src,alt:this.data.alt}),this.oldData&&!this.oldData.hasCaption&&this.data.hasCaption)for(var t in this.data.classes)this.parts.image.removeClass(t);s.filter.checkFeature(e.dimension)&&function(e){var t=e.data,i={width:t.width,height:t.height},n=e.parts.image;for(var o in i)i[o]?n.setAttribute(o,i[o]):n.removeAttribute(o)}(this),this.oldData=CKEDITOR.tools.extend({},this.data)},init:function(){var e,t,i=CKEDITOR.plugins.ae_dragresize_ie11,n=this.parts.image,o={hasCaption:!!this.parts.caption,src:n.getAttribute("src"),alt:n.getAttribute("alt")||"",width:n.getAttribute("width")||"",height:n.getAttribute("height")||"",lock:!this.ready||i.checkHasNaturalRatio(n)},a=n.getAscendant("a");a&&this.wrapper.contains(a)&&(this.parts.link=a),o.align||(e=o.hasCaption?this.element:n,l?(e.hasClass(l[0])?o.align="left":e.hasClass(l[2])&&(o.align="right"),o.align?e.removeClass(l[Ve[o.align]]):o.align="none"):(o.align=e.getStyle("float")||"none",e.removeStyle("float"))),s.plugins.link&&this.parts.link&&(o.link=i.getLinkAttributesParser()(s,this.parts.link),(t=o.link.advanced)&&t.advCSSClasses&&(t.advCSSClasses=CKEDITOR.tools.trim(t.advCSSClasses.replace(/cke_\S+/,"")))),this.wrapper[(o.hasCaption?"remove":"add")+"Class"]("cke_image_nocaption"),this.setData(o),s.filter.checkFeature(this.features.dimension)&&!0!==s.config.ae_dragresize_ie11_disableResizer&&function(C){var e,t,i,_=C.editor,T=_.editable(),A=_.document,I=C.resizer=A.createElement("span"),n=A.createElement("span"),o=A.createElement("span"),a=A.createElement("span"),r=A.createElement("span");n.addClass("cke_image_resizer"),n.addClass("cke_image_resizer_ne"),o.addClass("cke_image_resizer"),o.addClass("cke_image_resizer_nw"),a.addClass("cke_image_resizer"),a.addClass("cke_image_resizer_se"),r.addClass("cke_image_resizer"),r.addClass("cke_image_resizer_sw"),I.append(n),I.append(o),I.append(a),I.append(r),I.append(new CKEDITOR.dom.text("​",A)),C.inline?C.wrapper.append(I):(e=C.parts.link||C.parts.image,t=e.getParent(),(i=A.createElement("span")).addClass("cke_image_resizer_wrapper"),i.append(e),i.append(I),C.element.append(i,!0),t.is("span")&&t.remove()),I.on("mousedown",function(e){var t,i,n,o,a,r,s,l,d=C.parts.image,c=e.data.$.screenX,u=e.data.$.screenY,m=d.$.clientWidth,p=d.$.clientHeight,g=m/p,h=[],f=e.data.getTarget();f.hasClass("cke_image_resizer_ne")?i=t=1:f.hasClass("cke_image_resizer_nw")?(t=-1,i=1):f.hasClass("cke_image_resizer_se")?i=-(t=1):f.hasClass("cke_image_resizer_sw")&&(i=t=-1);var y="cke_image_"+(~i?"n":"s")+(~t?"e":"w");function E(e,t,i){var n=CKEDITOR.document,o=[];if(A.equals(n)||o.push(n.on(e,t)),o.push(A.on(e,t)),i)for(var a=o.length;a--;)i.push(o.pop())}function b(){s=m+t*n,r=Math.round(s/g)}function v(){r=p+i*o,s=Math.round(r*g)}_.fire("saveSnapshot"),E("mousemove",function(e){a=e.data.$,n=a.screenX-c,o=u-a.screenY,moveRatio=Math.abs(n/o),(1==t?n<=0?v:b:n<=0?b:v)(),l=15<=s&&15<=r&&(d.$.style.width=s+"px",d.$.style.height=r+"px",!0)},h),E("mouseup",function(){for(var e;e=h.pop();)e.removeListener();T.removeClass(y),I.removeClass("cke_image_resizing"),l&&(C.setData({height:r,width:s}),_.fire("saveSnapshot")),l=!1},h),T.addClass(y),I.addClass("cke_image_resizing")})}(this);var r=this.dragHandlerContainer.$.style;r.setAttribute("backgroundColor","rgba(255, 255, 255, 1"),r.setAttribute("opacity","1"),this.shiftState=i.stateShifter(this.editor),this.on("contextMenu",function(e){e.data.image=CKEDITOR.TRISTATE_OFF,(this.parts.link||this.wrapper.getAscendant("a"))&&(e.data.link=e.data.unlink=CKEDITOR.TRISTATE_OFF)})},addClass:function(e){$t(this).addClass(e)},hasClass:function(e){return $t(this).hasClass(e)},removeClass:function(e){$t(this).removeClass(e)},getClasses:function(){var i=new RegExp("^("+[].concat(e,l).join("|")+")$");return function(){var e=this.repository.parseElementClasses($t(this).getAttribute("class"));for(var t in e)i.test(t)&&delete e[t];return e}}(),upcast:function(e){var s=Mt(e),l=e.config.ae_dragresize_ie11_captionedClass;return function(e,t){var i,n,o=e.name;if(!e.attributes["data-cke-realelement"]&&(s(e)?("div"!=o||(n=e.getFirst("figure"))&&(e.replaceWith(n),e=n),t.align="center",i=e.getFirst("img")||e.getFirst("a").getFirst("img")):"figure"==o&&e.hasClass(l)?i=e.getFirst("img")||e.getFirst("a").getFirst("img"):zt(e)&&(i="a"==e.name?e.children[0]:e),i)){for(var a in{width:1,height:1}){var r=i.attributes[a];r&&r.match(Ge)&&delete i.attributes[a]}return e}}}(s),downcast:function(e){var r=e.config.ae_dragresize_ie11_alignClasses;return function(e){var t,i,n="a"==e.name?e.getFirst():e,o=n.attributes,a=this.data.align;return this.inline||(t=e.getFirst("span"))&&t.replaceWith(t.getFirst({img:1,a:1})),a&&"none"!=a&&(i=CKEDITOR.tools.parseCssText(o.style||""),"center"==a&&"figure"==e.name?e=e.wrapWith(new CKEDITOR.htmlParser.element("div",r?{class:r[1]}:{style:"text-align:center"})):a in{left:1,right:1}&&(r?n.addClass(r[Ve[a]]):i.float=a),r||CKEDITOR.tools.isEmpty(i)||(o.style=CKEDITOR.tools.writeCssText(i)+";")),e}}(s),getLabel:function(){var e=(this.data.alt||"")+" "+this.pathName;return this.editor.lang.widget.label.replace(/%1/,e)}});function i(){this.deflated||(s.widgets.focused==this.widget&&(this.focused=!0),s.widgets.destroy(this.widget),this.deflated=!0)}function n(){var e,t=s.editable(),i=s.document;this.deflated?(this.widget=s.widgets.initOn(this.element,"image",this.widget.data),this.widget.inline&&!new CKEDITOR.dom.elementPath(this.widget.wrapper,t).block&&((e=i.createElement(s.activeEnterMode==CKEDITOR.ENTER_P?"p":"div")).replace(this.widget.wrapper),this.widget.wrapper.move(e)),this.focused&&(this.widget.focus(),delete this.focused),delete this.deflated):function(e,t){var i=e.wrapper,n=e.data.align,o=e.data.hasCaption;if(t){for(var a=3;a--;)i.removeClass(t[a]);"center"==n?o&&i.addClass(t[1]):"none"!=n&&i.addClass(t[Ve[n]])}else{"center"==n?(o?i.setStyle("text-align","center"):i.removeStyle("text-align"),i.removeStyle("float")):("none"==n?i.removeStyle("float"):i.setStyle("float",n),i.removeStyle("text-align"));var r,s=i.$.querySelector("img"),l=s.getAttribute("style");l&&(r=/(width:.+?;)/g.exec(l)[0],s.setAttribute("style",r))}}(this.widget,l)}r.widgets.add("image",t),r.on("selectionChange",function(e){var t,i,n,o,a=r.getSelection();a&&(!(t=a.getSelectedElement())||(i=t.findOne("img"))&&(n=t.getClientRect(),o=new CKEDITOR.dom.window(window).getScrollPosition(),n.left-=o.x,n.top+=o.y,n.direction=CKEDITOR.SELECTION_BOTTOM_TO_TOP,r.fire("editorInteraction",{nativeEvent:{},selectionData:{element:i,region:n}})))})},afterInit:function(e){var o,i,a,t=(o=e,a=[],function(n){var e=o.getCommand("justify"+n);e&&(a.push(function(){e.refresh(o,o.elementPath())}),n in{right:1,left:1,center:1}&&e.on("exec",function(e){var t=Ht(o);if(t){t.data.align===n?(Ye(t,n),delete t.data.align):t.setData("align",n);for(var i=a.length;i--;)a[i]();e.cancel()}}),e.on("refresh",function(e){var t=Ht(o);t&&(void 0===i&&(i=o.filter.checkFeature(o.widgets.registered.image.features.align)),i?this.setState(t.data.align==n?CKEDITOR.TRISTATE_ON:n in{right:1,left:1,center:1}?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED):this.setState(CKEDITOR.TRISTATE_DISABLED),e.cancel())}))});for(var n in{left:1,right:1,center:1,block:1})t(n)}}),CKEDITOR.plugins.ae_dragresize_ie11={stateShifter:function(p){var g=p.document,r=p.config.ae_dragresize_ie11_alignClasses,a=p.config.ae_dragresize_ie11_captionedClass,n=p.editable(),o=["hasCaption","align","link"],s={align:function(e,t,i){var n,o,a=e.element;e.changed.align||"auto"===a.$.style.marginLeft&&"auto"===a.$.style.marginRight?e.newData.hasCaption||(("center"==i||"auto"===a.$.style.marginLeft&&"auto"===a.$.style.marginRight)&&(e.deflate(),e.element=l(p,a)),e.changed.hasCaption||"center"!=t||"center"==i||(e.deflate(),e.element=((o=(n=a).findOne("a,img")).replace(n),o))):"center"==i&&e.changed.hasCaption&&!e.newData.hasCaption&&(e.deflate(),e.element=l(p,a)),!r&&a.is("figure")&&("center"==i?a.setStyle("display","inline-block"):a.removeStyle("display"))},hasCaption:function(e,t,i){var n,o;e.changed.hasCaption&&(o=e.element.is({img:1,a:1})?e.element:e.element.findOne("a,img"),e.deflate(),i?(d(n=CKEDITOR.dom.element.createFromHtml(We.output({captionedClass:a,captionPlaceholder:p.lang.ae_dragresize_ie11.captionPlaceholder}),g),e.element),o.replace(n.findOne("img")),e.element=n):(o.replace(e.element),e.element=o))},link:function(e,t,i){var n,o,a,r,s,l,d,c,u,m;e.changed.link&&(n=e.element.is("img")?e.element:e.element.findOne("img"),o=e.element.is("a")?e.element:e.element.findOne("a"),(a=e.element.is("a")&&!i||e.element.is("img")&&i)&&e.deflate(),i?(t||(l=n,d=e.newData.link,(c=g.createElement("a",{attributes:{href:d.url}})).replace(l),l.move(c),r=c),s=CKEDITOR.plugins.ae_dragresize_ie11.getLinkAttributesGetter()(p,i),CKEDITOR.tools.isEmpty(s.set)||(r||o).setAttributes(s.set),s.removed.length&&(r||o).removeAttributes(s.removed)):((m=(u=o).findOne("img")).replace(u),r=m),a&&(e.element=r))}};function l(e,t){var i={};r?i.attributes={class:r[1]}:i.styles={"text-align":"center"};var n=g.createElement(e.activeEnterMode==CKEDITOR.ENTER_P?"p":"div",i);return d(n,t),t.move(n),n}function d(e,t){var i;t.getParent()?((i=p.createRange()).moveToPosition(t,CKEDITOR.POSITION_BEFORE_START),t.remove(),n.insertElementIntoRange(e,i)):e.replace(t)}return function(e){var t,i;for(e.changed={},i=0;i<o.length;i++)t=o[i],e.changed[t]=!!e.oldData&&e.oldData[t]!==e.newData[t];for(i=0;i<o.length;i++)s[t=o[i]](e,e.oldData?e.oldData[t]:null,e.newData[t]);e.inflate()}},checkHasNaturalRatio:function(e){var t=e.$,i=this.getNatural(e);return Math.round(t.clientWidth/i.width*i.height)==t.clientHeight||Math.round(t.clientHeight/i.height*i.width)==t.clientWidth},getNatural:function(e){var t,i=e.$.naturalWidth?{width:e.$.naturalWidth,height:e.$.naturalHeight}:((t=new Image).src=e.getAttribute("src"),{width:t.width,height:t.height});return i},getLinkAttributesGetter:function(){return CKEDITOR.plugins.link.getLinkAttributes},getLinkAttributesParser:function(){return CKEDITOR.plugins.link.parseLinkAttributes}},Ye=function(e,t){"left"===t||"right"===t?e.wrapper.removeStyle("float"):"center"===t&&(e.editor.execCommand("justifyleft"),e.editor.execCommand("justifyleft"))}),CKEDITOR.config.ae_dragresize_ie11_captionedClass="image",CKEDITOR.plugins.get("ae_embed")||(je=/^https?/,qe=/<a href=/,CKEDITOR.DEFAULT_AE_EMBED_URL_TPL="http://alloy.iframe.ly/api/oembed?url={url}&callback={callback}",CKEDITOR.DEFAULT_AE_EMBED_WIDGET_TPL='<div data-ae-embed-url="{url}"></div>',CKEDITOR.DEFAULT_AE_EMBED_DEFAULT_LINK_TPL='<a href="{url}">{url}</a>',CKEDITOR.plugins.add("ae_embed",{requires:"widget",init:function(r){function i(e,t){if("div"===e.name&&e.attributes["data-ae-embed-url"])return t.url=e.attributes["data-ae-embed-url"],!0}var n=new CKEDITOR.template(r.config.embedUrlTemplate||CKEDITOR.DEFAULT_AE_EMBED_URL_TPL),o=new CKEDITOR.template(r.config.embedWidgetTpl||CKEDITOR.DEFAULT_AE_EMBED_WIDGET_TPL),a=new CKEDITOR.template(r.config.embedLinkDefaultTpl||CKEDITOR.DEFAULT_AE_EMBED_DEFAULT_LINK_TPL);r.addCommand("embedUrl",{exec:function(e,t){e.insertHtml(o.output({url:t.url}))}}),r.widgets.add("ae_embed",{mask:!0,requiredContent:"div[data-ae-embed-url]",data:function(e){var t=this,i=e.data.url;i&&CKEDITOR.tools.jsonp(n,{url:encodeURIComponent(i)},function(e){!e.html||qe.test(e.html)?t.createATag(i):t.element.setHtml(e.html)},function(e){t.createATag(i)})},createATag:function(e){this.editor.execCommand("undo");this.editor.getSelection().getSelectedElement();var t=a.output({url:e});this.editor.insertHtml(t),this.editor.fire("actionPerformed",this)},upcast:function(e,t){return(r.config.embedWidgetUpcastFn||i)(e,t)}}),r.once("contentDom",function(){r.on("paste",function(e){var t=e.data.dataValue;je.test(t)&&(e.stop(),r.execCommand("embedUrl",{url:e.data.dataValue}))})}),r.on("selectionChange",function(e){var t,i,n,o,a=r.getSelection();a&&(!(t=a.getSelectedElement())||(i=t.findOne('[data-widget="ae_embed"]'))&&(n=t.getClientRect(),o=new CKEDITOR.dom.window(window).getScrollPosition(),n.left-=o.x,n.top+=o.y,n.direction=CKEDITOR.SELECTION_BOTTOM_TO_TOP,r.fire("editorInteraction",{nativeEvent:{},selectionData:{element:i,region:n}})))}),r.filter.addElementCallback(function(e){if("data-ae-embed-url"in e.attributes)return CKEDITOR.FILTER_SKIP_TREE})}})),CKEDITOR.plugins.get("ae_imagealignment")||(Me=[Pe="left",Fe="right",Le="center"],ze=[{name:"display",value:"block"},{name:"margin-left",value:"auto"},{name:"margin-right",value:"auto"}],He=function(i){var e,t,n=i.getStyle("float");return n&&"inherit"!==n&&"none"!==n||(n=i.getAttribute("align")),n||(e=ze.every(function(t){var e=i.getStyle(t.name)===t.value;return!e&&t.vendorPrefixes&&(e=t.vendorPrefixes.some(function(e){return i.getStyle(e+t.name)===t.value})),e}),n||(t=i.$.parentNode).style.textAlign==Le&&(ze.forEach(function(t){i.setStyle(t.name,t.value),t.vendorPrefixes&&t.vendorPrefixes.forEach(function(e){i.setStyle(e+t.name,t.value)})}),e=!0,t.style.textAlign=""),n=e?Le:null),n},$e=function(i,e){var t;e===Pe||e===Fe?(i.removeStyle("float"),e===He(i)&&i.removeAttribute("align")):e===Le&&(ze.forEach(function(t){i.removeStyle(t.name),t.vendorPrefixes&&t.vendorPrefixes.forEach(function(e){i.removeStyle(e+t.name)})}),(t=i.$.parentNode).style.textAlign==Le&&(t.style.textAlign=""))},CKEDITOR.plugins.add("ae_imagealignment",{afterInit:function(r){var s=this;Me.forEach(function(a){var e=r.getCommand("justify"+a);e&&(e.on("exec",function(e){var t,i,n,o=r.getSelectionData();o&&AlloyEditor.SelectionTest.image({data:{selectionData:o}})&&(t=o.element,He(t)===a?$e(t,a):(n=a,$e(i=t,He(i)),n===Pe||n===Fe?i.setStyle("float",n):n===Le&&ze.forEach(function(t){i.setStyle(t.name,t.value),t.vendorPrefixes&&t.vendorPrefixes.forEach(function(e){i.setStyle(e+t.name,t.value)})})),e.cancel(),s.refreshCommands(r,new CKEDITOR.dom.elementPath(t)))}),e.on("refresh",function(e){var t,i={element:e.data.path.lastElement};AlloyEditor.SelectionTest.image({data:{selectionData:i}})&&(t=He(i.element),this.setState(t===a?CKEDITOR.TRISTATE_ON:CKEDITOR.TRISTATE_OFF),e.cancel())}))})},refreshCommands:function(i,n){Me.forEach(function(e){var t=i.getCommand("justify"+e);t&&t.refresh(i,n)})}})),CKEDITOR.plugins.get("ae_pasteimages")||CKEDITOR.plugins.add("ae_pasteimages",{init:function(t){t.once("contentDom",function(){var e=t.editable();e.attachListener(e,"paste",this._onPaste,this,{editor:t})}.bind(this))},_onPaste:function(e){var t,n,i,o;e.data.$.clipboardData&&(t=e.data.$.clipboardData.items[0],n=e.listenerData.editor,0===t.type.indexOf("image")&&(i=new FileReader,o=t.getAsFile(),i.onload=function(e){var t,i;n.fire("beforeImageAdd",{imageFiles:o})&&(t=CKEDITOR.dom.element.createFromHtml('<img src="'+e.target.result+'">'),n.insertElement(t),i={el:t,file:o},n.fire("imageAdd",i))}.bind(this),i.readAsDataURL(o)))}}),CKEDITOR.plugins.get("ae_placeholder")||(Be=CKEDITOR.env.needsBrFiller?"<br>":"",Ke={1:["<p>"+Be+"</p>"],2:[""," ",Be],3:["<div>"+Be+"</div>"]},CKEDITOR.plugins.add("ae_placeholder",{init:function(e){e.on("blur",this._checkEmptyData,this),e.on("change",this._checkEmptyData,this),e.on("focus",this._removePlaceholderClass,this),e.once("contentDom",this._checkEmptyData,this)},_checkEmptyData:function(e){var t=e.editor,i=t.editable(),n=i.$.innerHTML.trim();Ke[t.config.enterMode].some(function(e){return n===e})?i.addClass(t.config.placeholderClass):i.removeClass(t.config.placeholderClass)},_removePlaceholderClass:function(e){var t=e.editor;new CKEDITOR.dom.element(t.element.$).removeClass(t.config.placeholderClass)}})),CKEDITOR.plugins.get("ae_selectionkeystrokes")||CKEDITOR.plugins.add("ae_selectionkeystrokes",{requires:"ae_selectionregion",init:function(n){n.config.selectionKeystrokes&&n.config.selectionKeystrokes.forEach(function(t){var e=new CKEDITOR.command(n,{exec:function(e){e.fire("editorInteraction",{manualSelection:t.selection,nativeEvent:{},selectionData:e.getSelectionData()})}}),i="selectionKeystroke"+t.selection;n.addCommand(i,e),n.setKeystroke(t.keys,i)})}}),CKEDITOR.plugins.get("ae_tableresize")||(Ne=CKEDITOR.tools.cssLength,CKEDITOR.plugins.add("ae_tableresize",{requires:"ae_tabletools",init:function(s){s.on("contentDom",function(){var r,e=s.editable();e.attachListener(e.isInline()?e:s.document,"mousemove",function(e){var t=(e=e.data).getTarget();if(t.type===CKEDITOR.NODE_ELEMENT){var i,n,o,a=e.getPageOffset().x;if(r){if(r.isResizing())return r.move(a),void Lt(e);r.destroy(),r=null}(t.is("table")||t.getAscendant("tbody",1))&&(o=t.getAscendant("table",1),s.editable().contains(o)&&((i=o.getCustomData("_cke_table_pillars"))||(o.setCustomData("_cke_table_pillars",i=Kt(o)),o.on("mouseout",Ft),o.on("mousedown",Ft)),(n=function(e,t){for(var i=0,n=e.length;i<n;i++){var o=e[i];if(t>=o.x&&t<=o.x+o.width)return o}return null}(i,a))&&(r=new Pt(s,n))))}})})}})),CKEDITOR.plugins.get("ae_tabletools")||(Re=/^(?:td|th)$/,CKEDITOR.plugins.add("ae_tabletools",{init:function(n){n.lang.table;function e(e){return CKEDITOR.tools.extend(e||{},{contextSensitive:1,refresh:function(e,t){this.setState(t.contains({td:1,th:1},1)?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED)}})}function t(e,t){var i=n.getCommand(e);i||(i=n.addCommand(e,t),n.addFeature(i))}t("rowDelete",e({requiredContent:"table",exec:function(e){St(function e(t){if(t instanceof CKEDITOR.dom.selection){for(var i=_t(t),n=i[0].getAscendant("table"),o=CKEDITOR.tools.buildTableMap(n),a=i[0].getParent().$.rowIndex,r=i[i.length-1],s=r.getParent().$.rowIndex+r.$.rowSpan-1,l=[],d=a;d<=s;d++){for(var c=o[d],u=new CKEDITOR.dom.element(n.$.rows[d]),m=0;m<c.length;m++){var p,g=new CKEDITOR.dom.element(c[m]),h=g.getParent().$.rowIndex;1==g.$.rowSpan?g.remove():(--g.$.rowSpan,h==d&&((p=o[d+1])[m-1]?g.insertAfter(new CKEDITOR.dom.element(p[m-1])):new CKEDITOR.dom.element(n.$.rows[d+1]).append(g,1))),m+=g.$.colSpan-1}l.push(u)}for(var f=n.$.rows,y=new CKEDITOR.dom.element(f[1+s]||(0<a?f[a-1]:null)||n.$.parentNode),d=l.length;0<=d;d--)e(l[d]);return y}return t instanceof CKEDITOR.dom.element&&(1==(n=t.getAscendant("table")).$.rows.length?n.remove():t.remove()),null}(e.getSelection()))}})),t("rowInsertBefore",e({requiredContent:"table",exec:function(e){Tt(e.getSelection(),!0)}})),t("rowInsertAfter",e({requiredContent:"table",exec:function(e){Tt(e.getSelection())}})),t("columnDelete",e({requiredContent:"table",exec:function(e){var t=function(e){for(var t,i,n=_t(e),o=n[0],a=n[n.length-1],r=o.getAscendant("table"),s=CKEDITOR.tools.buildTableMap(r),l=[],d=0,c=s.length;d<c;d++)for(var u=0,m=s[d].length;u<m;u++)s[d][u]==o.$&&(t=u),s[d][u]==a.$&&(i=u);for(d=t;d<=i;d++)for(u=0;u<s.length;u++){var p=s[u],g=new CKEDITOR.dom.element(r.$.rows[u]),h=new CKEDITOR.dom.element(p[d]);h.$&&(1==h.$.colSpan?h.remove():--h.$.colSpan,u+=h.$.rowSpan-1,g.$.cells.length||l.push(g))}var f=r.$.rows[0]&&r.$.rows[0].cells,y=new CKEDITOR.dom.element(f[t]||(t?f[t-1]:r.$.parentNode));return l.length==c&&r.remove(),y}(e.getSelection());t&&St(t,!0)}})),t("columnInsertBefore",e({requiredContent:"table",exec:function(e){kt(e.getSelection(),!0)}})),t("columnInsertAfter",e({requiredContent:"table",exec:function(e){kt(e.getSelection())}})),t("cellDelete",e({requiredContent:"table",exec:function(e){Dt(e.getSelection())}})),t("cellMerge",e({allowedContent:"td[colspan,rowspan]",requiredContent:"td[colspan,rowspan]",exec:function(e){St(xt(e.getSelection()),!0)}})),t("cellMergeRight",e({allowedContent:"td[colspan]",requiredContent:"td[colspan]",exec:function(e){St(xt(e.getSelection(),"right"),!0)}})),t("cellMergeDown",e({allowedContent:"td[rowspan]",requiredContent:"td[rowspan]",exec:function(e){St(xt(e.getSelection(),"down"),!0)}})),t("cellVerticalSplit",e({allowedContent:"td[rowspan]",requiredContent:"td[rowspan]",exec:function(e){St(function(e,t){var i=_t(e);if(1<i.length)return!1;if(t)return!0;var n,o,a,r=i[0],s=r.getParent(),l=s.getAscendant("table"),d=CKEDITOR.tools.buildTableMap(l),c=s.$.rowIndex,u=Ot(d,c,r),m=r.$.rowSpan;if(1<m){n=Math.ceil(m/2),o=Math.floor(m/2),a=c+n;for(var p,g=new CKEDITOR.dom.element(l.$.rows[a]),h=Ot(d,a),f=r.clone(),y=0;y<h.length;y++){if((p=h[y]).parentNode==g.$&&u<y){f.insertBefore(new CKEDITOR.dom.element(p));break}p=null}p||g.append(f)}else{o=n=1,(g=s.clone()).insertAfter(s),g.append(f=r.clone());for(var E=Ot(d,c),b=0;b<E.length;b++)E[b].rowSpan++}return f.appendBogus(),r.$.rowSpan=n,f.$.rowSpan=o,1==n&&r.removeAttribute("rowSpan"),1==o&&f.removeAttribute("rowSpan"),f}(e.getSelection()))}})),t("cellHorizontalSplit",e({allowedContent:"td[colspan]",requiredContent:"td[colspan]",exec:function(e){St(Rt(e.getSelection()))}})),t("cellInsertBefore",e({requiredContent:"table",exec:function(e){wt(e.getSelection(),!0)}})),t("cellInsertAfter",e({requiredContent:"table",exec:function(e){wt(e.getSelection())}}))},getSelectedCells:_t})),CKEDITOR.tools.buildTableMap=function(e){for(var t=e.$.rows,i=-1,n=[],o=0;o<t.length;o++){n[++i]||(n[i]=[]);for(var a=-1,r=0;r<t[o].cells.length;r++){var s=t[o].cells[r];for(a++;n[i][a];)a++;for(var l=isNaN(s.colSpan)?1:s.colSpan,d=isNaN(s.rowSpan)?1:s.rowSpan,c=0;c<d;c++){n[i+c]||(n[i+c]=[]);for(var u=0;u<l;u++)n[i+c][a+u]=t[o].cells[r]}a+=l-1}}return n},CKEDITOR.plugins.get("ae_buttonbridge")||(Oe={toFeature:function(){}},xe={},CKEDITOR.plugins.get("button")||(CKEDITOR.UI_BUTTON="button",CKEDITOR.plugins.add("button",{})),CKEDITOR.plugins.add("ae_buttonbridge",{requires:["ae_uibridge"],beforeInit:function(e){e.ui.addButton=function(e,t){this.add(e,CKEDITOR.UI_BUTTON,t)},e.ui.addHandler(CKEDITOR.UI_BUTTON,{add:Ct,create:function(e){return new(Ct("buttonBridge"+(1e9*Math.random()>>>0),e))}})}})),CKEDITOR.plugins.get("ae_menubuttonbridge")||(De={toFeature:function(){}},Se={},CKEDITOR.plugins.get("menubutton")||(CKEDITOR.UI_MENU_BUTTON="menubutton",CKEDITOR.plugins.add("menubutton",{})),CKEDITOR.plugins.add("ae_menubuttonbridge",{requires:["ae_uibridge","ae_menubridge"],beforeInit:function(e){e.ui.addMenuButton=function(e,t){this.add(e,CKEDITOR.UI_MENUBUTTON,t)},e.ui.addHandler(CKEDITOR.UI_MENUBUTTON,{add:vt,create:function(e){return new(vt("buttonBridge"+(1e9*Math.random()>>>0),e))}})}})),CKEDITOR.plugins.get("ae_menubridge")||CKEDITOR.plugins.add("ae_menubridge",{beforeInit:function(e){if(!CKEDITOR.plugins.get("menu")){for(var t=[],i=e._.menuGroups={},n=e._.menuItems={},o=0;o<t.length;o++)i[t[o]]=o+1;e.addMenuGroup=function(e,t){i[e]=t||100},e.addMenuItem=function(e,t){i[t.group]&&(n[e]={name:e,definition:t})},e.addMenuItems=function(e){for(var t in e)this.addMenuItem(t,e[t])},e.getMenuItem=function(e){return n[e]},e.removeMenuItem=function(e){delete n[e]}}}}),CKEDITOR.plugins.get("ae_panelmenubuttonbridge")||(Ie={createPanel:function(){}},ke={},we=function(s,e,t){var i=AlloyEditor.Buttons[s];return ke[t.name]=ke[t.name]||{},ke[t.name][s]=ke[t.name][s]||e,i||(i=gt(CKEDITOR.tools.merge(Ie,{displayName:s,propTypes:{editor:pt.object.isRequired},statics:{key:s},render:function(){var e,t,i=this.props.editor.get("nativeEditor"),n=ke[i.name][s].name||ke[i.name][s].command||s,o="ae-icon-"+n,a={},r=CKEDITOR.skin.getIconStyle(n);return r&&(e=r.split(";"),a.backgroundImage=e[0].substring(e[0].indexOf(":")+1),a.backgroundPosition=e[1].substring(e[1].indexOf(":")+1),a.backgroundSize=e[2].substring(e[2].indexOf(":")+1)),this.props.expanded&&(t=this._getPanel()),d.createElement("div",{className:"ae-container ae-has-dropdown"},d.createElement("button",{"aria-expanded":this.props.expanded,"aria-label":ke[i.name][s].label,className:"ae-button ae-button-bridge",onClick:this.props.toggleDropdown,role:"combobox",tabIndex:this.props.tabIndex,title:ke[i.name][s].label},d.createElement("span",{className:o,style:a})),t)},_getPanel:function(){var e=this.props.editor.get("nativeEditor"),t=ke[e.name][s].onBlock,i={hide:this.props.toggleDropdown,show:this.props.toggleDropdown},n=new CKEDITOR.dom.element("div"),o={element:n,keys:{}};return t&&t.call(this,i,o),d.createElement(AlloyEditor.ButtonDropdown,{onDismiss:this.props.toggleDropdown},d.createElement("div",{className:n.getAttribute("class"),dangerouslySetInnerHTML:{__html:n.getHtml()}}))}})),AlloyEditor.Buttons[s]=i),i},CKEDITOR.plugins.get("panelmenubutton")||(CKEDITOR.UI_PANELBUTTON="panelmenubutton",CKEDITOR.plugins.add("panelmenubutton",{})),CKEDITOR.plugins.get("panelbutton")||(CKEDITOR.UI_PANELBUTTON="panelbutton",CKEDITOR.plugins.add("panelbutton",{})),CKEDITOR.plugins.add("ae_panelmenubuttonbridge",{requires:["ae_uibridge"],beforeInit:function(e){e.ui.addPanelMenuButton=function(e,t){this.add(e,CKEDITOR.UI_PANELBUTTON,t)},e.ui.addHandler(CKEDITOR.UI_PANELBUTTON,{add:we,create:function(e){var t="panelMenuButtonBridge"+(1e9*Math.random()>>>0);return new(we(t,e))}})}})),CKEDITOR.plugins.get("ae_richcombobridge")||(_e={commit:bt,createPanel:bt,disable:bt,enable:bt,getState:bt,hideGroup:bt,hideItem:bt,mark:bt,showAll:bt,startGroup:bt,unmarkAll:bt},Te={},Ae=function(o,n,e){var t=AlloyEditor.Buttons[o];return Te[e.name]=Te[e.name]||{},Te[e.name][o]=Te[e.name][o]||n,Te[e.name][o].currentValue=void 0,t||(t=gt(CKEDITOR.tools.merge(_e,{displayName:o,propTypes:{editor:pt.object.isRequired},statics:{key:o},add:function(e,t,i){this._items.push({preview:t,title:i,value:e})},componentWillMount:function(){var e=this.props.editor.get("nativeEditor"),t=Te[e.name][o];this._items=[],this.setValue=this._setValue,t.init&&t.init.call(this),t.onRender&&t.onRender.call(this)},componentWillUnmount:function(){this._cacheValue(this.state.value),this.setValue=this._cacheValue},getInitialState:function(){return{value:Te[e.name][o].currentValue}},getValue:function(){return this.state.value},render:function(){var e,t=this.props.editor.get("nativeEditor"),i=Te[t.name][o].currentValue||n.label;return this.props.expanded&&(e=this._getItemsList()),d.createElement("div",{className:"ae-container-dropdown ae-has-dropdown"},d.createElement("button",{"aria-expanded":this.props.expanded,"aria-label":i,className:"ae-toolbar-element",onClick:this.props.toggleDropdown,role:"combobox",tabIndex:this.props.tabIndex,title:i},d.createElement("div",{className:"ae-container"},d.createElement("span",{className:"ae-container-dropdown-selected-item"},i),d.createElement("span",{className:"ae-icon-arrow"}))),e)},_cacheValue:function(e){var t=this.props.editor.get("nativeEditor");Te[t.name][o].currentValue=e},_getItems:function(){var i=this;return this._items.map(function(e){var t="ae-toolbar-element "+(e.value===this.state.value?"active":"");return d.createElement("li",{key:e.title,role:"option"},d.createElement("button",{className:t,dangerouslySetInnerHTML:{__html:e.preview},"data-value":e.value,onClick:i._onClick}))}.bind(this))},_getItemsList:function(){return d.createElement(AlloyEditor.ButtonDropdown,{onDismiss:this.props.toggleDropdown},this._getItems())},_onClick:function(e){var t,i=this.props.editor.get("nativeEditor"),n=Te[i.name][o];n.onClick&&(t=e.currentTarget.getAttribute("data-value"),n.onClick.call(this,t),Te[i.name][o].currentValue=t,i.fire("actionPerformed",this))},_setValue:function(e){this._cacheValue(e),this.setState({value:e})}})),AlloyEditor.Buttons[o]=t),t},CKEDITOR.plugins.get("richcombo")||(CKEDITOR.UI_RICHCOMBO="richcombo",CKEDITOR.plugins.add("richcombo",{})),CKEDITOR.plugins.add("ae_richcombobridge",{requires:["ae_uibridge"],beforeInit:function(e){e.ui.addRichCombo=function(e,t){this.add(e,CKEDITOR.UI_RICHCOMBO,t)},e.ui.addHandler(CKEDITOR.UI_RICHCOMBO,{add:Ae,create:function(e){var t="richComboBridge"+(1e9*Math.random()>>>0);return new(Ae(t,e))}})}})),CKEDITOR.plugins.get("ae_uibridge")||CKEDITOR.plugins.add("ae_uibridge",{beforeInit:function(o){var a=o.ui.add;o.ui.add=function(e,t,i){a.apply(this,arguments);var n=this._.handlers[t];n&&n.add&&(n.add(e,i,o),AlloyEditor.registerBridgeButton(e,o.__processingPlugin__.plugin.name))}}}),s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ce={isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},isBoolean:function(e){return"boolean"==typeof e},isFunction:function(e){return"function"==typeof e},isNull:function(e){return null===e},isNumber:function(e){return"number"==typeof e&&isFinite(e)},isObject:function(e){var t=void 0===e?"undefined":s(e);return e&&("object"===t||Ce.isFunction(e))},isString:function(e){return"string"==typeof e},mix:function(e,t){var i=Object.prototype.hasOwnProperty;for(var n in t)i.call(t,n)&&(e[n]=t[n])},toInt:function(e){return parseInt(e,10)}},AlloyEditor.Lang=Ce,ve={extend:function(e,t,i,n){if(!t||!e)throw"extend failed, verify dependencies";var o=t.prototype,a=Object.create(o);return((e.prototype=a).constructor=e).superclass=o,t!==Object&&o.constructor===Object.prototype.constructor&&(o.constructor=t),i&&AlloyEditor.Lang.mix(a,i),n&&AlloyEditor.Lang.mix(e,n),e}},AlloyEditor.OOP=ve,Et.prototype={constructor:Et,get:function(e){var t=this.constructor.ATTRS[e];if(t){this._isInitialized(e)||this._init(e);var i=this.__ATTRS__[e];return t.getter&&(i=this._callStringOrFunction(t.getter,i)),i}},set:function(e,t){var i=this.constructor.ATTRS[e];i&&(this._isInitialized(e)||this._init(e),i.readOnly||i.writeOnce&&this._isInitialized(e)||i.validator&&!this._callStringOrFunction(i.validator,t)||(i.setter&&(t=this._callStringOrFunction(i.setter,t)),this.__ATTRS__[e]=t))},_callStringOrFunction:function(e,t){var i=null;return AlloyEditor.Lang.isArray(t)||(t=[t]),AlloyEditor.Lang.isString(e)&&AlloyEditor.Lang.isFunction(this[e])?i=this[e].apply(this,t):AlloyEditor.Lang.isFunction(e)&&(i=e.apply(this,t)),i},_init:function(e){var t,i=this.constructor.ATTRS[e],n=Object.prototype.hasOwnProperty.call(i,"value"),o=Object.prototype.hasOwnProperty.call(this.__config__,e);if(i.valueFn)t=this._callStringOrFunction(i.valueFn,t),this.__ATTRS__[e]=t;else if(i.readOnly)t=i.value;else if(i.writeOnce)if(o)t=this.__config__[e];else{if(!n)return;t=i.value}else o?t=this.__config__[e]:n&&(t=i.value);if(i.validator&&o&&!this._callStringOrFunction(i.validator,t)){if(!n)return;t=i.value}i.setter&&o&&(t=this._callStringOrFunction(i.setter,t)),this.__ATTRS__[e]=t},_isInitialized:function(e){return Object.prototype.hasOwnProperty.call(this.__ATTRS__,e)}},AlloyEditor.Attribute=Et,AlloyEditor.OOP.extend(yt,AlloyEditor.Attribute,{init:function(e){this._callChain("initializer",e)},destroy:function(){this._callChain("destructor")},_callChain:function(e,t){for(var i=[],n=this.constructor;n;)AlloyEditor.Lang.isFunction(n.prototype[e])&&i.push(n.prototype[e]),n=n.superclass?n.superclass.constructor:null;i=i.reverse(),t=AlloyEditor.Lang.isArray(t)?t:[t];for(var o=0;o<i.length;o++){i[o].apply(this,t)}}}),AlloyEditor.Base=yt,AlloyEditor.SelectionGetArrowBoxClasses={table:function(){return"ae-arrow-box ae-arrow-box-bottom"}},be={left:0,top:0},AlloyEditor.SelectionSetPosition={image:function(e){var t=e.selectionData?e.selectionData:e.editorEvent?e.editorEvent.data.selectionData:null;if(t&&t.element){var i=e.editor.get("nativeEditor").config.uiNode,n=i?i.scrollTop:0,o=t.element.getClientRect();return o.top+=n,ft(this,o),!0}},table:function(e){var t=e.editor.get("nativeEditor"),i=t.config.uiNode,n=i?i.scrollTop:0,o=new CKEDITOR.Table(t).getFromSelection().getClientRect();return o.top+=n,ft(this,o),!0}},AlloyEditor.SelectionTest={embed:function(e){var t=e.data.selectionData;return!(!t.element||"ae_embed"!==t.element.getAttribute("data-widget"))},image:function(e){var t=e.data.selectionData,i=!1;e.editor&&(i=e.editor._getNativeEditor().isSelectionEmpty());var n;return!(!t.element||"img"!==t.element.getName()||i||t.element.isReadOnly()&&("image"!==(n=t.element).getAttribute("data-widget")&&!n.getAscendant(function(e){return"image"===e.getAttribute("data-widget")})))},link:function(e){var t,i,n=e.editor.get("nativeEditor"),o=n.getSelection().getRanges()[0],a=e.data.selectionData,r=new CKEDITOR.Link(n).getFromSelection(),s=n.isSelectionEmpty(),l=!a.element||"img"!==a.element.getName();return!(!(s&&l&&r&&r.getText().length!==o.endOffset&&r)||r.isReadOnly()||(t=o,(i=r).getText().length===t.endOffset||i.equals(t.startContainer)&&i.equals(t.endContainer)&&t.startOffset===t.endOffset&&1===t.endOffset))},table:function(e){var t=e.editor.get("nativeEditor"),i=new CKEDITOR.Table(t),n=i.getFromSelection();return!(!n||!i.isEditable(n))},text:function(e){var t=e.editor.get("nativeEditor"),i=t.isSelectionEmpty(),n=e.data.selectionData;return!(n.element||!n.region||i||t.getSelection().getCommonAncestor().isReadOnly())}},Ee=[{name:"embed",buttons:["embedRemove","embedEdit"],test:AlloyEditor.SelectionTest.embed},{name:"link",buttons:["linkEdit"],test:AlloyEditor.SelectionTest.link},{name:"image",buttons:["imageLeft","imageCenter","imageRight"],setPosition:AlloyEditor.SelectionSetPosition.image,test:AlloyEditor.SelectionTest.image},{name:"text",buttons:{full:[["Font","FontSize","separator","bold","italic","underline","strike","separator","link"],["paragraphAlign","separator","ul","ol","separator","h1","h2","separator","indentBlock","outdentBlock","separator","TextColor","BGColor","separator","code","quote","separator","removeFormat"]],simple:["styles","bold","italic","underline","link"]},test:AlloyEditor.SelectionTest.text},{name:"table",buttons:["tableHeading","tableRow","tableColumn","tableCell","tableRemove"],getArrowBoxClasses:AlloyEditor.SelectionGetArrowBoxClasses.table,setPosition:AlloyEditor.SelectionSetPosition.table,test:AlloyEditor.SelectionTest.table}],AlloyEditor.Selections=Ee,AlloyEditor.OOP.extend(ht,AlloyEditor.Base,{initializer:function(e){var t=this.get("srcNode");this.get("enableContentEditable")&&t.setAttribute("contenteditable","true");var i,n=CKEDITOR.inline(t);n.config.allowedContent=this.get("allowedContent"),n.config.toolbars=this.get("toolbars"),n.config.removePlugins=this.get("removePlugins"),n.config.extraPlugins=this.get("extraPlugins"),n.config.placeholderClass=this.get("placeholderClass"),n.config.pasteFromWordRemoveStyles=!1,n.config.pasteFromWordRemoveFontStyles=!1,n.config.selectionKeystrokes=this.get("selectionKeystrokes"),AlloyEditor.Lang.mix(n.config,e),CKEDITOR.env.ie&&!CKEDITOR.env.edge&&(i=11===CKEDITOR.env.version?"ae_dragresize_ie11":"ae_dragresize_ie",n.config.extraPlugins=n.config.extraPlugins.replace("ae_dragresize",i),n.config.removePlugins=n.config.removePlugins.replace("ae_dragresize",i)),n.once("contentDom",function(){this._addReadOnlyLinkClickListener(n),n.editable().addClass("ae-editable")}.bind(this)),this._editor=n,AlloyEditor.loadLanguageResources(this._renderUI.bind(this))},destructor:function(){this._destroyed=!0,this._editorUIElement&&(p.unmountComponentAtNode(this._editorUIElement),this._editorUIElement.parentNode.removeChild(this._editorUIElement));var e,t=this.get("nativeEditor");t&&((e=t.editable())&&(e.removeClass("ae-editable"),this.get("enableContentEditable")&&this.get("srcNode").setAttribute("contenteditable","false")),this._clearSelections(),t.destroy())},_clearSelections:function(){var e=this.get("nativeEditor");"function"!=typeof window.getSelection?e.document.$.selection.empty():e.document.getWindow().$.getSelection().removeAllRanges()},_addReadOnlyLinkClickListener:function(e){e.editable().on("click",this._defaultReadOnlyClickFn,this,{editor:e})},_defaultReadOnlyClickFn:function(e){var t,i,n,o=e.data.$,a=o.ctrlKey||o.metaKey,r=this._editor.config.readOnly||a;o.preventDefault(),r&&(!1===e.listenerData.editor.editable().editor.fire("readOnlyClick",e.data)||(t=new CKEDITOR.dom.elementPath(e.data.getTarget(),this).lastElement)&&(i=t.$.attributes.href?t.$.attributes.href.value:null,n=a?"_blank":t.$.attributes.target?t.$.attributes.target.value:null,this._redirectLink(i,n)))},_getNativeEditor:function(){return this._editor},_redirectLink:function(e,t){t&&e?window.open(e,t):e&&(window.location.href=e)},_renderUI:function(){var e;this._destroyed||((e=document.createElement("div")).className="ae-ui",(this.get("uiNode")||document.body).appendChild(e),this._mainUI=p.render(d.createElement(AlloyEditor.UI,{editor:this,eventsDelay:this.get("eventsDelay"),toolbars:this.get("toolbars")}),e),this._editorUIElement=e,this.get("nativeEditor").fire("uiReady"))},_toElement:function(e){return AlloyEditor.Lang.isString(e)&&(e=document.getElementById(e)),e},_validateAllowedContent:function(e){return AlloyEditor.Lang.isString(e)||AlloyEditor.Lang.isObject(e)||AlloyEditor.Lang.isBoolean(e)},_validateToolbars:function(e){return AlloyEditor.Lang.isObject(e)||AlloyEditor.Lang.isNull(e)}},{ATTRS:{allowedContent:{validator:"_validateAllowedContent",value:!0,writeOnce:!0},enableContentEditable:{validator:AlloyEditor.Lang.isBoolean,value:!0,writeOnce:!0},eventsDelay:{validator:AlloyEditor.Lang.isNumber,value:100},extraPlugins:{validator:AlloyEditor.Lang.isString,value:"ae_uicore,ae_selectionregion,ae_selectionkeystrokes,ae_imagealignment,ae_addimages,ae_placeholder,ae_tabletools,ae_tableresize,ae_autolink,ae_embed,ae_autolist,ae_dragresize,ae_uibridge,ae_richcombobridge,ae_panelmenubuttonbridge,ae_menubridge,ae_menubuttonbridge,ae_buttonbridge,font,colorbutton",writeOnce:!0},mode:{validator:AlloyEditor.Lang.isString,value:"simple"},nativeEditor:{getter:"_getNativeEditor",readOnly:!0},placeholderClass:{validator:AlloyEditor.Lang.isString,value:"ae-placeholder",writeOnce:!0},removePlugins:{validator:AlloyEditor.Lang.isString,value:"contextmenu,toolbar,elementspath,resize,liststyle,link",writeOnce:!0},selectionKeystrokes:{validator:AlloyEditor.Lang.isArray,value:[{keys:CKEDITOR.CTRL+76,selection:"link"},{keys:CKEDITOR.CTRL+CKEDITOR.SHIFT+76,selection:"embed"}]},srcNode:{setter:"_toElement",writeOnce:!0},toolbars:{validator:"_validateToolbars",value:{add:{buttons:["image","embed","camera","hline","table"],tabIndex:2},styles:{selections:AlloyEditor.Selections,tabIndex:1}}},uiNode:{setter:"_toElement",writeOnce:!0}}}),CKEDITOR.event.implementOn(ht),AlloyEditor.Core=ht,ye={applyStyle:function(){var e;AlloyEditor.Lang.isFunction(this.isActive)&&AlloyEditor.Lang.isFunction(this.getStyle)&&((e=this.props.editor.get("nativeEditor")).getSelection().lock(),this.isActive()?e.removeStyle(this.getStyle()):e.applyStyle(this.getStyle()),e.getSelection().unlock(),e.fire("actionPerformed",this))}},AlloyEditor.ButtonActionStyle=ye,fe={isActive:function(){var e=this.props.editor.get("nativeEditor").getCommand(this.props.command);return!!e&&e.state===CKEDITOR.TRISTATE_ON}},AlloyEditor.ButtonCommandActive=fe,he={propTypes:{command:pt.string.isRequired,modifiesSelection:pt.bool},execCommand:function(e){var t=this.props.editor.get("nativeEditor");t.execCommand(this.props.command,e),this.props.modifiesSelection&&t.selectionChange(!0),t.fire("actionPerformed",this)}},AlloyEditor.ButtonCommand=he,ge={propTypes:{keystroke:pt.object.isRequired},componentWillMount:function(){var e=this.props.editor.get("nativeEditor"),i=this.props.keystroke,t=i.name||(1e9*Math.random()>>>0).toString(),n=e.getCommand(t);n||(n=new CKEDITOR.command(e,{exec:function(e){var t=i.fn;AlloyEditor.Lang.isString(t)?this[t].call(this,e):AlloyEditor.Lang.isFunction(t)&&t.call(this,e)}.bind(this)}),e.addCommand(t,n)),this._defaultKeystrokeCommand=e.keystrokeHandler.keystrokes[i.keys],e.setKeystroke(i.keys,t)},componentWillUnmount:function(){this.props.editor.get("nativeEditor").setKeystroke(this.props.keystroke.keys,this._defaultKeystrokeCommand)}},AlloyEditor.ButtonKeystroke=ge,pe={propTypes:{editor:pt.object.isRequired},mergeButtonCfgProps:function(e){e=e||this.props;var t=this.props.editor.get("nativeEditor").config.buttonCfg||{};return CKEDITOR.tools.merge(e,t[AlloyEditor.ButtonLinkEdit.key])}},AlloyEditor.ButtonCfgProps=pe,me={getStateClasses:function(){var e="";return AlloyEditor.Lang.isFunction(this.isActive)&&this.isActive()&&(e+="ae-button-pressed"),AlloyEditor.Lang.isFunction(this.isDisabled)&&this.isDisabled()&&(e+=" ae-button-disabled"),e}},AlloyEditor.ButtonStateClasses=me,ue={propTypes:{style:pt.oneOfType([pt.object,pt.string]),styleFn:pt.func},componentWillMount:function(){var e=AlloyEditor.Lang,t=this.props.style;if(e.isString(t)){for(var i=t.split("."),n=this.props.editor.get("nativeEditor").config,o=i.shift();o&&e.isObject(n)&&e.isObject(n[o]);)n=n[o],o=i.shift();e.isObject(n)&&(t=n)}this._style=new CKEDITOR.style(t)},componentWillUnmount:function(){this._style=null},getStyle:function(){return this._style},isActive:function(){var e=this.props.editor.get("nativeEditor"),t=e.elementPath();return this.getStyle().checkActive(t,e)}},AlloyEditor.ButtonStyle=ue,ce={getToolbarButtonGroups:function(i,n){var o=this;return AlloyEditor.Lang.isFunction(i)&&(i=i.call(this)||[]),i.reduce(function(e,t){return Array.isArray(t)?(e.push(o.getToolbarButtons(t,n)),e):o.getToolbarButtons(i,n)},[])},getToolbarButtons:function(e,n){var o={},t=this.props.editor.get("nativeEditor").config.buttonCfg||{};return AlloyEditor.Lang.isFunction(e)&&(e=e.call(this)||[]),this.filterExclusive(e.filter(function(e){return e&&(AlloyEditor.Buttons[e]||AlloyEditor.Buttons[e.name])}).map(function(e){return AlloyEditor.Lang.isString(e)?(o[e]=t[e],e=AlloyEditor.Buttons[e]):AlloyEditor.Lang.isString(e.name)&&(o[AlloyEditor.Buttons[e.name].key]=CKEDITOR.tools.merge(t[e],e.cfg),e=AlloyEditor.Buttons[e.name]),e})).map(function(e,t){var i=this.mergeExclusiveProps({editor:this.props.editor,key:"separator"!==e.key?e.key:e.key+"-"+t,tabKey:e.key,tabIndex:this.props.trigger&&this.props.trigger.props.tabKey===e.key?0:-1,trigger:this.props.trigger},e.key),i=this.mergeDropdownProps(i,e.key);return n&&(i=CKEDITOR.tools.merge(i,n)),i=CKEDITOR.tools.merge(i,o[e.key]),d.createElement(e,i)},this)}},AlloyEditor.ToolbarButtons=ce,de={getArrowBoxClasses:function(){var e="ae-arrow-box";return AlloyEditor.Lang.isFunction(this.getInteractionPoint)&&this.getInteractionPoint()&&(this.getInteractionPoint().direction===CKEDITOR.SELECTION_TOP_TO_BOTTOM?e+=" ae-arrow-box-top":e+=" ae-arrow-box-bottom"),e}},AlloyEditor.WidgetArrowBox=de,le={componentWillReceiveProps:function(){this.setState({dropdownTrigger:null,itemDropdown:null})},getInitialState:function(){return{dropdownTrigger:null,itemDropdown:null}},mergeDropdownProps:function(e,t){return CKEDITOR.tools.merge(e,{expanded:this.state.itemDropdown===t,tabIndex:this.state.dropdownTrigger===t?0:-1,toggleDropdown:this.toggleDropdown.bind(this,t)})},toggleDropdown:function(e,t){this.setState({dropdownTrigger:e,itemDropdown:e!==this.state.itemDropdown?e:null},function(){this.state.itemDropdown||(this.moveFocus?this.moveFocus(t):p.findDOMNode(this).focus())})}},AlloyEditor.WidgetDropdown=le,se={cancelExclusive:function(e){this.state.itemExclusive===e&&this.setState({itemExclusive:null})},componentWillReceiveProps:function(){this.setState({itemExclusive:null})},filterExclusive:function(e){return e.filter(function(e){return!this.state.itemExclusive||this.state.itemExclusive===e.key?e:void 0}.bind(this))},mergeExclusiveProps:function(e,t){return CKEDITOR.tools.merge(e,{cancelExclusive:this.cancelExclusive.bind(this,t),renderExclusive:this.state.itemExclusive===t,requestExclusive:this.requestExclusive.bind(this,t)})},requestExclusive:function(e){this.setState({itemExclusive:e})}},AlloyEditor.WidgetExclusive=se,re={propTypes:{onDismiss:pt.func,circular:pt.bool.isRequired,focusFirstChild:pt.bool,descendants:pt.string.isRequired,keys:pt.object.isRequired},componentDidMount:function(){this._refresh()},componentDidUpdate:function(){this._refresh()},focus:function(e){var t;e&&!this._isValidTarget(e.target)||this._descendants&&this._descendants.length&&(t=this._descendants[this._activeDescendant],document.activeElement===t||this.props.focusFirstChild||-1===this._descendants.indexOf(document.activeElement)&&t.focus(),e&&(e.stopPropagation(),e.preventDefault()))},handleKey:function(e){var t;this._isValidTarget(e.target)&&this._descendants&&((t=this._getFocusAction(e)).type&&(e.stopPropagation(),e.preventDefault(),1===t.type&&this._moveFocus(t.direction),2===t.type&&this.props.onDismiss(t.direction)))},moveFocus:function(e){e=AlloyEditor.Lang.isNumber(e)?e:0,this._moveFocus(e)},_getFocusAction:function(e){var t,i,n={type:0};return this.props.keys&&((t=this._getFocusMoveDirection(e))&&(n.direction=t,n.type=1),(i=this._getFocusDismissAction(e,t)).dismiss&&(n.direction=i.direction,n.type=2)),n},_getFocusDismissAction:function(e,t){var i={direction:t,dismiss:!1};return this.props.onDismiss&&(this._isValidKey(e.keyCode,this.props.keys.dismiss)&&(i.dismiss=!0),this._isValidKey(e.keyCode,this.props.keys.dismissNext)&&(i.dismiss=!0,i.direction=1),this._isValidKey(e.keyCode,this.props.keys.dismissPrev)&&(i.dismiss=!0,i.direction=-1),i.dismiss||this.props.circular||!t||(i.dismiss=-1===t&&0===this._activeDescendant||1===t&&this._activeDescendant===this._descendants.length-1)),i},_getFocusMoveDirection:function(e){var t=0;return this._isValidKey(e.keyCode,this.props.keys.next)&&(t=1),this._isValidKey(e.keyCode,this.props.keys.prev)&&(t=-1),e.shifKey&&(t*=-1),t},_isValidKey:function(e,t){return AlloyEditor.Lang.isArray(t)?-1!==t.indexOf(e):e===t},_isValidTarget:function(e){var t=e.tagName.toLowerCase();return"input"!==t&&"select"!==t&&"textarea"!==t},_moveFocus:function(e){var t=this._descendants.length,i=this._descendants[this._activeDescendant];i.setAttribute("tabIndex",-1),this._activeDescendant+=e,this.props.circular?this._activeDescendant=(this._activeDescendant%t+t)%t:this._activeDescendant=Math.max(Math.min(this._activeDescendant,t-1),0),(i=this._descendants[this._activeDescendant]).setAttribute("tabIndex",0),i.focus()},_refresh:function(){var e,t,i=p.findDOMNode(this);i&&(e=i.querySelectorAll(this.props.descendants),t=[],this._descendants=[],Array.prototype.slice.call(e).forEach(function(e){e.getAttribute("data-tabindex")?t.push(e):this._descendants.push(e)}.bind(this)),t=t.sort(function(e,t){return AlloyEditor.Lang.toInt(e.getAttribute("data-tabindex"))>AlloyEditor.Lang.toInt(t.getAttribute("data-tabindex"))}),this._descendants=t.concat(this._descendants),this._activeDescendant=0,this._descendants.some(function(e,t){if("0"===e.getAttribute("tabindex"))return this._activeDescendant=t,this.focus(),!0}.bind(this)))}},AlloyEditor.WidgetFocusManager=re,ae={propTypes:{editorEvent:pt.object},getInteractionPoint:function(){var e=this.props.editorEvent?this.props.editorEvent.data:null;if(e){var t,i,n=e.selectionData,o=e.nativeEvent,a={x:e.nativeEvent.pageX,y:n.region.top},r=n.region.direction,s=n.region.endRect,l=n.region.startRect;return s&&l&&l.top===s.top&&(r=CKEDITOR.SELECTION_BOTTOM_TO_TOP),i=a.x&&a.y?(t=this._getXPoint(n,a.x),r===CKEDITOR.SELECTION_BOTTOM_TO_TOP?Math.min(a.y,n.region.top):Math.max(a.y,this._getYPoint(n,o))):(t=n.region.left+n.region.width/2,r===CKEDITOR.SELECTION_TOP_TO_BOTTOM?this._getYPoint(n,o):n.region.top),{direction:r,x:t,y:i}}},_getXPoint:function(e,t){var i=e.region,n=i.startRect?i.startRect.left:i.left,o=i.endRect?i.endRect.right:i.right;return n<t&&t<o?t:Math.abs(n-t)<Math.abs(o-t)?n:o},_getYPoint:function(e,t){var i,n=0;return e&&t&&(n=(i=new CKEDITOR.dom.element(t.target)).$&&"auto"===i.getStyle("overflow")?t.target.offsetTop+t.target.offsetHeight:e.region.bottom),n}},AlloyEditor.WidgetInteractionPoint=ae,oe={mixins:[AlloyEditor.WidgetInteractionPoint],propTypes:{constrainToViewport:pt.bool,gutter:pt.object},getDefaultProps:function(){return{gutter:{left:0,top:10},constrainToViewport:!0}},cancelAnimation:function(){window.cancelAnimationFrame&&window.cancelAnimationFrame(this._animationFrameId)},getConstrainedPosition:function(e,t){t=t||new CKEDITOR.dom.window(window).getViewPaneSize();var i=e.left,n=e.top;return e.left+e.width>t.width&&(i-=e.left+e.width-t.width),n<0&&(n=0),{x:i,y:n}},getWidgetXYPoint:function(e,t,i){var n=p.findDOMNode(this),o=this.props.gutter,a=n.offsetWidth/2;return i===CKEDITOR.SELECTION_TOP_TO_BOTTOM||i===CKEDITOR.SELECTION_BOTTOM_TO_TOP?(e=e-o.left-a,t=i===CKEDITOR.SELECTION_TOP_TO_BOTTOM?t+o.top:t-n.offsetHeight-o.top):i!==CKEDITOR.SELECTION_LEFT_TO_RIGHT&&i!==CKEDITOR.SELECTION_RIGHT_TO_LEFT||(e=i===CKEDITOR.SELECTION_LEFT_TO_RIGHT?e+o.left+n.offsetHeight/2:e-3*n.offsetHeight/2-o.left,t=t-o.top-n.offsetHeight/2),e<0&&(e=0),e>document.body.offsetWidth-a&&(e=document.body.offsetWidth-a),t<0&&(t=0),[e,t]},isVisible:function(){var e=p.findDOMNode(this);return!!e&&new CKEDITOR.dom.element(e).hasClass("alloy-editor-visible")},moveToPoint:function(e,t){var i=new CKEDITOR.dom.element(p.findDOMNode(this));i.setStyles({left:e[0]+"px",top:e[1]+"px",opacity:0,pointerEvents:"none"}),i.removeClass("alloy-editor-invisible"),this._animate(function(){i.addClass("ae-toolbar-transition"),i.addClass("alloy-editor-visible"),i.setStyles({left:t[0]+"px",top:t[1]+"px",opacity:1}),setTimeout(function(){i.setStyles({pointerEvents:""})},150)})},show:function(){var e,t,i,n,o,a,r,s=p.findDOMNode(this),l=this.props.editor.get("uiNode"),d=l?l.scrollTop:0;this.isVisible()||!s||(e=this.getInteractionPoint())&&(t=new CKEDITOR.dom.element(s),a=i=parseFloat(t.getStyle("left")),r=n=parseFloat(t.getStyle("top")),this.props.constrainToViewport&&(a=(o=this.getConstrainedPosition({height:parseFloat(s.offsetHeight),left:a,top:r,width:parseFloat(s.offsetWidth)})).x,r=o.y),n=e.direction===CKEDITOR.SELECTION_TOP_TO_BOTTOM?this.props.selectionData.region.bottom+d:this.props.selectionData.region.top+d,this.moveToPoint([i,n],[a,r]))},updatePosition:function(){var e,t,i,n,o,a,r,s=this.getInteractionPoint(),l=p.findDOMNode(this);s&&l&&(e=this.props.editor.get("uiNode")||document.body,t=getComputedStyle(e),i=parseInt(t.getPropertyValue("margin-left"),10),n=parseInt(t.getPropertyValue("margin-right"),10),o=i+e.clientWidth+n,a="BODY"!==e.tagName?e.scrollTop:0,(r=this.getWidgetXYPoint(s.x,s.y,s.direction))[1]+=a,r[0]<0&&(r[0]=0),r[0]>o-l.offsetWidth&&(r[0]=o-l.offsetWidth),new CKEDITOR.dom.element(l).setStyles({left:r[0]+"px",top:r[1]+"px"}))},_animate:function(e){window.requestAnimationFrame?this._animationFrameId=window.requestAnimationFrame(e):e()}},AlloyEditor.WidgetPosition=oe,ne=gt({displayName:"ButtonBold",mixins:[AlloyEditor.ButtonStyle,AlloyEditor.ButtonStateClasses,AlloyEditor.ButtonCommand,AlloyEditor.ButtonKeystroke],propTypes:{editor:pt.object.isRequired,label:pt.string,tabIndex:pt.number},statics:{key:"bold"},getDefaultProps:function(){return{command:"bold",keystroke:{fn:"execCommand",keys:CKEDITOR.CTRL+66},style:"coreStyles_bold"}},render:function(){var e="ae-button "+this.getStateClasses();return d.createElement("button",{"aria-label":AlloyEditor.Strings.bold,"aria-pressed":-1!==e.indexOf("pressed"),className:e,"data-type":"button-bold",onClick:this.execCommand,tabIndex:this.props.tabIndex,title:AlloyEditor.Strings.bold},d.createElement("span",{className:"ae-icon-bold"}))}}),AlloyEditor.Buttons[ne.key]=AlloyEditor.ButtonBold=ne,ie=gt({displayName:"ButtonCameraImage",statics:{key:"cameraImage"},getDefaultProps:function(){return{videoWidth:320}},componentDidMount:function(){p.findDOMNode(this.refs.buttonTakePhoto).focus()},componentWillUnmount:function(){this._stream&&(this._stream.stop?this._stream.stop():this._stream.getVideoTracks&&this._stream.getVideoTracks().forEach(function(e){e.stop()}),this._stream=null)},render:function(){return(navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia).call(navigator,{video:!0,audio:!1},this._handleStreamSuccess,this._handleStreamError),d.createElement("div",{className:"ae-camera"},d.createElement("video",{ref:"videoContainer"},"Video stream not available."),d.createElement("button",{className:"ae-camera-shoot",onClick:this.takePhoto,ref:"buttonTakePhoto"},"Take photo"),d.createElement("canvas",{className:"ae-camera-canvas",ref:"canvasContainer"}))},takePhoto:function(){var e,t,i,n=p.findDOMNode(this.refs.videoContainer),o=p.findDOMNode(this.refs.canvasContainer),a=o.getContext("2d"),r=this._videoHeight,s=this.props.videoWidth;s&&r&&(o.width=s,o.height=r,a.drawImage(n,0,0,s,r),e=o.toDataURL("image/png"),t=CKEDITOR.dom.element.createFromHtml('<img src="'+e+'">'),(i=this.props.editor.get("nativeEditor")).insertElement(t),this.props.cancelExclusive(),i.fire("actionPerformed",this),i.fire("imageCameraAdd",t))},_handleStreamError:function(e){window.alert("An error occurred! "+e)},_handleStreamSuccess:function(e){var i=p.findDOMNode(this.refs.videoContainer),n=p.findDOMNode(this.refs.canvasContainer);i.addEventListener("canplay",function(e){var t=i.videoHeight/(i.videoWidth/this.props.videoWidth);isNaN(t)&&(t=this.props.videoWidth/(4/3)),i.setAttribute("width",this.props.videoWidth),i.setAttribute("height",t),n.setAttribute("width",this.props.videoWidth),n.setAttribute("height",t),this._videoHeight=t}.bind(this),!1),this._stream=e,navigator.mozGetUserMedia?i.mozSrcObject=e:i.src=(window.URL||window.webkitURL).createObjectURL(e),i.play(),p.findDOMNode(this.refs.buttonTakePhoto).disabled=!1}}),AlloyEditor.ButtonCameraImage=ie,te=gt({displayName:"ButtonCamera",propTypes:{editor:pt.object.isRequired,label:pt.string,tabIndex:pt.number},statics:{key:"camera"},render:function(){if(this.props.renderExclusive)return d.createElement(AlloyEditor.ButtonCameraImage,this.props);var e=!(navigator.getUserMedia||navigator.webkitGetUserMedia&&"https"===location.protocol||navigator.mozGetUserMedia||navigator.msGetUserMedia),t=e?AlloyEditor.Strings.cameraDisabled:AlloyEditor.Strings.camera;return d.createElement("button",{"aria-label":t,className:"ae-button","data-type":"button-image-camera",disabled:e,onClick:this.props.requestExclusive.bind(te.key),tabIndex:this.props.tabIndex,title:t},d.createElement("span",{className:"ae-icon-camera"}))}}),AlloyEditor.Buttons[te.key]=AlloyEditor.ButtonCamera=te,ee=gt({displayName:"ButtonCode",mixins:[AlloyEditor.ButtonStyle,AlloyEditor.ButtonStateClasses,AlloyEditor.ButtonActionStyle],propTypes:{editor:pt.object.isRequired,label:pt.string,tabIndex:pt.number},statics:{key:"code"},getDefaultProps:function(){return{style:{element:"pre"}}},render:function(){var e="ae-button "+this.getStateClasses();return d.createElement("button",{"aria-label":AlloyEditor.Strings.code,"aria-pressed":-1!==e.indexOf("pressed"),className:e,"data-type":"button-code",onClick:this.applyStyle,tabIndex:this.props.tabIndex,title:AlloyEditor.Strings.code},d.createElement("span",{className:"ae-icon-code"}))}}),AlloyEditor.Buttons[ee.key]=AlloyEditor.ButtonCode=ee,Q=gt({displayName:"ButtonCommandListItem",mixins:[AlloyEditor.ButtonCommand],propTypes:{description:pt.string.isRequired,icon:pt.string},statics:{key:"buttonCommandListItem"},render:function(){var e="ae-icon-"+this.props.icon;return d.createElement("button",{"aria-label":this.props.description,className:this._getClassName(),onClick:this.execCommand,tabIndex:this.props.tabIndex},this.props.icon&&d.createElement("span",{className:e}),this.props.description)},_getClassName:function(){return"ae-container ae-toolbar-element"}}),AlloyEditor.ButtonCommandListItem=Q,Z=gt({displayName:"ButtonCommandsList",mixins:[AlloyEditor.WidgetFocusManager],propTypes:{commands:pt.arrayOf(pt.object),editor:pt.object.isRequired,listId:pt.string},statics:{key:"buttonCommandsList"},componentDidMount:function(){p.findDOMNode(this).focus()},getDefaultProps:function(){return{circular:!1,descendants:".ae-toolbar-element",keys:{dismiss:[27],dismissNext:[39],dismissPrev:[37],next:[40],prev:[38]}}},render:function(){return d.createElement("div",{className:"ae-dropdown ae-arrow-box ae-arrow-box-top-left",onFocus:this.focus,onKeyDown:this.handleKey,tabIndex:"0"},d.createElement("ul",{className:"ae-listbox",id:this.props.listId,role:"listbox"},this._renderActions(this.props.commands)))},_renderActions:function(e){var t,i=this.props.editor;return e&&e.length&&(t=e.map(function(e){return d.createElement("li",{key:e.command,role:"option"},d.createElement(AlloyEditor.ButtonCommandListItem,{command:e.command,description:"string"==typeof e.label?e.label:e.label(),icon:e.icon,editor:i}))})),t}}),AlloyEditor.ButtonCommandsList=Z,J=gt({displayName:"ButtonDropdown",mixins:[AlloyEditor.WidgetFocusManager],getDefaultProps:function(){return{circular:!1,descendants:".ae-toolbar-element",keys:{dismiss:[27],dismissNext:[39],dismissPrev:[37],next:[40],prev:[38]}}},statics:{key:"dropdown"},render:function(){return d.createElement("div",{className:"ae-dropdown ae-arrow-box ae-arrow-box-top-left",onFocus:this.focus,onKeyDown:this.handleKey,tabIndex:"0"},d.createElement("ul",{className:"ae-listbox",role:"listbox"},this.props.children))}}),AlloyEditor.Buttons[J.key]=AlloyEditor.ButtonDropdown=J,X=gt({displayName:"ButtonEmbedEdit",propTypes:{editor:pt.object.isRequired},statics:{key:"embedEdit"},componentDidMount:function(){(this.props.renderExclusive||this.props.manualSelection)&&(window.requestAnimationFrame?window.requestAnimationFrame(this._focusLinkInput):setTimeout(this._focusLinkInput,0))},componentWillReceiveProps:function(){this.replaceState(this.getInitialState())},getInitialState:function(){var e,t,i=this.props.editor.get("nativeEditor").getSelection();!i||(t=i.getSelectedElement())&&(e=t.findOne('[data-widget="ae_embed"]'));var n=e?e.getAttribute("data-ae-embed-url"):"";return{element:e,initialLink:{href:n},linkHref:n}},render:function(){var e={opacity:this.state.linkHref?1:0};return d.createElement("div",{className:"ae-container-edit-link"},d.createElement("button",{"aria-label":AlloyEditor.Strings.deleteEmbed,className:"ae-button","data-type":"button-embed-remove",disabled:!this.state.element,onClick:this._removeEmbed,tabIndex:this.props.tabIndex,title:AlloyEditor.Strings.deleteEmbed},d.createElement("span",{className:"ae-icon-bin"})),d.createElement("div",{className:"ae-container-input xxl"},d.createElement("input",{className:"ae-input",onChange:this._handleLinkHrefChange,onKeyDown:this._handleKeyDown,placeholder:AlloyEditor.Strings.editLink,ref:"linkInput",type:"text",value:this.state.linkHref}),d.createElement("button",{"aria-label":AlloyEditor.Strings.clearInput,className:"ae-button ae-icon-remove",onClick:this._clearLink,style:e,title:AlloyEditor.Strings.clear})),d.createElement("button",{"aria-label":AlloyEditor.Strings.confirm,className:"ae-button",disabled:!this._isValidState(),onClick:this._embedLink,title:AlloyEditor.Strings.confirm},d.createElement("span",{className:"ae-icon-ok"})))},_clearLink:function(){this.setState({linkHref:""})},_embedLink:function(){this.props.editor.get("nativeEditor").execCommand("embedUrl",{url:this.state.linkHref}),this.props.cancelExclusive()},_focusLinkInput:function(){p.findDOMNode(this.refs.linkInput).focus()},_handleKeyDown:function(e){var t;13!==e.keyCode&&27!==e.keyCode||e.preventDefault(),13===e.keyCode?this._embedLink():27===e.keyCode&&(t=this.props.editor.get("nativeEditor"),this.props.cancelExclusive(),t.fire("actionPerformed",this))},_handleLinkHrefChange:function(e){this.setState({linkHref:e.target.value})},_isValidState:function(){return this.state.linkHref&&this.state.linkHref!==this.state.initialLink.href},_removeEmbed:function(){var e=this.props.editor.get("nativeEditor");this.state.element.getAscendant(function(e){return e.hasClass("cke_widget_wrapper")}).remove(),e.fire("actionPerformed",this)}}),AlloyEditor.Buttons[X.key]=AlloyEditor.ButtonEmbedEdit=X,Y=gt({displayName:"ButtonEmbed",mixins:[AlloyEditor.ButtonKeystroke],propTypes:{editor:pt.object.isRequired,label:pt.string,tabIndex:pt.number},statics:{key:"embed"},getDefaultProps:function(){return{keystroke:{fn:"_requestExclusive",keys:CKEDITOR.CTRL+CKEDITOR.SHIFT+76}}},render:function(){return this.props.renderExclusive?d.createElement(AlloyEditor.ButtonEmbedEdit,this.props):d.createElement("button",{"aria-label":AlloyEditor.Strings.link,className:"ae-button","data-type":"button-embed",onClick:this._requestExclusive,tabIndex:this.props.tabIndex,title:AlloyEditor.Strings.link},d.createElement("span",{className:"ae-icon-add"}))},_requestExclusive:function(){this.props.requestExclusive(Y.key)}}),AlloyEditor.Buttons[Y.key]=AlloyEditor.ButtonEmbed=Y,G=gt({displayName:"ButtonH1",mixins:[AlloyEditor.ButtonStyle,AlloyEditor.ButtonStateClasses,AlloyEditor.ButtonActionStyle],propTypes:{editor:pt.object.isRequired,label:pt.string,tabIndex:pt.number},statics:{key:"h1"},getDefaultProps:function(){return{style:{element:"h1"}}},render:function(){var e="ae-button "+this.getStateClasses();return d.createElement("button",{"aria-label":AlloyEditor.Strings.h1,"aria-pressed":-1!==e.indexOf("pressed"),className:e,"data-type":"button-h1",onClick:this.applyStyle,tabIndex:this.props.tabIndex,title:AlloyEditor.Strings.h1},d.createElement("span",{className:"ae-icon-h1"}))}}),AlloyEditor.Buttons[G.key]=AlloyEditor.ButtonH1=G,V=gt({displayName:"ButtonH2",mixins:[AlloyEditor.ButtonStyle,AlloyEditor.ButtonStateClasses,AlloyEditor.ButtonActionStyle],propTypes:{editor:pt.object.isRequired,label:pt.string,tabIndex:pt.number},statics:{key:"h2"},getDefaultProps:function(){return{style:{element:"h2"}}},render:function(){var e="ae-button "+this.getStateClasses();return d.createElement("button",{"aria-label":AlloyEditor.Strings.h2,"aria-pressed":-1!==e.indexOf("pressed"),className:e,"data-type":"button-h2",onClick:this.applyStyle,tabIndex:this.props.tabIndex,title:AlloyEditor.Strings.h2},d.createElement("span",{className:"ae-icon-h2"}))}}),AlloyEditor.Buttons[V.key]=AlloyEditor.ButtonH2=V,W=gt({displayName:"ButtonHline",mixins:[AlloyEditor.ButtonStyle,AlloyEditor.ButtonCommand],propTypes:{editor:pt.object.isRequired,label:pt.string,tabIndex:pt.number},statics:{key:"hline"},getDefaultProps:function(){return{command:"horizontalrule",style:{element:"hr"}}},render:function(){return d.createElement("button",{"aria-label":AlloyEditor.Strings.horizontalrule,className:"ae-button","data-type":"button-hline",onClick:this.execCommand,tabIndex:this.props.tabIndex,title:AlloyEditor.Strings.horizontalrule},d.createElement("span",{className:"ae-icon-separator"}))}}),AlloyEditor.Buttons[W.key]=AlloyEditor.ButtonHline=W,U=gt({displayName:"ButtonImageAlignCenter",mixins:[AlloyEditor.ButtonStateClasses,AlloyEditor.ButtonCommand,AlloyEditor.ButtonCommandActive],propTypes:{editor:pt.object.isRequired,label:pt.string,tabIndex:pt.number},statics:{key:"imageCenter"},getDefaultProps:function(){return{command:"justifycenter"}},render:function(){var e="ae-button "+this.getStateClasses();return d.createElement("button",{"aria-label":AlloyEditor.Strings.alignCenter,"aria-pressed":-1!==e.indexOf("pressed"),className:e,"data-type":"button-image-align-center",onClick:this.execCommand,tabIndex:this.props.tabIndex,title:AlloyEditor.Strings.alignCenter},d.createElement("span",{className:"ae-icon-align-center"}))}}),AlloyEditor.Buttons[U.key]=AlloyEditor.ButtonImageAlignCenter=U,q=gt({displayName:"ButtonImageAlignLeft",mixins:[AlloyEditor.ButtonStateClasses,AlloyEditor.ButtonCommand,AlloyEditor.ButtonCommandActive],propTypes:{editor:pt.object.isRequired,label:pt.string,tabIndex:pt.number},statics:{key:"imageLeft"},getDefaultProps:function(){return{command:"justifyleft"}},render:function(){var e="ae-button "+this.getStateClasses();return d.createElement("button",{"aria-label":AlloyEditor.Strings.alignLeft,"aria-pressed":-1!==e.indexOf("pressed"),className:e,"data-type":"button-image-align-left",onClick:this.execCommand,tabIndex:this.props.tabIndex,title:AlloyEditor.Strings.alignLeft},d.createElement("span",{className:"ae-icon-align-left"}))}}),AlloyEditor.Buttons[q.key]=AlloyEditor.ButtonImageAlignLeft=q,j=gt({displayName:"ButtonImageAlignRight",mixins:[AlloyEditor.ButtonStateClasses,AlloyEditor.ButtonCommand,AlloyEditor.ButtonCommandActive],propTypes:{editor:pt.object.isRequired,label:pt.string,tabIndex:pt.number},statics:{key:"imageRight"},getDefaultProps:function(){return{command:"justifyright"}},render:function(){var e="ae-button "+this.getStateClasses();return d.createElement("button",{"aria-label":AlloyEditor.Strings.alignRight,"aria-pressed":-1!==e.indexOf("pressed"),className:e,"data-type":"button-image-align-right",onClick:this.execCommand,tabIndex:this.props.tabIndex,title:AlloyEditor.Strings.alignRight},d.createElement("span",{className:"ae-icon-align-right"}))}}),AlloyEditor.Buttons[j.key]=AlloyEditor.ButtonImageAlignRight=j,$=gt({displayName:"ButtonImage",propTypes:{editor:pt.object.isRequired,label:pt.string,tabIndex:pt.number},statics:{key:"image"},render:function(){return d.createElement("div",null,d.createElement("button",{"aria-label":AlloyEditor.Strings.image,className:"ae-button","data-type":"button-image",onClick:this.handleClick,tabIndex:this.props.tabIndex,title:AlloyEditor.Strings.image},d.createElement("span",{className:"ae-icon-image"})),d.createElement("input",{accept:"image/*",onChange:this._onInputChange,ref:"fileInput",style:{display:"none"},type:"file"}))},handleClick:function(){p.findDOMNode(this.refs.fileInput).click()},_onInputChange:function(){var e,o,t=p.findDOMNode(this.refs.fileInput);t.files.length&&(e=new FileReader,o=t.files[0],e.onload=function(e){var t,i,n=this.props.editor.get("nativeEditor");n.fire("beforeImageAdd",{imageFiles:o})&&(t=CKEDITOR.dom.element.createFromHtml('<img src="'+e.target.result+'">'),n.insertElement(t),n.fire("actionPerformed",this),i={el:t,file:o},n.fire("imageAdd",i))}.bind(this),e.readAsDataURL(o),t.value="")}}),AlloyEditor.Buttons[$.key]=AlloyEditor.ButtonImage=$,H=gt({displayName:"ButtonIndentBlock",mixins:[AlloyEditor.ButtonStateClasses,AlloyEditor.ButtonCommand,AlloyEditor.ButtonCommandActive],propTypes:{editor:pt.object.isRequired,label:pt.string,tabIndex:pt.number},statics:{key:"indentBlock"},getDefaultProps:function(){return{command:"indent"}},render:function(){var e="ae-button "+this.getStateClasses();return d.createElement("button",{"aria-label":AlloyEditor.Strings.indent,"aria-pressed":-1!==e.indexOf("pressed"),className:e,"data-type":"button-indent-block",onClick:this.execCommand,tabIndex:this.props.tabIndex,title:AlloyEditor.Strings.indent},d.createElement("span",{className:"ae-icon-indent-block"}))}}),AlloyEditor.Buttons[H.key]=AlloyEditor.ButtonIndentBlock=H,z=gt({displayName:"ButtonItalic",mixins:[AlloyEditor.ButtonStyle,AlloyEditor.ButtonStateClasses,AlloyEditor.ButtonCommand,AlloyEditor.ButtonKeystroke],propTypes:{editor:pt.object.isRequired,label:pt.string,tabIndex:pt.number},statics:{key:"italic"},getDefaultProps:function(){return{command:"italic",keystroke:{fn:"execCommand",keys:CKEDITOR.CTRL+73},style:"coreStyles_italic"}},render:function(){var e="ae-button "+this.getStateClasses();return d.createElement("button",{"aria-label":AlloyEditor.Strings.italic,"aria-pressed":-1!==e.indexOf("pressed"),className:e,"data-type":"button-italic",onClick:this.execCommand,tabIndex:this.props.tabIndex,title:AlloyEditor.Strings.italic},d.createElement("span",{className:"ae-icon-italic"}))}}),AlloyEditor.Buttons[z.key]=AlloyEditor.ButtonItalic=z,M=gt({displayName:"ButtonLinkAutocompleteList",mixins:[AlloyEditor.WidgetFocusManager],propTypes:{data:pt.func,autocompleteSelected:pt.bool,term:pt.string,setAutocompleteState:pt.func},statics:{key:"buttonLinkAutocompleteList"},componentWillReceiveProps:function(e){e.term&&e.term===this.props.term||(clearTimeout(this._timeout),e.term?this._timeout=setTimeout(this._updateItems,this.props.delay):this.setState({items:[]})),e.autocompleteSelected&&(setTimeout(this.focus,0),this.props.setAutocompleteState({selected:!1}))},componentWillUnmount:function(){clearTimeout(this._timeout)},getDefaultProps:function(){return{circular:!1,data:[],delay:100,descendants:".ae-toolbar-element",keys:{dismiss:[27],dismissNext:[39],dismissPrev:[37],next:[40],prev:[38]}}},getInitialState:function(){return{items:[]}},render:function(){return this.props.expanded&&this.state.items.length?d.createElement(AlloyEditor.ButtonDropdown,null,this._renderAutocompleteItems(this.state.items)):null},shouldComponentUpdate:function(e,t){return e.expanded!==this.props.expanded||e.term!==this.props.term||t.items!==this.state.items},_renderAutocompleteItems:function(e){e=e||[];var i=this.props.handleLinkAutocompleteClick;return e.map(function(e){var t=this.props.term===e.url?"ae-toolbar-element active":"ae-toolbar-element";return d.createElement("li",{key:e.url,role:"option"},d.createElement("button",{className:t,onClick:i,"data-value":e.url},e.title))}.bind(this))},_updateItems:function(){var t=this;this.props.term&&Promise.resolve(this.props.data(this.props.term)).then(function(e){e.length&&(t.props.expanded||t.props.toggleDropdown()),t.setState({items:e})})}}),AlloyEditor.ButtonLinkAutocompleteList=M,l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},F=gt({displayName:"ButtonLinkEdit",mixins:[AlloyEditor.WidgetDropdown,AlloyEditor.WidgetFocusManager,AlloyEditor.ButtonCfgProps],propTypes:{allowedTargets:pt.arrayOf(pt.object),appendProtocol:pt.bool,editor:pt.object.isRequired,defaultLinkTarget:pt.string,showTargetSelector:pt.bool,data:pt.oneOfType([pt.func,pt.arrayOf(pt.object)])},statics:{key:"linkEdit"},componentDidMount:function(){(this.props.renderExclusive||this.props.manualSelection)&&this._focusLinkInput()},componentWillReceiveProps:function(){this.replaceState(this.getInitialState())},getDefaultProps:function(){return{appendProtocol:!0,autocompleteUrl:"",circular:!0,customIndexStart:!0,defaultLinkTarget:"",descendants:".ae-toolbar-element",keys:{dismiss:[27],dismissNext:[39],dismissPrev:[37],next:[40],prev:[38]},showTargetSelector:!0}},getInitialState:function(){var e=new CKEDITOR.Link(this.props.editor.get("nativeEditor")).getFromSelection(),t=e?e.getAttribute("href"):"",i=e?e.getAttribute("target"):this.props.defaultLinkTarget;return{autocompleteSelected:!1,element:e,initialLink:{href:t,target:i},linkHref:t,linkTarget:i}},render:function(){var e,t,i,n,o,a,r={allowedTargets:this.props.allowedTargets,editor:this.props.editor,handleLinkTargetChange:this._handleLinkTargetChange,selectedTarget:this.state.linkTarget||AlloyEditor.Strings.linkTargetDefault},r=this.mergeDropdownProps(r,AlloyEditor.ButtonLinkTargetEdit.key);this.props.data&&(t=this.props.data,AlloyEditor.Lang.isFunction(t)||(e=this.props.data,t=function(){return e}),i={autocompleteSelected:this.state.autocompleteSelected,data:t,editor:this.props.editor,handleLinkAutocompleteClick:this._handleLinkAutocompleteClick,onDismiss:this.props.toggleDropdown,setAutocompleteState:this._setAutocompleteState,term:this.state.linkHref},i=this.mergeDropdownProps(i,AlloyEditor.ButtonLinkAutocompleteList.key),n=d.createElement(AlloyEditor.ButtonLinkAutocompleteList,i)),this.props.showTargetSelector&&(o=d.createElement(AlloyEditor.ButtonLinkTargetEdit,r)),this.state.linkHref&&(a=d.createElement("button",{"aria-label":AlloyEditor.Strings.clearInput,className:"ae-button ae-icon-remove",onClick:this._clearLink,title:AlloyEditor.Strings.clear}));var s={};return!CKEDITOR.env.ie&&AlloyEditor.Strings&&(s.placeholder=AlloyEditor.Strings.editLink),d.createElement("div",{className:"ae-container-edit-link"},d.createElement("button",{"aria-label":AlloyEditor.Strings.removeLink,className:"ae-button",disabled:!this.state.element,onClick:this._removeLink,title:AlloyEditor.Strings.remove},d.createElement("span",{className:"ae-icon-unlink"})),d.createElement("div",{className:"ae-container-input xxl"},o,d.createElement("div",{className:"ae-container-input"},d.createElement("input",l({className:"ae-input",onChange:this._handleLinkHrefChange,onKeyDown:this._handleKeyDown},s,{ref:"linkInput",type:"text",value:this.state.linkHref})),n),a),d.createElement("button",{"aria-label":AlloyEditor.Strings.confirm,className:"ae-button",disabled:!this._isValidState(),onClick:this._updateLink,title:AlloyEditor.Strings.confirm},d.createElement("span",{className:"ae-icon-ok"})))},_clearLink:function(){this.setState({linkHref:""}),this._focusLinkInput()},_focusLinkInput:function(){function e(){p.findDOMNode(t.refs.linkInput).focus()}var t=this;window.requestAnimationFrame?window.requestAnimationFrame(e):setTimeout(e,0)},_handleKeyDown:function(e){var t;13!==e.keyCode&&27!==e.keyCode||e.preventDefault(),13===e.keyCode?this._updateLink():40===e.keyCode?this.setState({autocompleteSelected:!0}):27===e.keyCode&&(t=this.props.editor.get("nativeEditor"),new CKEDITOR.Link(t).advanceSelection(),this.props.editor.get("nativeEditor").fire("actionPerformed",this))},_handleLinkHrefChange:function(e){this.setState({linkHref:e.target.value}),this._focusLinkInput()},_handleLinkTargetChange:function(e){this.setState({itemDropdown:null,linkTarget:e.target.getAttribute("data-value")}),this._focusLinkInput()},_handleLinkAutocompleteClick:function(e){this.setState({itemDropdown:null,linkHref:e.target.getAttribute("data-value")}),this._focusLinkInput()},_isValidState:function(){return this.state.linkHref&&(this.state.linkHref!==this.state.initialLink.href||this.state.linkTarget!==this.state.initialLink.target)},_removeLink:function(){var e=this.props.editor.get("nativeEditor"),t=new CKEDITOR.Link(e),i=e.getSelection(),n=i.createBookmarks();t.remove(this.state.element,{advance:!0}),i.selectBookmarks(n),this.props.cancelExclusive(),e.fire("actionPerformed",this)},_setAutocompleteState:function(e){this.setState({autocompleteSelected:e.selected})},_updateLink:function(){var e=this.props.editor.get("nativeEditor"),t=new CKEDITOR.Link(e,{appendProtocol:this.props.appendProtocol}),i={target:this.state.linkTarget||null},n={advance:!0};this.state.linkHref&&(this.state.element?(i.href=this.state.linkHref,t.update(i,this.state.element,n)):(this.state.linkTarget||(i={}),t.create(this.state.linkHref,i,n)),e.fire("actionPerformed",this)),this.props.cancelExclusive()}}),AlloyEditor.Buttons[F.key]=AlloyEditor.ButtonLinkEdit=F,P=gt({displayName:"ButtonLinkTargetEdit",propTypes:{allowedTargets:pt.arrayOf(pt.object),editor:pt.object.isRequired,selectedTarget:pt.string},statics:{key:"linkTargetEdit"},render:function(){var e,t=this.props.handleLinkTargetChange,i=this.props.allowedTargets;return this.props.expanded&&(e=d.createElement(AlloyEditor.ButtonTargetList,{editor:this.props.editor,onDismiss:this.props.toggleDropdown,allowedLinkTargets:i,handleLinkTargetChange:t,selectedTarget:this.props.selectedTarget})),d.createElement("div",{className:"ae-container-edit-link-target ae-container-dropdown ae-container-dropdown-medium ae-has-dropdown",tabIndex:"0"},d.createElement("button",{"aria-expanded":this.props.expanded,"aria-label":this.props.selectedTarget,className:"ae-toolbar-element",onClick:this.props.toggleDropdown,role:"combobox",tabIndex:this.props.tabIndex,title:this.props.selectedTarget},d.createElement("div",{className:"ae-container"},d.createElement("span",{className:"ae-container-dropdown-selected-item"},this.props.selectedTarget),d.createElement("span",{className:"ae-icon-arrow"}))),e)},shouldComponentUpdate:function(e){return e.expanded!==this.props.expanded||e.selectedTarget!==this.props.selectedTarget}}),AlloyEditor.Buttons[P.key]=AlloyEditor.ButtonLinkTargetEdit=P,L=gt({displayName:"ButtonLink",mixins:[AlloyEditor.ButtonKeystroke,AlloyEditor.ButtonStateClasses,AlloyEditor.ButtonCfgProps],propTypes:{editor:pt.object.isRequired,label:pt.string,tabIndex:pt.number},statics:{key:"link"},getDefaultProps:function(){return{keystroke:{fn:"_requestExclusive",keys:CKEDITOR.CTRL+76}}},isActive:function(){return null!==new CKEDITOR.Link(this.props.editor.get("nativeEditor")).getFromSelection()},render:function(){var e="ae-button "+this.getStateClasses();if(this.props.renderExclusive){var t=this.mergeButtonCfgProps();return d.createElement(AlloyEditor.ButtonLinkEdit,t)}return d.createElement("button",{"aria-label":AlloyEditor.Strings.link,className:e,"data-type":"button-link",onClick:this._requestExclusive,tabIndex:this.props.tabIndex,title:AlloyEditor.Strings.link},d.createElement("span",{className:"ae-icon-link"}))},_requestExclusive:function(){this.props.requestExclusive(L.key)}}),AlloyEditor.Buttons[L.key]=AlloyEditor.ButtonLink=L,K=gt({displayName:"ButtonOrderedList",mixins:[AlloyEditor.ButtonStyle,AlloyEditor.ButtonStateClasses,AlloyEditor.ButtonCommand],propTypes:{editor:pt.object.isRequired,label:pt.string,tabIndex:pt.number},statics:{key:"ol"},getDefaultProps:function(){return{command:"numberedlist",style:{element:"ol"}}},render:function(){var e="ae-button "+this.getStateClasses();return d.createElement("button",{"aria-label":AlloyEditor.Strings.numberedlist,"aria-pressed":-1!==e.indexOf("pressed"),className:e,"data-type":"button-ol",onClick:this.execCommand,tabIndex:this.props.tabIndex,title:AlloyEditor.Strings.numberedlist},d.createElement("span",{className:"ae-icon-numbered-list"}))}}),AlloyEditor.Buttons[K.key]=AlloyEditor.ButtonOrderedList=K,B=gt({displayName:"ButtonOutdentBlock",mixins:[AlloyEditor.ButtonStateClasses,AlloyEditor.ButtonCommand,AlloyEditor.ButtonCommandActive],propTypes:{editor:pt.object.isRequired,label:pt.string,tabIndex:pt.number},statics:{key:"outdentBlock"},getDefaultProps:function(){return{command:"outdent"}},render:function(){var e="ae-button "+this.getStateClasses();return d.createElement("button",{"aria-label":AlloyEditor.Strings.outdent,"aria-pressed":-1!==e.indexOf("pressed"),className:e,"data-type":"button-outdent-block",onClick:this.execCommand,tabIndex:this.props.tabIndex,title:AlloyEditor.Strings.outdent},d.createElement("span",{className:"ae-icon-outdent-block"}))}}),AlloyEditor.Buttons[B.key]=AlloyEditor.ButtonOutdentBlock=B,N=gt({displayName:"ButtonParagraphAlignLeft",mixins:[AlloyEditor.ButtonStateClasses,AlloyEditor.ButtonCommand,AlloyEditor.ButtonCommandActive],propTypes:{editor:pt.object.isRequired,label:pt.string,tabIndex:pt.number},statics:{key:"paragraphLeft"},getDefaultProps:function(){return{command:"justifyleft"}},render:function(){var e="ae-button "+this.getStateClasses();return d.createElement("button",{"aria-label":AlloyEditor.Strings.alignLeft,"aria-pressed":-1!==e.indexOf("pressed"),className:e,"data-type":"button-paragraph-align-left",onClick:this.execCommand,tabIndex:this.props.tabIndex,title:AlloyEditor.Strings.alignLeft},d.createElement("span",{className:"ae-icon-align-left"}))}}),AlloyEditor.Buttons[N.key]=AlloyEditor.ButtonParagraphAlignLeft=N,R=gt({displayName:"ButtonParagraphAlignRight",mixins:[AlloyEditor.ButtonStateClasses,AlloyEditor.ButtonCommand,AlloyEditor.ButtonCommandActive],propTypes:{editor:pt.object.isRequired,label:pt.string,tabIndex:pt.number},statics:{key:"paragraphRight"},getDefaultProps:function(){return{command:"justifyright"}},render:function(){var e="ae-button "+this.getStateClasses();return d.createElement("button",{"aria-label":AlloyEditor.Strings.alignRight,"aria-pressed":-1!==e.indexOf("pressed"),className:e,"data-type":"button-paragraph-align-right",onClick:this.execCommand,tabIndex:this.props.tabIndex,title:AlloyEditor.Strings.alignRight},d.createElement("span",{className:"ae-icon-align-right"}))}}),AlloyEditor.Buttons[R.key]=AlloyEditor.ButtonParagraphAlignRight=R,x=gt({displayName:"ButtonParagraphAlign",propTypes:{commands:pt.arrayOf(pt.object),editor:pt.object.isRequired,expanded:pt.bool,label:pt.string,tabIndex:pt.number,toggleDropdown:pt.func},statics:{key:"paragraphAlign"},render:function(){var e,t;AlloyEditor.Strings.alignLeft;this.props.expanded&&(t=x.key+"List",e=d.createElement(AlloyEditor.ButtonCommandsList,{commands:this._getCommands(),editor:this.props.editor,listId:t,inlineIcons:!1,onDismiss:this.props.toggleDropdown}));var i=this.props.editor.get("nativeEditor"),n=this._getCommands().filter(function(e){var t=i.getCommand(e.command);return!!t&&t.state===CKEDITOR.TRISTATE_ON}).pop(),o="ae-icon-"+n.icon;return d.createElement("div",{className:"ae-container-dropdown ae-container-dropdown-xsmall ae-has-dropdown"},d.createElement("button",{"aria-expanded":this.props.expanded,"aria-label":n.label,"aria-owns":t,className:"ae-toolbar-element",onClick:this.props.toggleDropdown,role:"combobox",tabIndex:this.props.tabIndex,title:AlloyEditor.Strings.row},d.createElement("div",{className:"ae-container"},d.createElement("span",{className:o}),d.createElement("span",{className:"ae-icon-arrow"}))),e)},_getCommands:function(){return this.props.commands||[{command:"justifyleft",icon:"align-left",label:AlloyEditor.Strings.alignLeft},{command:"justifycenter",icon:"align-center",label:AlloyEditor.Strings.alignCenter},{command:"justifyright",icon:"align-right",label:AlloyEditor.Strings.alignRight},{command:"justifyblock",icon:"align-justified",label:AlloyEditor.Strings.alignJustify}]}}),AlloyEditor.Buttons[x.key]=AlloyEditor.ButtonParagraphAlign=x,O=gt({displayName:"ButtonParagraphCenter",mixins:[AlloyEditor.ButtonStateClasses,AlloyEditor.ButtonCommand,AlloyEditor.ButtonCommandActive],propTypes:{editor:pt.object.isRequired,label:pt.string,tabIndex:pt.number},statics:{key:"paragraphCenter"},getDefaultProps:function(){return{command:"justifycenter"}},render:function(){var e="ae-button "+this.getStateClasses();return d.createElement("button",{"aria-label":AlloyEditor.Strings.alignCenter,"aria-pressed":-1!==e.indexOf("pressed"),className:e,"data-type":"button-paragraph-center",onClick:this.execCommand,tabIndex:this.props.tabIndex,title:AlloyEditor.Strings.alignCenter},d.createElement("span",{className:"ae-icon-align-center"}))}}),AlloyEditor.Buttons[O.key]=AlloyEditor.ButtonParagraphCenter=O,S=gt({displayName:"ButtonParagraphJustify",mixins:[AlloyEditor.ButtonStateClasses,AlloyEditor.ButtonCommand,AlloyEditor.ButtonCommandActive],propTypes:{editor:pt.object.isRequired,label:pt.string,tabIndex:pt.number},statics:{key:"paragraphJustify"},getDefaultProps:function(){return{command:"justifyblock"}},render:function(){var e="ae-button "+this.getStateClasses();return d.createElement("button",{"aria-label":AlloyEditor.Strings.alignJustify,"aria-pressed":-1!==e.indexOf("pressed"),className:e,"data-type":"button-paragraph-justify",onClick:this.execCommand,tabIndex:this.props.tabIndex,title:AlloyEditor.Strings.alignJustify},d.createElement("span",{className:"ae-icon-align-justified"}))}}),AlloyEditor.Buttons[S.key]=AlloyEditor.ButtonParagraphJustify=S,D=gt({displayName:"ButtonQuote",mixins:[AlloyEditor.ButtonStyle,AlloyEditor.ButtonStateClasses,AlloyEditor.ButtonCommand],propTypes:{editor:pt.object.isRequired,label:pt.string,tabIndex:pt.number},statics:{key:"quote"},getDefaultProps:function(){return{command:"blockquote",style:{element:"blockquote"}}},render:function(){var e="ae-button "+this.getStateClasses();return d.createElement("button",{"aria-label":AlloyEditor.Strings.quote,"aria-pressed":-1!==e.indexOf("pressed"),className:e,"data-type":"button-quote",onClick:this.execCommand,tabIndex:this.props.tabIndex,title:AlloyEditor.Strings.quote},d.createElement("span",{className:"ae-icon-quote"}))}}),AlloyEditor.Buttons[D.key]=AlloyEditor.ButtonQuote=D,w=gt({displayName:"ButtonRemoveFormat",mixins:[AlloyEditor.ButtonCommand],propTypes:{editor:pt.object.isRequired,label:pt.string,tabIndex:pt.number},statics:{key:"removeFormat"},getDefaultProps:function(){return{command:"removeFormat"}},render:function(){return d.createElement("button",{"aria-label":AlloyEditor.Strings.removeformat,className:"ae-button","data-type":"button-removeformat",onClick:this.execCommand,tabIndex:this.props.tabIndex,title:AlloyEditor.Strings.removeformat},d.createElement("span",{className:"ae-icon-removeformat"}))}}),AlloyEditor.Buttons[w.key]=AlloyEditor.ButtonRemoveFormat=w,k=gt({displayName:"Separator",statics:{key:"separator"},render:function(){return d.createElement("span",{className:"ae-separator"})}}),AlloyEditor.Buttons[k.key]=AlloyEditor.Separator=k,I=gt({displayName:"ButtonStrike",mixins:[AlloyEditor.ButtonStyle,AlloyEditor.ButtonStateClasses,AlloyEditor.ButtonCommand],propTypes:{editor:pt.object.isRequired,label:pt.string,tabIndex:pt.number},statics:{key:"strike"},getDefaultProps:function(){return{command:"strike",style:"coreStyles_strike"}},render:function(){var e="ae-button "+this.getStateClasses();return d.createElement("button",{"aria-label":AlloyEditor.Strings.strike,"aria-pressed":-1!==e.indexOf("pressed"),className:e,"data-type":"button-strike",onClick:this.execCommand,tabIndex:this.props.tabIndex,title:AlloyEditor.Strings.strike},d.createElement("span",{className:"ae-icon-strike"}))}}),AlloyEditor.Buttons[I.key]=AlloyEditor.ButtonStrike=I,A=gt({displayName:"ButtonsStylesListHeader",render:function(){return this.props.styles&&this.props.styles.length?d.createElement("span",{className:"ae-list-header"},this.props.name):null}}),AlloyEditor.ButtonsStylesListHeader=A,T=gt({displayName:"ButtonStylesListItemRemove",propTypes:{editor:pt.object.isRequired,label:pt.string,removeBlocks:pt.array,tabIndex:pt.number},statics:{key:"buttonStylesListItemRemove"},getDefaultProps:function(){return{removeBlocks:["h1","h2","h3","h4","h5","h6","pre"]}},render:function(){return d.createElement("li",{role:"option"},d.createElement("button",{className:"ae-toolbar-element",onClick:this._removeStyles,tabIndex:this.props.tabIndex},AlloyEditor.Strings.normal))},_removeStyles:function(){var i=this.props.editor.get("nativeEditor");i.execCommand("removeFormat"),this.props.removeBlocks.forEach(function(e){var t=new CKEDITOR.style({element:e});i.removeStyle(t)}),i.fire("actionPerformed",this)}}),AlloyEditor.ButtonStylesListItemRemove=T,_=gt({displayName:"ButtonStylesListItem",mixins:[AlloyEditor.ButtonStyle,AlloyEditor.ButtonActionStyle],statics:{key:"buttonStylesListItem"},componentWillMount:function(){var e={element:"span",styles:{margin:0}},e=CKEDITOR.tools.merge(e,this.props.style);this._preview=new CKEDITOR.style(e).buildPreview(this.props.name)},render:function(){var e=this.props.name===this.props.activeStyle?"ae-toolbar-element active":"ae-toolbar-element";return d.createElement("button",{className:e,dangerouslySetInnerHTML:{__html:this._preview},onClick:this._onClick,tabIndex:this.props.tabIndex})},_onClick:function(){this.props.styleFn?this.props.styleFn():(this.props.editor.get("nativeEditor").execCommand("removeFormat"),this.applyStyle())}}),AlloyEditor.ButtonStylesListItem=_,C=gt({displayName:"ButtonStylesList",mixins:[AlloyEditor.WidgetFocusManager],statics:{key:"buttonStylesList"},componentDidMount:function(){p.findDOMNode(this).focus()},componentWillMount:function(){var i=[],n=[],o=[];this.props.styles.forEach(function(e){var t=new CKEDITOR.style(e.style);t.type===CKEDITOR.STYLE_BLOCK?i.push(e):t.type===CKEDITOR.STYLE_INLINE?n.push(e):t.type===CKEDITOR.STYLE_OBJECT&&o.push(e)}),this._blockStyles=i,this._inlineStyles=n,this._objectStyles=o},getDefaultProps:function(){return{circular:!1,descendants:".ae-toolbar-element",keys:{dismiss:[27],dismissNext:[39],dismissPrev:[37],next:[40],prev:[38]},showRemoveStylesItem:!0}},render:function(){var e;return this.props.showRemoveStylesItem&&(e=d.createElement(AlloyEditor.ButtonStylesListItemRemove,{editor:this.props.editor,onDismiss:this.props.toggleDropdown})),d.createElement(AlloyEditor.ButtonDropdown,this.props,e,d.createElement(AlloyEditor.ButtonsStylesListHeader,{name:AlloyEditor.Strings.blockStyles,styles:this._blockStyles}),this._renderStylesItems(this._blockStyles),d.createElement(AlloyEditor.ButtonsStylesListHeader,{name:AlloyEditor.Strings.inlineStyles,styles:this._inlineStyles}),this._renderStylesItems(this._inlineStyles),d.createElement(AlloyEditor.ButtonsStylesListHeader,{name:AlloyEditor.Strings.objectStyles,styles:this._objectStyles}),this._renderStylesItems(this._objectStyles))},_renderStylesItems:function(e){var t,i=this.props.editor;return e&&e.length&&(t=e.map(function(e){return d.createElement("li",{key:e.name,role:"option"},d.createElement(AlloyEditor.ButtonStylesListItem,{activeStyle:this.props.activeStyle,editor:i,name:e.name,style:e.style,styleFn:e.styleFn}))}.bind(this))),t}}),AlloyEditor.ButtonStylesList=C,v=gt({displayName:"ButtonStyles",propTypes:{editor:pt.object.isRequired,expanded:pt.bool,label:pt.string,showRemoveStylesItem:pt.bool,styles:pt.arrayOf(pt.object),tabIndex:pt.number,toggleDropdown:pt.func},statics:{key:"styles"},render:function(){var e,t=AlloyEditor.Strings.normal,i=this._getStyles();return i.forEach(function(e){this._checkActive(e.style)&&(t=e.name)}.bind(this)),this.props.expanded&&(e=d.createElement(AlloyEditor.ButtonStylesList,{activeStyle:t,editor:this.props.editor,onDismiss:this.props.toggleDropdown,showRemoveStylesItem:this.props.showRemoveStylesItem,styles:i})),d.createElement("div",{className:"ae-container-dropdown ae-has-dropdown"},d.createElement("button",{"aria-expanded":this.props.expanded,"aria-label":AlloyEditor.Strings.styles+" "+t,className:"ae-toolbar-element",onClick:this.props.toggleDropdown,role:"combobox",tabIndex:this.props.tabIndex,title:AlloyEditor.Strings.styles+" "+t},d.createElement("div",{className:"ae-container"},d.createElement("span",{className:"ae-container-dropdown-selected-item"},t),d.createElement("span",{className:"ae-icon-arrow"}))),e)},_checkActive:function(e){var t=this.props.editor.get("nativeEditor");return e=CKEDITOR.tools.merge({element:"span"},e),new CKEDITOR.style(e).checkActive(t.elementPath(),t)},_getStyles:function(){return this.props.styles||[{name:AlloyEditor.Strings.h1,style:{element:"h1"}},{name:AlloyEditor.Strings.h2,style:{element:"h2"}},{name:AlloyEditor.Strings.formatted,style:{element:"pre"}},{name:AlloyEditor.Strings.cite,style:{element:"cite"}},{name:AlloyEditor.Strings.code,style:{element:"code"}}]}}),AlloyEditor.Buttons[v.key]=AlloyEditor.ButtonStyles=v,b=gt({displayName:"ButtonSubscript",mixins:[AlloyEditor.ButtonStyle,AlloyEditor.ButtonStateClasses,AlloyEditor.ButtonCommand],propTypes:{editor:pt.object.isRequired,label:pt.string,tabIndex:pt.number},statics:{key:"subscript"},getDefaultProps:function(){return{command:"subscript",style:"coreStyles_subscript"}},render:function(){var e="ae-button "+this.getStateClasses();return d.createElement("button",{"aria-label":AlloyEditor.Strings.subscript,"aria-pressed":-1!==e.indexOf("pressed"),className:e,"data-type":"button-subscript",onClick:this.execCommand,tabIndex:this.props.tabIndex,title:AlloyEditor.Strings.subscript},d.createElement("span",{className:"ae-icon-subscript"}))}}),AlloyEditor.Buttons[b.key]=AlloyEditor.ButtonSubscript=b,E=gt({displayName:"ButtonSuperscript",mixins:[AlloyEditor.ButtonStyle,AlloyEditor.ButtonStateClasses,AlloyEditor.ButtonCommand],propTypes:{editor:pt.object.isRequired,label:pt.string,tabIndex:pt.number},statics:{key:"superscript"},getDefaultProps:function(){return{command:"superscript",style:"coreStyles_superscript"}},render:function(){var e="ae-button "+this.getStateClasses();return d.createElement("button",{"aria-label":AlloyEditor.Strings.superscript,"aria-pressed":-1!==e.indexOf("pressed"),className:e,"data-type":"button-superscript",onClick:this.execCommand,tabIndex:this.props.tabIndex,title:AlloyEditor.Strings.superscript},d.createElement("span",{className:"ae-icon-superscript"}))}}),AlloyEditor.Buttons[E.key]=AlloyEditor.ButtonSuperscript=E,y=gt({displayName:"ButtonTableCell",propTypes:{commands:pt.arrayOf(pt.object),editor:pt.object.isRequired,expanded:pt.bool,label:pt.string,tabIndex:pt.number,toggleDropdown:pt.func},statics:{key:"tableCell"},render:function(){var e,t;return this.props.expanded&&(t=y.key+"List",e=d.createElement(AlloyEditor.ButtonCommandsList,{commands:this._getCommands(),editor:this.props.editor,listId:t,onDismiss:this.props.toggleDropdown})),d.createElement("div",{className:"ae-container ae-has-dropdown"},d.createElement("button",{"aria-expanded":this.props.expanded,"aria-label":AlloyEditor.Strings.cell,"aria-owns":t,className:"ae-button",onClick:this.props.toggleDropdown,tabIndex:this.props.tabIndex,title:AlloyEditor.Strings.cell},d.createElement("span",{className:"ae-icon-cell"})),e)},_getCommands:function(){return this.props.commands||[{command:"cellInsertBefore",label:AlloyEditor.Strings.cellInsertBefore},{command:"cellInsertAfter",label:AlloyEditor.Strings.cellInsertAfter},{command:"cellDelete",label:AlloyEditor.Strings.cellDelete},{command:"cellMerge",label:AlloyEditor.Strings.cellMerge},{command:"cellMergeDown",label:AlloyEditor.Strings.cellMergeDown},{command:"cellMergeRight",label:AlloyEditor.Strings.cellMergeRight},{command:"cellHorizontalSplit",label:AlloyEditor.Strings.cellSplitHorizontal},{command:"cellVerticalSplit",label:AlloyEditor.Strings.cellSplitVertical}]}}),AlloyEditor.Buttons[y.key]=AlloyEditor.ButtonTableCell=y,f=gt({displayName:"ButtonTableColumn",propTypes:{commands:pt.arrayOf(pt.object),editor:pt.object.isRequired,expanded:pt.bool,label:pt.string,tabIndex:pt.number,toggleDropdown:pt.func},statics:{key:"tableColumn"},render:function(){var e,t;return this.props.expanded&&(t=f.key+"List",e=d.createElement(AlloyEditor.ButtonCommandsList,{commands:this._getCommands(),editor:this.props.editor,listId:t,onDismiss:this.props.toggleDropdown})),d.createElement("div",{className:"ae-container ae-has-dropdown"},d.createElement("button",{"aria-expanded":this.props.expanded,"aria-label":AlloyEditor.Strings.column,"aria-owns":t,className:"ae-button",onClick:this.props.toggleDropdown,role:"listbox",tabIndex:this.props.tabIndex,title:AlloyEditor.Strings.column},d.createElement("span",{className:"ae-icon-column"})),e)},_getCommands:function(){return this.props.commands||[{command:"columnInsertBefore",label:AlloyEditor.Strings.columnInsertBefore},{command:"columnInsertAfter",label:AlloyEditor.Strings.columnInsertAfter},{command:"columnDelete",label:AlloyEditor.Strings.columnDelete}]}}),AlloyEditor.Buttons[f.key]=AlloyEditor.ButtonTableColumn=f,h=gt({displayName:"ButtonTableEdit",propTypes:{cancelExclusive:pt.func.isRequired,editor:pt.object.isRequired},statics:{key:"tableEdit"},getDefaultProps:function(){return{tableAttributes:{border:1,cellPadding:0,cellSpacing:0,style:"width: 100%"}}},componentDidMount:function(){p.findDOMNode(this.refs.rows).focus()},getInitialState:function(){return{cols:3,rows:3}},_createTable:function(){var e=this.props.editor.get("nativeEditor");new CKEDITOR.Table(e).create({attrs:this.props.tableAttributes,cols:this.state.cols,rows:this.state.rows}),this.props.cancelExclusive(),e.fire("actionPerformed",this)},_handleChange:function(e,t){var i={};i[e]=t.target.value,this.setState(i)},_handleKeyDown:function(e){13!==e.keyCode&&27!==e.keyCode||e.preventDefault(),13===e.keyCode?this._createTable():27===e.keyCode&&this.props.cancelExclusive()},render:function(){var e=Date.now(),t=e+"rows",i=e+"cols";return d.createElement("div",{className:"ae-container-edit-table"},d.createElement("label",{htmlFor:t},AlloyEditor.Strings.rows),d.createElement("div",{className:"ae-container-input small"},d.createElement("input",{className:"ae-input",id:t,onChange:this._handleChange.bind(this,"rows"),min:"1",onKeyDown:this._handleKeyDown,placeholder:"Rows",ref:"rows",type:"number",value:this.state.rows})),d.createElement("label",{htmlFor:i},AlloyEditor.Strings.columns),d.createElement("div",{className:"ae-container-input small"},d.createElement("input",{className:"ae-input",id:i,onChange:this._handleChange.bind(this,"cols"),min:"1",onKeyDown:this._handleKeyDown,placeholder:"Colums",ref:"cols",type:"number",value:this.state.cols})),d.createElement("button",{"aria-label":"Confirm",className:"ae-button",onClick:this._createTable},d.createElement("span",{className:"ae-icon-ok"})))}}),AlloyEditor.Buttons[h.key]=AlloyEditor.ButtonTableEdit=h,g=gt({displayName:"ButtonTableHeading",propTypes:{commands:pt.arrayOf(pt.object),editor:pt.object.isRequired,expanded:pt.bool,label:pt.string,tabIndex:pt.number,toggleDropdown:pt.func},statics:{key:"tableHeading"},render:function(){var e,t;this.props.expanded&&(t=g.key+"List",e=d.createElement(AlloyEditor.ButtonCommandsList,{commands:this._getCommands(),editor:this.props.editor,listId:t,onDismiss:this.props.toggleDropdown}));var i=new CKEDITOR.Table(this.props.editor.get("nativeEditor")).getHeading(),n=AlloyEditor.Strings.headers+":",o=AlloyEditor.Strings["headers"+i];return d.createElement("div",{className:"ae-container-dropdown-xl ae-has-dropdown"},d.createElement("button",{"aria-expanded":this.props.expanded,"aria-label":"",className:"ae-toolbar-element",onClick:this.props.toggleDropdown,role:"combobox",tabIndex:this.props.tabIndex,title:""},d.createElement("div",{className:"ae-container"},d.createElement("span",{className:"ae-container-dropdown-selected-item"},n," ",d.createElement("strong",null,o)),d.createElement("span",{className:"ae-icon-arrow"}))),e)},_getCommands:function(){return this.props.commands||[{command:"tableHeadingNone",label:AlloyEditor.Strings.headersNone},{command:"tableHeadingRow",label:AlloyEditor.Strings.headersRow},{command:"tableHeadingColumn",label:AlloyEditor.Strings.headersColumn},{command:"tableHeadingBoth",label:AlloyEditor.Strings.headersBoth}]}}),AlloyEditor.Buttons[g.key]=AlloyEditor.ButtonTableHeading=g,m=gt({displayName:"ButtonTableRemove",propTypes:{editor:pt.object.isRequired,label:pt.string,tabIndex:pt.number},statics:{key:"tableRemove"},render:function(){return d.createElement("button",{"aria-label":AlloyEditor.Strings.deleteTable,className:"ae-button","data-type":"button-table-remove",onClick:this._removeTable,tabIndex:this.props.tabIndex,title:AlloyEditor.Strings.deleteTable},d.createElement("span",{className:"ae-icon-bin"}))},_removeTable:function(){var e=this.props.editor.get("nativeEditor");new CKEDITOR.Table(e).remove(),e.fire("actionPerformed",this)}}),AlloyEditor.Buttons[m.key]=AlloyEditor.ButtonTableRemove=m,u=gt({displayName:"ButtonTableRow",propTypes:{commands:pt.arrayOf(pt.object),editor:pt.object.isRequired,expanded:pt.bool,label:pt.string,tabIndex:pt.number,toggleDropdown:pt.func},statics:{key:"tableRow"},render:function(){var e,t;return this.props.expanded&&(t=u.key+"List",e=d.createElement(AlloyEditor.ButtonCommandsList,{commands:this._getCommands(),editor:this.props.editor,listId:t,onDismiss:this.props.toggleDropdown})),d.createElement("div",{className:"ae-container ae-has-dropdown"},d.createElement("button",{"aria-expanded":this.props.expanded,"aria-label":AlloyEditor.Strings.row,"aria-owns":t,className:"ae-button",onClick:this.props.toggleDropdown,role:"combobox",tabIndex:this.props.tabIndex,title:AlloyEditor.Strings.row},d.createElement("span",{className:"ae-icon-row"})),e)},_getCommands:function(){return this.props.commands||[{command:"rowInsertBefore",label:AlloyEditor.Strings.rowInsertBefore},{command:"rowInsertAfter",label:AlloyEditor.Strings.rowInsertAfter},{command:"rowDelete",label:AlloyEditor.Strings.rowDelete}]}}),AlloyEditor.Buttons[u.key]=AlloyEditor.ButtonTableRow=u,c=gt({displayName:"ButtonTable",propTypes:{editor:pt.object.isRequired,label:pt.string,tabIndex:pt.number},statics:{key:"table"},render:function(){return this.props.renderExclusive?d.createElement(AlloyEditor.ButtonTableEdit,this.props):d.createElement("button",{"aria-label":AlloyEditor.Strings.table,className:"ae-button","data-type":"button-table",onClick:this.props.requestExclusive,tabIndex:this.props.tabIndex,title:AlloyEditor.Strings.table},d.createElement("span",{className:"ae-icon-table"}))}}),AlloyEditor.Buttons[c.key]=AlloyEditor.ButtonTable=c,r=gt({displayName:"ButtonTargetList",mixins:[AlloyEditor.WidgetFocusManager],propTypes:{editor:pt.object.isRequired},statics:{key:"targetList"},componentDidMount:function(){p.findDOMNode(this).focus()},getDefaultProps:function(){return{circular:!0,descendants:".ae-toolbar-element",keys:{dismiss:[27],dismissNext:[39],dismissPrev:[37],next:[40],prev:[38]}}},render:function(){var e=this._renderListTargets();return d.createElement(AlloyEditor.ButtonDropdown,this.props,e)},_getAllowedTargetItems:function(){return this.props.allowedLinkTargets||[{label:AlloyEditor.Strings.linkTargetDefault,value:""},{label:AlloyEditor.Strings.linkTargetSelf,value:"_self"},{label:AlloyEditor.Strings.linkTargetBlank,value:"_blank"},{label:AlloyEditor.Strings.linkTargetParent,value:"_parent"},{label:AlloyEditor.Strings.linkTargetTop,value:"_top"}]},_renderListTargets:function(){var e=this._getAllowedTargetItems(),i=this.props.handleLinkTargetChange;return e=e.map(function(e){var t=this.props.selectedTarget===e.value?"ae-toolbar-element active":"ae-toolbar-element";return d.createElement("li",{key:e.value,role:"option"},d.createElement("button",{className:t,"data-value":e.value,onClick:i},e.label))}.bind(this))}}),AlloyEditor.Buttons[r.key]=AlloyEditor.ButtonTargetList=r,a=gt({displayName:"ButtonTwitter",mixins:[AlloyEditor.ButtonStateClasses],propTypes:{editor:pt.object.isRequired,label:pt.string,tabIndex:pt.number},statics:{key:"twitter"},handleClick:function(){var e=this.props.editor.get("nativeEditor"),t=new CKEDITOR.Link(e);this.isActive()?t.remove(t.getFromSelection()):t.create(this._getHref(),{class:"ae-twitter-link",target:"_blank"}),e.fire("actionPerformed",this)},isActive:function(){var e=new CKEDITOR.Link(this.props.editor.get("nativeEditor")).getFromSelection();return e&&-1!==e.getAttribute("href").indexOf("twitter.com/intent/tweet")},render:function(){var e="ae-button "+this.getStateClasses();return d.createElement("button",{"aria-label":AlloyEditor.Strings.twitter,className:e,"data-type":"button-twitter",onClick:this.handleClick,tabIndex:this.props.tabIndex,title:AlloyEditor.Strings.twitter},d.createElement("span",{className:"ae-icon-twitter"}))},_getHref:function(){var e=this.props.editor.get("nativeEditor").getSelection().getSelectedText().substring(0,280),t=this.props.url,i=this.props.via,n="https://twitter.com/intent/tweet?text="+e;return t&&(n+="&url="+t),i&&(n+="&via="+i),n}}),AlloyEditor.Buttons[a.key]=AlloyEditor.ButtonTwitter=a,o=gt({displayName:"ButtonUnorderedlist",mixins:[AlloyEditor.ButtonStyle,AlloyEditor.ButtonStateClasses,AlloyEditor.ButtonCommand],propTypes:{editor:pt.object.isRequired,label:pt.string,tabIndex:pt.number},statics:{key:"ul"},getDefaultProps:function(){return{command:"bulletedlist",style:{element:"ul"}}},render:function(){var e="ae-button "+this.getStateClasses();return d.createElement("button",{"aria-label":AlloyEditor.Strings.bulletedlist,"aria-pressed":-1!==e.indexOf("pressed"),className:e,"data-type":"button-ul",onClick:this.execCommand,tabIndex:this.props.tabIndex,title:AlloyEditor.Strings.bulletedlist},d.createElement("span",{className:"ae-icon-bulleted-list"}))}}),AlloyEditor.Buttons[o.key]=AlloyEditor.ButtonUnorderedlist=o,n=gt({displayName:"ButtonUnderline",mixins:[AlloyEditor.ButtonStyle,AlloyEditor.ButtonStateClasses,AlloyEditor.ButtonCommand,AlloyEditor.ButtonKeystroke],propTypes:{editor:pt.object.isRequired,label:pt.string,tabIndex:pt.number},statics:{key:"underline"},getDefaultProps:function(){return{command:"underline",keystroke:{fn:"execCommand",keys:CKEDITOR.CTRL+85},style:"coreStyles_underline"}},render:function(){var e="ae-button "+this.getStateClasses();return d.createElement("button",{"aria-label":AlloyEditor.Strings.underline,"aria-pressed":-1!==e.indexOf("pressed"),className:e,"data-type":"button-underline",onClick:this.execCommand,tabIndex:this.props.tabIndex,title:AlloyEditor.Strings.underline},d.createElement("span",{className:"ae-icon-underline"}))}}),AlloyEditor.Buttons[n.key]=AlloyEditor.ButtonUnderline=n,i=gt({displayName:"ToolbarAdd",mixins:[AlloyEditor.WidgetDropdown,AlloyEditor.WidgetExclusive,AlloyEditor.WidgetFocusManager,AlloyEditor.ToolbarButtons,AlloyEditor.WidgetPosition,AlloyEditor.WidgetArrowBox],propTypes:{config:pt.object,editor:pt.object.isRequired,editorEvent:pt.object,gutterExclusive:pt.object,label:pt.string,onDismiss:pt.func,position:pt.oneOf([1,2]),selectionData:pt.object},statics:{key:"add",left:1,right:2},getDefaultProps:function(){return{circular:!0,descendants:".ae-button",gutterExclusive:{left:10,top:0},keys:{dismiss:[27],next:[39,40],prev:[37,38]},position:1}},componentDidMount:function(){this._updatePosition()},componentDidUpdate:function(){this._updatePosition(),this.props.renderExclusive&&this.focus()},render:function(){if(!this.state.itemExclusive&&this.props.editorEvent&&this.props.editorEvent.data.nativeEvent.target&&!this.props.editorEvent.data.nativeEvent.target.isContentEditable)return null;var e=this._getButtons(),t=this._getToolbarClassName();return d.createElement("div",{"aria-label":AlloyEditor.Strings.add,className:t,"data-tabindex":this.props.config.tabIndex||0,onFocus:this.focus,onKeyDown:this.handleKey,role:"toolbar",tabIndex:"-1"},d.createElement("div",{className:"ae-container"},e))},_getButtons:function(){var e;return this.props.renderExclusive?e=this.getToolbarButtons(this.props.config.buttons):this.props.selectionData&&this.props.selectionData.region&&(e=d.createElement("button",{"aria-label":AlloyEditor.Strings.add,className:"ae-button ae-button-add",onClick:this.props.requestExclusive.bind(this,i.key),title:AlloyEditor.Strings.add},d.createElement("span",{className:"ae-icon-add"}))),e},_getToolbarClassName:function(){var e="ae-toolbar-add";return this.props.renderExclusive&&(e="ae-toolbar "+this.getArrowBoxClasses()),e},_updatePosition:function(){var e,t,i,n,o,a,r,s,l;p.findDOMNode(this)&&(this.props.renderExclusive?(this.updatePosition(),this.show()):(this.props.selectionData&&(e=this.props.selectionData.region),e&&(t=p.findDOMNode(this),i=new CKEDITOR.dom.element(t),n=e.startRect||e,a=(o=this.props.editor.get("nativeEditor")).editable().getClientRect(),r=1===(this.props.config.position||this.props.position)?a.left-t.offsetWidth-this.props.gutterExclusive.left+"px":a.right+this.props.gutterExclusive.left+"px",t.style.left=r,t.style.top=Math.floor((e.bottom+e.top)/2)+"px",l=(s=this.props.editor.get("uiNode"))?s.scrollTop:0,"auto"!==o.element.getStyle("overflow")?t.style.top=Math.floor(e.top-t.offsetHeight/2+n.height/2+l)+"px":t.style.top=Math.floor(o.element.$.offsetTop+n.height/2-t.offsetHeight/2)+"px",t.style.opacity=1,i.removeClass("ae-arrow-box"),this.cancelAnimation())))}}),AlloyEditor.Toolbars[i.key]=AlloyEditor.ToolbarAdd=i,s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t=gt({displayName:"ToolbarStyles",mixins:[AlloyEditor.WidgetDropdown,AlloyEditor.WidgetExclusive,AlloyEditor.WidgetFocusManager,AlloyEditor.ToolbarButtons,AlloyEditor.WidgetPosition,AlloyEditor.WidgetArrowBox],propTypes:{config:pt.object,editor:pt.object.isRequired,editorEvent:pt.object,label:pt.string,onDismiss:pt.func,selectionData:pt.object},statics:{key:"styles"},componentDidMount:function(){this._updatePosition()},componentDidUpdate:function(){this._updatePosition()},getDefaultProps:function(){return{circular:!0,descendants:".ae-input, .ae-button:not([disabled]), .ae-toolbar-element",keys:{dismiss:[27],next:[39,40],prev:[37,38]}}},render:function(){var e=this._getCurrentSelection();if(e){var t=this._getSelectionFunction(e.getArrowBoxClasses),i=t?t():this.getArrowBoxClasses(),n="ae-toolbar-styles "+i,o=e.buttons;"object"!==(void 0===o?"undefined":s(o))||Array.isArray(o)||(o=o[this.props.editor.get("mode")]||o.simple);var a=this.getToolbarButtonGroups(o,{manualSelection:this.props.editorEvent?this.props.editorEvent.data.manualSelection:null,selectionType:e.name}),r="ae-container";return 0<a.filter(function(e){return Array.isArray(e)}).length&&(r+=" ae-container-column"),d.createElement("div",{"aria-label":AlloyEditor.Strings.styles,className:n,"data-tabindex":this.props.config.tabIndex||0,onFocus:this.focus,onKeyDown:this.handleKey,role:"toolbar",tabIndex:"-1"},d.createElement("div",{className:r},a.map(function(e,t){return Array.isArray(e)?d.createElement("div",{className:"ae-row",key:t.toString()},e.map(function(e){return e})):e})))}return null},_getSelectionFunction:function(e){var t,i=AlloyEditor.Lang;if(i.isFunction(e))t=e;else if(i.isString(e)){for(var n=e.split("."),o=window,a=n.shift();a&&i.isObject(o)&&i.isObject(o[a]);)o=o[a],a=n.shift();i.isFunction(o)&&(t=o)}return t},_getCurrentSelection:function(){var n,o=this.props.editorEvent?this.props.editorEvent.data:null;return o&&this.props.config.selections.some(function(e){var t,i=this._getSelectionFunction(e.test);return i&&(t=o.manualSelection===e.name||i({data:o,editor:this.props.editor})),t&&(n=e),t},this),n},_updatePosition:function(){var e,t,i;p.findDOMNode(this)&&(!(e=this._getCurrentSelection())||(i=this._getSelectionFunction(e.setPosition))&&(t=i.call(this,{editor:this.props.editor,editorEvent:this.props.editorEvent,selectionData:this.props.selectionData})),t||(this.updatePosition(),this.show()))}}),AlloyEditor.Toolbars[t.key]=AlloyEditor.ToolbarStyles=t,e=gt({displayName:"UI",mixins:[AlloyEditor.WidgetExclusive,AlloyEditor.WidgetFocusManager],propTypes:{ariaUpdates:pt.object,editor:pt.object.isRequired,eventsDelay:pt.number,toolbars:pt.object.isRequired},getInitialState:function(){return{hidden:!1}},getDefaultProps:function(){return{circular:!0,descendants:"[class^=ae-toolbar-]",eventsDelay:0,keys:{next:9}}},componentDidMount:function(){var e=this.props.editor.get("nativeEditor");e.on("editorInteraction",this._onEditorInteraction,this),e.on("actionPerformed",this._onActionPerformed,this),e.on("key",this._onEditorKey,this),this._mousedownListener=function(e){this._setUIHidden(e.target)}.bind(this),this._keyDownListener=CKEDITOR.tools.debounce(function(e){this._setUIHidden(document.activeElement)},this.props.eventsDelay,this),document.addEventListener("mousedown",this._mousedownListener),document.addEventListener("keydown",this._keyDownListener)},componentDidUpdate:function(e,t){var i=p.findDOMNode(this),n=this.props.editor.get("nativeEditor");i&&n.fire("ariaUpdate",{message:this._getAvailableToolbarsMessage(i)}),n.fire("editorUpdate",{prevProps:e,prevState:t,props:this.props,state:this.state})},_getAriaUpdateTemplate:function(e){return this._ariaUpdateTemplates||(this._ariaUpdateTemplates={}),this._ariaUpdateTemplates[e]||(this._ariaUpdateTemplates[e]=new CKEDITOR.template(this._getAriaUpdates()[e])),this._ariaUpdateTemplates[e]},_getAriaUpdates:function(){return this.props.ariaUpdates||{noToolbar:AlloyEditor.Strings.ariaUpdateNoToolbar,oneToolbar:AlloyEditor.Strings.ariaUpdateOneToolbar,manyToolbars:AlloyEditor.Strings.ariaUpdateManyToolbars}},_getAvailableToolbarsMessage:function(e){var t=e.querySelectorAll('[role="toolbar"]');if(t.length){var i=Array.prototype.slice.call(t).map(function(e){return e.getAttribute("aria-label")}),n=1===i.length?"oneToolbar":"manyToolbars";return this._getAriaUpdateTemplate(n).output({toolbars:i.join(",").replace(/,([^,]*)$/," and $1")})}return this._getAriaUpdates().noToolbar},componentWillUnmount:function(){this._mousedownListener&&document.removeEventListener("mousedown",this._mousedownListener),this._keyDownListener&&(this._keyDownListener.detach(),document.removeEventListener("keydown",this._keyDownListener))},render:function(){if(this.state.hidden)return null;var e=Object.keys(this.props.toolbars).map(function(e){return AlloyEditor.Toolbars[e]||window[e]}),e=this.filterExclusive(e).map(function(e){var t=this.mergeExclusiveProps({config:this.props.toolbars[e.key],editor:this.props.editor,editorEvent:this.state.editorEvent,key:e.key,onDismiss:this._onDismissToolbarFocus,selectionData:this.state.selectionData},e.key);return d.createElement(e,t)}.bind(this));return d.createElement("div",{className:"ae-toolbars",onKeyDown:this.handleKey},e)},_onActionPerformed:function(){var e=this.props.editor.get("nativeEditor");e.focus(),this.setState({itemExclusive:null,selectionData:e.getSelectionData()})},_onDismissToolbarFocus:function(){this.props.editor.get("nativeEditor").focus()},_onEditorInteraction:function(e){this.setState({editorEvent:e,hidden:!1,itemExclusive:null,selectionData:e.data.selectionData})},_onEditorKey:function(e){var t=e.data.domEvent.$;t.altKey&&121===t.keyCode&&this.focus()},_setUIHidden:function(e){var t,i,n,o,a=p.findDOMNode(this);a&&(t=this.props.editor.get("nativeEditor").editable(),i=e.parentNode,n=new CKEDITOR.dom.node(e),t?(o=t.$===e||t.contains(n)||new CKEDITOR.dom.element(a).contains(n),i&&(o=o||"ckimgrsz"===i.id),o||this.setState({hidden:!0})):this.setState({hidden:!0}))}}),AlloyEditor.UI=e)}();
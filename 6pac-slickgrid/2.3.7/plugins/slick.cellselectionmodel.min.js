!function(e){function l(l){function n(n){d=e.extend(!0,{},R,l),w=(u=n).getCanvasNode(),u.onActiveCellChanged.subscribe(a),u.onKeyDown.subscribe(g),n.registerPlugin(h),h.onCellRangeSelected.subscribe(s),h.onBeforeCellRangeSelected.subscribe(r)}function o(){u.onActiveCellChanged.unsubscribe(a),u.onKeyDown.unsubscribe(g),h.onCellRangeSelected.unsubscribe(s),h.onBeforeCellRangeSelected.unsubscribe(r),u.unregisterPlugin(h)}function t(e){for(var l=[],n=0;n<e.length;n++){var o=e[n];u.canCellBeSelected(o.fromRow,o.fromCell)&&u.canCellBeSelected(o.toRow,o.toCell)&&l.push(o)}return l}function c(e){(f&&0!==f.length||e&&0!==e.length)&&(f=t(e),C.onSelectedRangesChanged.notify(f))}function i(){return f}function r(e,l){if(u.getEditorLock().isActive())return e.stopPropagation(),!1}function s(e,l){u.setActiveCell(l.range.fromRow,l.range.fromCell,!1,!1,!0),c([l.range])}function a(e,l){d.selectActiveCell&&null!=l.row&&null!=l.cell&&c([new Slick.Range(l.row,l.cell)])}function g(e){var l,n,o=u.getActiveCell(),r=e.ctrlKey||e.metaKey;if(o&&e.shiftKey&&!r&&!e.altKey&&(37==e.which||39==e.which||38==e.which||40==e.which)){(l=i()).length||l.push(new Slick.Range(o.row,o.cell)),(n=l.pop()).contains(o.row,o.cell)||(n=new Slick.Range(o.row,o.cell));var s=n.toRow-n.fromRow,a=n.toCell-n.fromCell,g=o.row==n.fromRow?1:-1,w=o.cell==n.fromCell?1:-1;37==e.which?a-=w:39==e.which?a+=w:38==e.which?s-=g:40==e.which&&(s+=g);var h=new Slick.Range(o.row,o.cell,o.row+g*s,o.cell+w*a);if(t([h]).length){l.push(h);var f=g>0?h.toRow:h.fromRow,C=w>0?h.toCell:h.fromCell;u.scrollRowIntoView(f),u.scrollCellIntoView(f,C)}else l.push(n);c(l),e.preventDefault(),e.stopPropagation()}}var u,w,h,f=[],C=this;h=void 0===l||void 0===l.cellRangeSelector?new Slick.CellRangeSelector({selectionCss:{border:"2px solid black"}}):l.cellRangeSelector;var d,R={selectActiveCell:!0};e.extend(this,{getSelectedRanges:i,setSelectedRanges:c,init:n,destroy:o,onSelectedRangesChanged:new Slick.Event})}e.extend(!0,window,{Slick:{CellSelectionModel:l}})}(jQuery);
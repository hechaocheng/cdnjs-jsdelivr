"use strict";if("undefined"==typeof jQuery)throw new Error("SlickGrid requires jquery module to be loaded");if(!jQuery.fn.drag)throw new Error("SlickGrid requires jquery.event.drag module to be loaded");!function(e){function t(){var e=null;this.isActive=function(t){return t?e===t:null!==e},this.activate=function(t){if(t!==e){if(null!==e)throw"SlickGrid.EditorLock.activate: an editController is still active, can't activate another editController";if(!t.commitCurrentEdit)throw"SlickGrid.EditorLock.activate: editController must implement .commitCurrentEdit()";if(!t.cancelCurrentEdit)throw"SlickGrid.EditorLock.activate: editController must implement .cancelCurrentEdit()";e=t}},this.deactivate=function(t){if(e!==t)throw"SlickGrid.EditorLock.deactivate: specified editController is not the currently active one";e=null},this.commitCurrentEdit=function(){return!e||e.commitCurrentEdit()},this.cancelCurrentEdit=function(){return!e||e.cancelCurrentEdit()}}var o;e.extend(!0,window,{Slick:{Grid:function(t,n,r,l){function a(){var t=e("<div style='position:absolute; top:-10000px; left:-10000px; width:100px; height:100px; overflow:scroll;'></div>").appendTo("body"),i={width:t.width()-t[0].clientWidth,height:t.height()-t[0].clientHeight};return t.remove(),i}function s(){Ye=_e.width()>Xe-o.width}function d(e){e&&e.jquery&&e.attr("unselectable","on").css("MozUserSelect","none").bind("selectstart.ui",function(){return!1})}function c(){return Te.length}function u(e){return Te[e]}function h(){for(var t=0,i=e.browser.mozilla?5e6:1e9,o=e("<div style='display:none' />").appendTo(document.body);t<=i&&(o.css("height",t+1e6),o.height()===t+1e6);)t+=1e6;return o.remove(),t}function f(){for(var t=_e[0];(t=t.parentNode)!=document.body;)t!=je[0]&&t.scrollWidth==t.clientWidth&&t.scrollHeight==t.clientHeight||e(t).bind("scroll.slickgrid",Ce)}function v(){_e.parents().unbind("scroll.slickgrid")}function g(){var t;for(t=0;t<r.length;t++){var i=r[t]=e.extend({},dt,r[t]);Ht[i.id]=t;var o=e("<div class='ui-state-default slick-header-column' cell="+t+" id='"+i.id+"' />").html("<span class='slick-column-name'>"+i.name+"</span>").width(i.width-$e).attr("title",i.toolTip||i.name).appendTo(Be);i.hidden&&o.css("display","none"),(l.enableColumnReorder||i.sortable)&&o.hover(function(){e(this).addClass("ui-state-hover")},function(){e(this).removeClass("ui-state-hover")}),i.sortable&&o.append("<span class='slick-sort-indicator' />")}p(),b(),l.enableColumnReorder&&w()}function m(e,t){Be.children().removeClass("slick-header-column-sorted"),Be.find(".slick-sort-indicator").removeClass("slick-sort-indicator-asc slick-sort-indicator-desc"),e&&(e.addClass("slick-header-column-sorted"),e.find(".slick-sort-indicator").addClass(t?"slick-sort-indicator-asc":"slick-sort-indicator-desc"))}function p(){Be.click(function(t){if(!e(t.target).hasClass("slick-resizable-handle")){var i=e(t.target).closest(".slick-header-column");i.length&&r[Ht[i.attr("id")]].sortable&&l.editorLock.commitCurrentEdit()&&(i.is(".slick-header-column-sorted")?i.find(".slick-sort-indicator").toggleClass("slick-sort-indicator-asc").toggleClass("slick-sort-indicator-desc"):m(i,!0),vt.onSort&&vt.onSort(r[Ht[i.attr("id")]],i.find(".slick-sort-indicator").hasClass("slick-sort-indicator-asc")))}})}function C(){var e=Be.sortable("toArray"),t={};for(i=0;i<r.length;i++)t[r[i].id]=r[i];for(i=0;i<e.length;i++)Be.children()[i].setAttribute("cell",i),Ht[e[i]]=i,r[i]=t[e[i]];F(),M(),x(),Y()}function w(){Be.sortable({containment:"parent",axis:"x",cursor:"default",tolerance:"intersection",helper:"clone",placeholder:"slick-sortable-placeholder ui-state-default slick-header-column",forcePlaceholderSize:!0,start:function(t,i){e(i.helper).addClass("slick-header-column-active")},beforeStop:function(t,i){e(i.helper).removeClass("slick-header-column-active")},stop:function(t){l.editorLock.commitCurrentEdit()?(C(),vt.onColumnsReordered&&vt.onColumnsReordered(),t.stopPropagation(),b()):e(this).sortable("cancel")}})}function b(){var t,i,o,n,a,d,c,u,h,f;(a=Be.find(".slick-header-column:visible")).find(".slick-resizable-handle").remove(),a.each(function(e,t){(o=r[t.getAttribute("cell")]).resizable&&(void 0===u&&(u=e),h=e)}),a.each(function(v,g){void 0!==u&&v<u||l.forceFitColumns&&v>=h||(t=e(g),e("<div class='slick-resizable-handle' />").appendTo(g).bind("dragstart",function(t){if(!l.editorLock.commitCurrentEdit())return!1;n=t.pageX,e(this).parent().addClass("slick-header-column-active");var s=null,u=null;if(a.each(function(t,i){r[i.getAttribute("cell")].previousWidth=e(i).outerWidth()}),l.forceFitColumns)for(s=0,u=0,i=v+1;i<a.length;i++)(o=r[a[i].getAttribute("cell")]).resizable&&(null!==u&&(o.maxWidth?u+=o.maxWidth-o.previousWidth:u=null),s+=o.previousWidth-Math.max(o.minWidth||0,tt));var h=0,g=0;for(i=0;i<=v;i++)(o=r[a[i].getAttribute("cell")]).resizable&&(null!==g&&(o.maxWidth?g+=o.maxWidth-o.previousWidth:g=null),h+=o.previousWidth-Math.max(o.minWidth||0,tt));null===s&&(s=1e5),null===h&&(h=1e5),null===u&&(u=1e5),null===g&&(g=1e5),c=n+Math.min(s,g),d=n-Math.min(h,u),f=_e.width()}).bind("drag",function(e){var t,u,h,g=Math.min(c,Math.max(d,e.pageX))-n;if(g<0){for(u=g,i=v;i>=0;i--)h=a[i].getAttribute("cell"),(o=r[h]).resizable&&(t=Math.max(o.minWidth||0,tt),u&&o.previousWidth+u<t?(u+=o.previousWidth-t,W(h,t,l.syncColumnCellResize)):(W(h,o.previousWidth+u,l.syncColumnCellResize),u=0));if(l.forceFitColumns)for(u=-g,i=v+1;i<a.length;i++)h=a[i].getAttribute("cell"),(o=r[h]).resizable&&(u&&o.maxWidth&&o.maxWidth-o.previousWidth<u?(u-=o.maxWidth-o.previousWidth,W(h,o.maxWidth,l.syncColumnCellResize)):(W(h,o.previousWidth+u,l.syncColumnCellResize),u=0));else l.syncColumnCellResize&&(_e.width(f+g),s())}else{for(u=g,i=v;i>=0;i--)h=a[i].getAttribute("cell"),(o=r[h]).resizable&&(u&&o.maxWidth&&o.maxWidth-o.previousWidth<u?(u-=o.maxWidth-o.previousWidth,W(h,o.maxWidth,l.syncColumnCellResize)):(W(h,o.previousWidth+u,l.syncColumnCellResize),u=0));if(l.forceFitColumns)for(u=-g,i=v+1;i<a.length;i++)h=a[i].getAttribute("cell"),(o=r[h]).resizable&&(t=Math.max(o.minWidth||0,tt),u&&o.previousWidth+u<t?(u+=o.previousWidth-t,W(h,t,l.syncColumnCellResize)):(W(h,o.previousWidth+u,l.syncColumnCellResize),u=0));else l.syncColumnCellResize&&(_e.width(f+g),s())}}).bind("dragend",function(t){var n;for(e(this).parent().removeClass("slick-header-column-active"),i=0;i<a.length;i++){var s=a[i].getAttribute("cell");o=r[s],n=e(a[i]).outerWidth(),o.previousWidth!==n&&o.rerenderOnResize&&F(),l.forceFitColumns?o.width=Math.floor(o.width*(n-o.previousWidth)/o.previousWidth)+o.width:o.width=n,l.syncColumnCellResize||o.previousWidth===n||W(s,n,!0)}B(),vt.onColumnsResized&&vt.onColumnsResized()}))})}function y(){_e.bind("beforedragstart",function(t){var i=e(t.target).closest(".slick-cell");if(0===i.length)return!1;if(parseInt(i.parent().attr("row"),10)>=ze())return!1;var o=r[Z(i[0])];return("move"===o.behavior||"selectAndMove"===o.behavior)&&void 0}).bind("dragstart",function(t){if(!l.editorLock.commitCurrentEdit())return!1;var i=parseInt(e(t.target).closest(".slick-row").attr("row"),10);Mt[i]||L([i]);var o=e("<div class='slick-reorder-proxy'/>");o.css("position","absolute").css("zIndex","99999").css("width",e(this).innerWidth()).css("height",l.rowHeight*Rt.length).appendTo(je),e(this).data("selectionProxy",o).data("insertBefore",-1);var n=e("<div class='slick-reorder-guide'/>");return n.css("position","absolute").css("zIndex","99998").css("width",e(this).innerWidth()).css("top",-1e3).appendTo(je),n}).bind("drag",function(t){var i=t.clientY-e(this).offset().top;e(this).data("selectionProxy").css("top",i-5);var o=Math.max(0,Math.min(Math.round(i/l.rowHeight),ze()));o!==e(this).data("insertBefore")&&(vt.onBeforeMoveRows&&!1===vt.onBeforeMoveRows(E(),o)?e(t.dragProxy).css("top",-1e3).data("canMove",!1):e(t.dragProxy).css("top",o*l.rowHeight).data("canMove",!0),e(this).data("insertBefore",o))}).bind("dragend",function(t){var i=e(t.dragProxy).data("canMove");e(t.dragProxy).remove(),e(this).data("selectionProxy").remove();var o=e(this).data("insertBefore");e(this).removeData("selectionProxy").removeData("insertBefore"),vt.onMoveRows&&i&&vt.onMoveRows(E(),o)})}function k(){var t=e("<div class='ui-state-default slick-header-column' cell='' id='' style='visibility:hidden'>-</div>").appendTo(Be);$e=t.outerWidth()-t.width(),Je=t.outerHeight()-t.height(),t.remove();var i=e("<div class='slick-row' />").appendTo(_e);t=e("<div class='slick-cell' id='' style='visibility:hidden'>-</div>").appendTo(i),Ze=t.outerWidth()-t.width(),et=t.outerHeight()-t.height(),i.remove(),tt=Math.max($e,Ze)}function x(){Oe=e("<style type='text/css' rel='stylesheet' />").appendTo(e("head"));for(var t=l.rowHeight-et,i=["."+ft+" .slick-header-column { left: 10000px; }","."+ft+" .slick-header-columns-secondary {  height:"+l.secondaryHeaderRowHeight+"px; }","."+ft+" .slick-cell { height:"+t+"px; line-height:"+t+"px; }"],o=0;o<r.length;o++)i.push("."+ft+" .c"+o+" { width:"+((r[o].currentWidth||r[o].width)-Ze)+"px; display: "+(r[o].hidden?"none":"block")+" } ");Oe[0].styleSheet?Oe[0].styleSheet.cssText=i.join(""):Oe[0].appendChild(document.createTextNode(i.join(" ")));for(var n=document.styleSheets,o=0;o<n.length;o++)if((n[o].ownerNode||n[o].owningElement)==Oe[0]){Qe=n[o];break}}function R(e){for(var t="."+ft+" .c"+e,i=Qe.cssRules||Qe.rules,o=0;o<i.length;o++)if(i[o].selectorText==t)return i[o];throw"CSS rule for cell "+e+" not found"}function M(){Oe.remove()}function H(){var e,t,i=[],n=[],a=0,s=l.autoHeight?Xe:Xe-o.width,d=0,c=0;for(e=0;e<r.length;e++)r[e].hidden||(t=r[e],n.push(t),i.push(t.width),c+=t.width,a+=t.width-Math.max(t.minWidth||0,tt));for(d=c,F();d>s;){if(!a)return;var u=(d-s)/a;for(e=0;e<n.length&&d>s;e++)if((t=n[e]).resizable&&t.minWidth!==t.width&&t.width!==tt){var h=Math.floor(u*(t.width-Math.max(t.minWidth||0,tt)))||1;d-=h,i[e]-=h}}for(var f=d;d<s;){var v=s/d;for(e=0;e<n.length&&d<s;e++)if((t=n[e]).resizable&&!(t.maxWidth<=t.width)){var g=Math.min(Math.floor(v*t.width)-t.width,t.maxWidth-t.width||1e6)||1;d+=g,i[e]+=g}if(f==d)break;f=d}for(e=0;e<r.length;e++)if(r[e]===n[0]){var m=i.shift();n.shift().currentWidth=m,W(e,m,!0)}B()}function W(e,t,i){var o=r[e];o.currentWidth=t,Be.find(".slick-header-column[id="+o.id+"]").css("width",t-$e),i&&(R(e).style.width=t-Ze+"px")}function E(){return Rt.concat()}function L(t){var i,o,n={};for(i=0;i<t.length;i++)n[t[i]]=!0;for(i=0;i<Rt.length;i++)o=Rt[i],pt[o]&&!n[o]&&e(pt[o]).removeClass("ui-state-active selected");for(i=0;i<t.length;i++)o=t[i],pt[o]&&!Mt[o]&&e(pt[o]).addClass("ui-state-active selected");Rt=t.concat(),Mt=n}function S(e){var t=ut;ct=Math.min(qe-1,Math.floor(e/Ve));var i=e-(ut=Math.round(ct*Ie));if(ut!=t){var o=j(i);P(o.top,o.bottom),X()}wt!=i&&(ht=wt+t<i+ut?1:-1,je[0].scrollTop=yt=bt=wt=i)}function T(e,t,i,o,n){return null===i||void 0===i?"":i}function z(e){return e.formatter||l.formatterFactory&&l.formatterFactory.getFormatter(e)||T}function A(e){return e.editor||l.editorFactory&&l.editorFactory.getEditor(e)}function D(e,t){var i,o=Ae(t),n="slick-row "+(t<ze()&&!o?" loading":"")+(Mt[t]?" selected ui-state-active":"")+(t%2==1?" odd":" even");l.rowCssClasses&&(n+=" "+l.rowCssClasses(o)),e.push("<div class='ui-widget-content "+n+"' row='"+t+"' style='top:"+(l.rowHeight*t-ut)+"px'>");for(var a=0,s=r.length;a<s;a++){var d=r[a];d.hidden||(i="slick-cell c"+a+(d.cssClass?" "+d.cssClass:""),at&&at[t]&&at[t][d.id]&&(i+=" "+l.cellHighlightCssClass),e.push("<div class='"+i+"'>"),o&&e.push(z(d)(t,a,o[d.field],d,o)),e.push("</div>"))}e.push("</div>")}function P(e){for(var t in pt)(t=parseInt(t,10))!==it&&(t<e.top||t>e.bottom)&&V(t)}function F(){mt&&he(),_e[0].innerHTML="",pt={},St={},Dt+=Ct,Ct=0}function V(e){var t=pt[e];t&&(_e[0].removeChild(t),delete pt[e],delete St[e],Ct--,Dt++)}function q(e){var t,i,o;if(e&&e.length){ht=0;var n=[];for(t=0,i=e.length;t<i;t++)mt&&it===t&&he(),pt[e[t]]&&n.push(e[t]);if(Ct>10&&n.length===Ct)F();else for(t=0,o=n.length;t<o;t++)V(n[t])}}function I(e){q([e])}function N(t){pt[t]&&(e(pt[t]).children().each(function(e){var i=r[e];t===it&&e===ot&&mt?mt.loadValue(Ae(it)):Ae(t)?this.innerHTML=z(i)(t,e,Ae(t)[i.field],i,Ae(t)):this.innerHTML=""}),U(t))}function B(){var i=l.rowHeight*(ze()+(l.enableAddRow?1:0)+(l.leaveSpaceForNewRows?lt-1:0));l.autoHeight?je.height(i):je.height(t.innerHeight()-Ne.outerHeight()-(l.showSecondaryHeaderRow?Ke.outerHeight():0)),Xe=je.innerWidth(),Ue=je.innerHeight(),lt=Math.ceil(Ue/l.rowHeight);var o=0;Be.find(".slick-header-column:visible").each(function(){o+=e(this).outerWidth()}),_e.width(o),s(),G(),Y()}function K(){l.forceFitColumns?H():B()}function G(){var e=ze()+(l.enableAddRow?1:0)+(l.leaveSpaceForNewRows?lt-1:0),t=Fe;(Pe=Math.max(l.rowHeight*e,Ue-o.height))<De?(Fe=Ve=Pe,qe=1,Ie=0):(Ve=(Fe=De)/100,qe=Math.floor(Pe/Ve),Ie=(Pe-Fe)/(qe-1)),Fe!==t&&(_e.css("height",Fe),bt=je[0].scrollTop);var i=bt+ut<=Pe-Ue;0==Pe||0==bt?ct=ut=0:S(i?bt+ut:Pe-Ue),Fe!=t&&l.autoHeight&&B()}function j(e){return null==e&&(e=bt),{top:Math.floor((bt+ut)/l.rowHeight),bottom:Math.ceil((bt+ut+Ue)/l.rowHeight)}}function _(e){var t=j(e),i=Math.round(Ue/l.rowHeight);return-1==ht?(t.top-=i,t.bottom+=3):1==ht?(t.top-=3,t.bottom+=i):(t.top-=3,t.bottom+=3),t.top=Math.max(0,t.top),t.bottom=Math.min(l.enableAddRow?ze():ze()-1,t.bottom),t}function O(t){var i,o,n=_e[0],r=Ct,l=[],a=[],s=new Date,d=!1;for(i=t.top;i<=t.bottom;i++)pt[i]||(Ct++,a.push(i),D(l,i),gt&&it===i&&(d=!0),At++);var c=document.createElement("div");for(c.innerHTML=l.join(""),i=0,o=c.childNodes.length;i<o;i++)pt[a[i]]=n.appendChild(c.firstChild);d&&se(gt=e(pt[it]).children().eq(ot)[0],!1),Ct-r>5&&(xt=(new Date-s)/(Ct-r))}function Q(){l.enableAsyncPostRender&&(clearTimeout(Lt),Lt=setTimeout(J,l.asyncPostRenderDelay))}function U(e){delete St[e],zt=Math.min(zt,e),Tt=Math.max(Tt,e),Q()}function X(){for(var e in pt)pt[e].style.top=e*l.rowHeight-ut+"px"}function Y(){var e=j(),t=_();P(t),O(t),zt=e.top,Tt=Math.min(l.enableAddRow?ze():ze()-1,e.bottom),Q(),yt=bt,Et=null}function $(){bt=je[0].scrollTop;var e=je[0].scrollLeft,t=Math.abs(bt-wt);if(e!==kt&&(kt=e,Ne[0].scrollLeft=e,Ke[0].scrollLeft=e),t){if(ht=wt<bt?1:-1,wt=bt,t<Ue)S(bt+ut);else{var i=ut;ct=Math.min(qe-1,Math.floor(bt*((Pe-Ue)/(Fe-Ue))*(1/Ve))),i!=(ut=Math.round(ct*Ie))&&F()}Et&&clearTimeout(Et),Math.abs(yt-bt)<Ue?Y():Et=setTimeout(Y,50),vt.onViewportChanged&&vt.onViewportChanged()}}function J(){for(;zt<=Tt;){var e=ht>=0?zt++:Tt--,t=pt[e];if(!(!t||St[e]||e>=ze())){for(var i=Ae(e),o=t.childNodes,n=0,a=0,s=r.length;n<s;++n){var d=r[n];d.hidden||(d.asyncPostRender&&d.asyncPostRender(o[a],zt,i,d),++a)}return St[e]=!0,void(Lt=setTimeout(J,l.asyncPostRenderDelay))}}}function Z(e){for(var t=0;e&&e.previousSibling;)t++,e=e.previousSibling;return t}function ee(e){if(!vt.onKeyDown||l.editorLock.isActive()||!vt.onKeyDown(e,it,ot))if(e.shiftKey||e.altKey||e.ctrlKey){if(9!=e.which||!e.shiftKey||e.ctrlKey||e.altKey)return;We()}else if(27==e.which){if(!l.editorLock.isActive())return;ge()}else if(37==e.which)Me();else if(39==e.which)He();else if(38==e.which)xe();else if(40==e.which)Re();else if(9==e.which)Ee();else{if(13!=e.which)return;l.editable&&(mt?it===c()?Re():ve():l.editorLock.commitCurrentEdit()&&fe())}e.stopPropagation(),e.preventDefault();try{e.originalEvent.keyCode=0}catch(e){}}function te(t){var i=e(t.target).closest(".slick-cell");if(0!==i.length&&(gt!==i[0]||null===mt)){var o=parseInt(i.parent().attr("row"),10),n=Z(i[0]),a=null,s=r[n],d=Ae(o);if(d&&("selectAndMove"===s.behavior||"select"===s.behavior||t.ctrlKey||t.shiftKey)&&(a=l.editorLock.commitCurrentEdit())){var u=E(),h=e.inArray(o,u);if(t.ctrlKey||t.shiftKey){if(-1===h&&t.ctrlKey)u.push(o);else if(-1!==h&&t.ctrlKey)u=e.grep(u,function(e,t){return e!==o});else if(u.length&&t.shiftKey){var f=u.pop(),v=Math.min(o,f),g=Math.max(o,f);u=[];for(var m=v;m<=g;m++)m!==f&&u.push(m);u.push(f)}}else u=[o];return le(),L(u),vt.onSelectedRowsChanged&&vt.onSelectedRowsChanged(),e.browser.msie||_e[0].focus(),!1}if(d&&vt.onClick&&(a=l.editorLock.commitCurrentEdit())&&vt.onClick(t,o,n))return t.stopPropagation(),t.preventDefault(),!1;l.enableCellNavigation&&!r[n].unselectable&&(!0===a||null===a&&l.editorLock.commitCurrentEdit())&&(be(o,!1),de(i[0],o===c()||l.autoEdit))}}function ie(t){var i=e(t.target).closest(".slick-cell");if(0!==i.length&&(gt!==i[0]||null===mt)){var o=parseInt(i.parent().attr("row"),10),n=Z(i[0]);return Ae(o)&&vt.onContextMenu&&l.editorLock.commitCurrentEdit()&&vt.onContextMenu(t,o,n)?(t.stopPropagation(),t.preventDefault(),!1):void 0}}function oe(t){var i=e(t.target).closest(".slick-cell");if(0!==i.length&&(gt!==i[0]||null===mt)){var o=parseInt(i.parent().attr("row"),10),n=Z(i[0]);if(Ae(o)&&vt.onDblClick&&l.editorLock.commitCurrentEdit()&&vt.onDblClick(t,o,n))return t.stopPropagation(),t.preventDefault(),!1;l.editable&&ke(o,n,!0)}}function ne(e){vt.onHeaderContextMenu&&l.editorLock.commitCurrentEdit()&&(e.preventDefault(),vt.onHeaderContextMenu(e))}function re(t){if(l.enableAutoTooltips){var i=e(t.target).closest(".slick-cell",_e);i&&i.length&&(i.innerWidth()<i[0].scrollWidth?i.attr("title",e.trim(i.text())):i.attr("title",""))}}function le(){se(null,!1)}function ae(){if(e(gt).attr("tabIndex",0).attr("hideFocus",!0),e.browser.msie&&parseInt(e.browser.version)<8){gt.setActive();var t=e(gt).position().left,i=t+e(gt).outerWidth(),o=je.scrollLeft(),n=o+je.width();t<o?je.scrollLeft(t):i>n&&je.scrollLeft(Math.min(t,i-je[0].clientWidth))}else gt.focus()}function se(t,i){null!==gt&&(he(),e(gt).removeClass("selected")),null!==(gt=t)?(it=parseInt(e(gt).parent().attr("row"),10),ot=Z(gt),e(gt).addClass("selected"),l.editable&&i&&ue(it,ot)?(clearTimeout(Wt),l.asyncEditorLoading?Wt=setTimeout(fe,l.asyncEditorLoadDelay):fe()):ae(),vt.onCurrentCellChanged&&vt.onCurrentCellChanged(we())):(it=null,ot=null)}function de(e,t){se(e,t),L(e?[it]:[]),vt.onSelectedRowsChanged&&vt.onSelectedRowsChanged()}function ce(){if(document.selection&&document.selection.empty)document.selection.empty();else if(window.getSelection){var e=window.getSelection();e&&e.removeAllRanges&&e.removeAllRanges()}}function ue(e,t){return!(e<ze()&&!Ae(e)||r[t].cannotTriggerInsert&&e>=ze()||!A(r[t]))}function he(){if(mt){if(vt.onBeforeCellEditorDestroy&&vt.onBeforeCellEditorDestroy(mt),mt.destroy(),mt=null,gt&&(e(gt).removeClass("editable invalid"),Ae(it))){var t=r[ot];gt.innerHTML=z(t)(it,ot,Ae(it)[t.field],t,Ae(it)),U(it)}e.browser.msie&&ce(),l.editorLock.deactivate(rt)}}function fe(){if(gt){if(!l.editable)throw"Grid : makeSelectedCellEditable : should never get called when options.editable is false";if(clearTimeout(Wt),ue(it,ot))if(vt.onBeforeEditCell&&!1===vt.onBeforeEditCell(it,ot,Ae(it)))ae();else{l.editorLock.activate(rt),e(gt).addClass("editable"),gt.innerHTML="";var i=r[ot],o=Ae(it);mt=new(A(i))({grid:vt,gridPosition:me(t[0]),position:me(gt),container:gt,column:i,item:o||{},commitChanges:ve,cancelChanges:ge}),o&&mt.loadValue(o),nt=mt.serializeValue(),mt.position&&Ce()}}}function ve(){l.editorLock.commitCurrentEdit()&&(ae(),l.autoEdit&&Re())}function ge(){l.editorLock.cancelCurrentEdit()&&ae()}function me(t){var i={top:t.offsetTop,left:t.offsetLeft,bottom:0,right:0,width:e(t).outerWidth(),height:e(t).outerHeight(),visible:!0};i.bottom=i.top+i.height,i.right=i.left+i.width;for(var o=t.offsetParent;(t=t.parentNode)!=document.body;)i.visible&&t.scrollHeight!=t.offsetHeight&&"visible"!=e(t).css("overflowY")&&(i.visible=i.bottom>t.scrollTop&&i.top<t.scrollTop+t.clientHeight),i.visible&&t.scrollWidth!=t.offsetWidth&&"visible"!=e(t).css("overflowX")&&(i.visible=i.right>t.scrollLeft&&i.left<t.scrollLeft+t.clientWidth),i.left-=t.scrollLeft,i.top-=t.scrollTop,t===o&&(i.left+=t.offsetLeft,i.top+=t.offsetTop,o=t.offsetParent),i.bottom=i.top+i.height,i.right=i.left+i.width;return i}function pe(){return me(gt)}function Ce(){if(gt){var e;vt.onCurrentCellPositionChanged&&(e=pe(),vt.onCurrentCellPositionChanged(e)),mt&&(e=e||pe(),mt.show&&mt.hide&&(e.visible?mt.show():mt.hide()),mt.position&&mt.position(e))}}function we(){return gt?{row:it,cell:ot}:null}function be(e,t){var i=e*l.rowHeight,n=(e+1)*l.rowHeight-Ue+(Ye?o.height:0);(e+1)*l.rowHeight>bt+Ue+ut?(S(t?i:n),Y()):e*l.rowHeight<bt+ut&&(S(t?n:i),Y())}function ye(t,i,o){function n(){return!r[Z(this)].unselectable}if(gt&&l.enableCellNavigation&&l.editorLock.commitCurrentEdit()){var a=pt[it+t],s=a&&ot+i>=0?e(a).children().eq(ot+i).filter(":visible").filter(n):null;if(s&&!s.length&&(d=e(a).children().filter(function(e){return i>0?e>ot+i:e<ot+i}).filter(":visible").filter(n))&&d.length&&(s=i>0?d.eq(0):d.eq(d.length-1)),o&&0===t&&!(a&&s&&s.length)&&(!s||!s.length)){a=pt[it+t+(i>0?1:-1)];var d=e(a).children().filter(":visible").filter(n);s=i>0?a?d.eq(0):null:a?d.eq(d.length-1):null}if(a&&s&&s.length){var u=parseInt(e(a).attr("row"),10),h=u==c();be(u,!h),de(s[0],h||l.autoEdit),mt||ae()}else ae()}}function ke(t,i,o){if(!(t>ze()||t<0||i>=r.length||i<0)&&l.enableCellNavigation&&!r[i].unselectable&&l.editorLock.commitCurrentEdit()){be(t,!1);var n=null;r[i].unselectable||r[i].hidden||(n=e(pt[t]).children().eq(i)[0]),de(n,o||t===ze()||l.autoEdit),mt||ae()}}function xe(){ye(-1,0,!1)}function Re(){ye(1,0,!1)}function Me(){ye(0,-1,!1)}function He(){ye(0,1,!1)}function We(){ye(0,-1,!0)}function Ee(){ye(0,1,!0)}function Le(){var t=Ae(it),i=r[ot];if(mt){if(mt.isValueChanged()){var o=mt.validate();if(o.valid){if(it<ze()){var n={row:it,cell:ot,editor:mt,serializedValue:mt.serializeValue(),prevSerializedValue:nt,execute:function(){this.editor.applyValue(t,this.serializedValue),N(this.row)},undo:function(){this.editor.applyValue(t,this.prevSerializedValue),N(this.row)}};l.editCommandHandler?(he(),l.editCommandHandler(t,i,n)):(n.execute(),he()),vt.onCellChange&&vt.onCellChange(it,ot,t)}else if(vt.onAddNewRow){var a={};mt.applyValue(a,mt.serializeValue()),he(),vt.onAddNewRow(a,i)}return!l.editorLock.isActive()}return e(gt).addClass("invalid"),e(gt).stop(!0,!0).effect("highlight",{color:"red"},300),vt.onValidationError&&vt.onValidationError(gt,o,it,ot,i),mt.focus(),!1}he()}return!0}function Se(){return he(),!0}var Te,ze,Ae,De,Pe,Fe,Ve,qe,Ie,Ne,Be,Ke,Ge,je,_e,Oe,Qe,Ue,Xe,Ye,$e,Je,Ze,et,tt,it,ot,nt,rt,lt,at,st={rowHeight:25,defaultColumnWidth:80,enableAddRow:!1,leaveSpaceForNewRows:!1,editable:!1,autoEdit:!0,enableCellNavigation:!0,enableColumnReorder:!0,asyncEditorLoading:!1,asyncEditorLoadDelay:100,forceFitColumns:!1,enableAsyncPostRender:!1,asyncPostRenderDelay:60,autoHeight:!1,editorLock:Slick.GlobalEditorLock,showSecondaryHeaderRow:!1,secondaryHeaderRowHeight:25,syncColumnCellResize:!1,enableAutoTooltips:!0,formatterFactory:null,editorFactory:null,cellHighlightCssClass:"highlighted",cellFlashingCssClass:"flashing"},dt={resizable:!0,sortable:!1,minWidth:30},ct=0,ut=0,ht=1,ft="slickgrid_"+Math.round(1e6*Math.random()),vt=this,gt=null,mt=null,pt={},Ct=0,wt=0,bt=0,yt=0,kt=0,xt=10,Rt=[],Mt={},Ht={},Wt=null,Et=null,Lt=null,St={},Tt=null,zt=null,At=0,Dt=0;this.debug=function(){var e="";e+="\ncounter_rows_rendered:  "+At,e+="\ncounter_rows_removed:  "+Dt,e+="\nrenderedRows:  "+Ct,e+="\nnumVisibleRows:  "+lt,e+="\nmaxSupportedCssHeight:  "+De,e+="\nn(umber of pages):  "+qe,e+="\n(current) page:  "+ct,e+="\npage height (ph):  "+Ve,e+="\nscrollDir:  "+ht,alert(e)},function(){if(Te=n,ze=Te.getLength||c,Ae=Te.getItem||u,De=h(),o=o||a(),l=e.extend({},st,l),dt.width=l.defaultColumnWidth,l.enableColumnReorder&&!e.fn.sortable)throw new Error('SlickGrid\'s "enableColumnReorder = true" option requires jquery-ui.sortable module to be loaded');switch(rt={commitCurrentEdit:Le,cancelCurrentEdit:Se},t.empty().attr("tabIndex",0).attr("hideFocus",!0).css("overflow","hidden").css("outline",0).addClass(ft).addClass("ui-widget"),t.css("position")){case"absolute":case"relative":case"fixed":break;default:t.css("position","relative")}Ne=e("<div class='slick-header ui-state-default' style='overflow:hidden;position:relative;' />").appendTo(t),Be=e("<div class='slick-header-columns' style='width:100000px; left:-10000px' />").appendTo(Ne),Ke=e("<div class='slick-header-secondary ui-state-default' style='overflow:hidden;position:relative;' />").appendTo(t),Ge=e("<div class='slick-header-columns-secondary' style='width:100000px' />").appendTo(Ke),l.showSecondaryHeaderRow||Ke.hide(),je=e("<div class='slick-viewport' tabIndex='0' hideFocus style='width:100%;overflow-x:auto;outline:0;position:relative;overflow-y:auto;'>").appendTo(t),_e=e("<div class='grid-canvas' tabIndex='0' hideFocus style='overflow:hidden' />").appendTo(je),k(),je.height(t.innerHeight()-Ne.outerHeight()-(l.showSecondaryHeaderRow?Ke.outerHeight():0)),d(Be),je.bind("selectstart.ui",function(t){return e(t.target).is("input,textarea")}),g(),y(),x(),K(),f(),je.bind("scroll",$),t.bind("resize",K),_e.bind("keydown",ee),_e.bind("click",te),_e.bind("dblclick",oe),_e.bind("contextmenu",ie),_e.bind("mouseover",re),Ne.bind("contextmenu",ne)}(),e.extend(this,{slickGridVersion:"1.4",onSort:null,onHeaderContextMenu:null,onClick:null,onDblClick:null,onContextMenu:null,onKeyDown:null,onAddNewRow:null,onValidationError:null,onViewportChanged:null,onSelectedRowsChanged:null,onColumnsReordered:null,onColumnsResized:null,onBeforeMoveRows:null,onMoveRows:null,onCellChange:null,onBeforeEditCell:null,onBeforeCellEditorDestroy:null,onBeforeDestroy:null,onCurrentCellChanged:null,onCurrentCellPositionChanged:null,getColumns:function(){return r},getOptions:function(){return l},setOptions:function(t){l.editorLock.commitCurrentEdit()&&(he(),l.enableAddRow!==t.enableAddRow&&I(ze()),l=e.extend(l,t),Y())},setData:function(e,t){F(),ze=(Te=n=e).getLength||c,Ae=Te.getItem||u,t&&S(0)},destroy:function(){l.editorLock.cancelCurrentEdit(),vt.onBeforeDestroy&&vt.onBeforeDestroy(),Be.sortable&&Be.sortable("destroy"),v(),t.unbind("resize",B),M(),t.empty().removeClass(ft)},getColumnIndex:function(e){return Ht[e]},setColumnVisibility:function(e,t){var i=Ht[e.id];r[i].hidden=!t,Be.find("[id="+r[i].id+"]").css("display",t?"block":"none"),R(i).style.display=t?"block":"none",B(),l.forceFitColumns&&H(),b()},autosizeColumns:H,updateCell:function(t,i){if(pt[t]){var o=e(pt[t]).children().eq(i);if(0!==o.length){var n=r[i],l=Ae(t);mt&&it===t&&ot===i?mt.loadValue(l):(o[0].innerHTML=l?z(n)(t,i,l[n.field],n,l):"",U(t))}}},updateRow:N,removeRow:I,removeRows:q,removeAllRows:F,render:Y,invalidate:function(){G(),F(),Y()},setHighlightedCells:function(t){var i,o,n=0,a=[];for(i=0;i<r.length;i++)r[i].hidden||(a[i]=n++);for(var s in pt)for(i=0;i<r.length;i++)(at&&at[s]&&at[s][r[i].id])!=(t&&t[s]&&t[s][r[i].id])&&(o=e(pt[s]).children().eq(a[i])).length&&o.toggleClass(l.cellHighlightCssClass);at=t},flashCell:function(t,i,o){if(o=o||100,pt[t]){var n=e(pt[t]).children().eq(i);function r(e){e&&setTimeout(function(){n.queue(function(){n.toggleClass(l.cellFlashingCssClass).dequeue(),r(e-1)})},o)}r(4)}},getViewport:j,resizeCanvas:B,updateRowCount:G,getCellFromPoint:function(e,t){for(var i=Math.floor(t/l.rowHeight),o=0,n=0,a=0;a<r.length&&n<t;a++)n+=r[a].width,o++;return{row:i,cell:o-1}},getCurrentCell:we,getCurrentCellNode:function(){return gt},resetCurrentCell:le,navigatePrev:We,navigateNext:Ee,navigateUp:xe,navigateDown:Re,navigateLeft:Me,navigateRight:He,gotoCell:ke,editCurrentCell:fe,getCellEditor:function(){return mt},scrollRowIntoView:be,getSelectedRows:E,setSelectedRows:L,getSecondaryHeaderRow:function(){return Ge[0]},showSecondaryHeaderRow:function(){l.showSecondaryHeaderRow=!0,Ke.slideDown("fast",B)},hideSecondaryHeaderRow:function(){l.showSecondaryHeaderRow=!1,Ke.slideUp("fast",B)},reorderColumns:function(t){for(var i=t.length-1;i>=0;i--)Be.children().eq(0).attr("id")!=t[i]&&Be.children().eq(0).before(Be.find("#"+e.escapeSelectorMetachars(t[i])));C()},setSortColumn:function(e,t){$sortcol=e?Be.find("#"+e):null,m($sortcol,t)},getCurrentCellPosition:pe,getEditController:function(){return rt}})},EditorLock:t,GlobalEditorLock:new t}})}(jQuery);